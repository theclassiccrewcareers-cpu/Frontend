<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- FIX: Ensure Referrer matches Origin for Google OAuth -->
    <meta name="referrer" content="no-referrer-when-downgrade">
    <title>ClassBridge</title>
    <link rel="icon" type="image/x-icon" href="./static/noble_logo.png">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary-color: #28245D;
            /* Deep Indigo */
            --secondary-color: #FB7D5B;
            --accent-yellow: #FCC43E;
            --accent-blue: #304FFE;

            --bg-body: #F3F4FF;
            --bg-sidebar: #4D44B5;
            /* Updated to a "simpler", lighter indigo */

            --text-main: #303972;
            --text-secondary: #A098AE;
            --text-white: #FFFFFF;
            --text-sidebar-mute: #B9B4C7;

            --sidebar-width: 280px;
        }

        /* RESET & BASICS */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
            line-height: 1.6;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            color: var(--text-main);
            font-weight: 700;
        }

        /* --- SIDEBAR --- */
        #sidebar {
            width: var(--sidebar-width);
            /* height: 100vh;  Changed to dynamic viewport height for mobile */
            height: 100dvh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            background-color: var(--bg-sidebar);
            padding: 2rem 1.5rem;
            display: flex;
            flex-direction: column;
            border-right: none;
            overflow: hidden;
            /* Prevent body scroll, handle inside user-controls */
        }

        #user-controls {
            flex-grow: 1;
            overflow-y: auto;
            min-height: 0;
            /* Custom Scrollbar for Sidebar */
            scrollbar-width: thin;
            padding-bottom: 50px;
        }

        /* --- MAIN CONTENT --- */
        #main-content {
            margin-left: var(--sidebar-width);
            padding: 2rem 3rem;
            transition: all 0.3s ease;
        }

        /* MOBILE HEADER START HIDDEN */
        .mobile-header {
            display: none !important;
        }

        @media (max-width: 991px) {
            #sidebar {
                transform: translateX(-100%);
                width: 260px;
            }

            #sidebar.mobile-open {
                transform: translateX(0);
                box-shadow: 0 0 50px rgba(0, 0, 0, 0.1);
            }

            #main-content {
                margin-left: 0;
                padding: 1.5rem;
                padding-top: 5rem;
            }

            .mobile-header {
                display: flex !important;
            }

            .header-bar {
                display: none !important;
            }
        }

        /* --- SEARCH BOX --- */
        .search-box {
            position: relative;
            width: 350px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px 12px 50px;
            border-radius: 40px;
            border: none;
            background: #FFFFFF;
            font-family: 'Poppins', sans-serif;
            outline: none;
            color: var(--text-main);
        }

        .search-box .material-icons {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        /* --- HEADER & USER --- */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-menu .notify-btn {
            background: #FFFFFF;
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            transition: all 0.2s;
        }

        .user-menu .notify-btn:hover {
            background-color: #E6E6F2;
        }

        /* --- SIDEBAR NAV --- */
        /* --- SIDEBAR NAV --- */
        /* --- SIDEBAR NAV --- */
        #sidebar .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 16px;
            margin-bottom: 4px;
            color: var(--text-sidebar-mute);
            font-weight: 500;
            text-decoration: none;
            border-radius: 6px;
            margin-right: 1rem;
            margin-left: 1rem;
            transition: all 0.2s;
            position: relative;
        }

        #sidebar .nav-item:hover,
        #sidebar .nav-item.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-white);
        }

        #sidebar .nav-item.active::before {
            display: none;
        }

        #sidebar .nav-item .material-icons {
            font-size: 20px;
            color: var(--text-sidebar-mute);
        }

        #sidebar .nav-item.active .material-icons,
        #sidebar .nav-item:hover .material-icons {
            color: var(--text-white);
        }

        /* --- TEACHER MODE (Cleaner Webpage Layout) --- */
        body.teacher-mode {
            background: #F6F7FB;
        }

        body.teacher-mode #sidebar {
            background: #0F172A;
            border-right: 1px solid rgba(148, 163, 184, 0.2);
            padding: 1.5rem 1.25rem;
            width: 240px;
        }

        body.teacher-mode #main-content {
            margin-left: 240px;
            padding: 2.5rem 3rem;
            background: #F6F7FB;
        }

        body.teacher-mode .header-bar {
            position: sticky;
            top: 0;
            z-index: 5;
            background: #F8FAFC;
            border: 1px solid #E2E8F0;
            border-radius: 14px;
            padding: 1rem 1.5rem;
        }

        body.teacher-mode .search-box {
            width: 420px;
        }

        body.teacher-mode .search-box input {
            background: #F8FAFC;
            border: 1px solid #E2E8F0;
            color: #0F172A;
        }

        body.teacher-mode .user-menu .notify-btn {
            background: #F8FAFC;
            border: 1px solid #E2E8F0;
        }

        body.teacher-mode #sidebar .nav-item {
            border-radius: 10px;
            margin: 6px 0;
            padding: 12px 14px;
            background: transparent;
        }

        body.teacher-mode #sidebar .nav-item.active,
        body.teacher-mode #sidebar .nav-item:hover {
            background: rgba(59, 130, 246, 0.15);
            color: #E2E8F0;
        }

        body.teacher-mode .nav-submenu {
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
        }

        body.teacher-mode .nav-submenu-item {
            padding: 10px 16px;
            border-radius: 8px;
        }

        body.teacher-mode .nav-submenu-item:hover,
        body.teacher-mode .nav-submenu-item.active {
            background: rgba(59, 130, 246, 0.18);
            color: #E2E8F0;
        }

        body.teacher-mode .card,
        body.teacher-mode .shadow-sm,
        body.teacher-mode .shadow-lg,
        body.teacher-mode .shadow {
            box-shadow: none !important;
        }

        body.teacher-mode .card {
            border: 1px solid #E2E8F0 !important;
            border-radius: 14px !important;
            background: #FFFFFF;
        }

        body.teacher-mode .btn-primary-custom {
            background: #2563EB;
            border-color: #2563EB;
            box-shadow: none;
        }

        body.teacher-mode .btn-primary-custom:hover {
            background: #1D4ED8;
            border-color: #1D4ED8;
            box-shadow: none;
        }

        @media (max-width: 991px) {
            body.teacher-mode #sidebar {
                width: 260px;
            }

            body.teacher-mode #main-content {
                margin-left: 0;
                padding: 1.5rem;
                padding-top: 5rem;
            }
        }


        #sidebar .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 2rem;
            padding-left: 1rem;
            text-decoration: none;
        }

        #sidebar .brand .icon {
            background-color: var(--secondary-color);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 24px;
        }

        #sidebar .brand span {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-white);
        }

        /* --- SIDEBAR SUBMENUS --- */
        .nav-submenu {
            display: none;
            flex-direction: column;
            padding-left: 12px;
            margin-bottom: 8px;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }

        .nav-submenu.open {
            display: flex;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .nav-submenu-item {
            padding: 8px 12px 8px 42px;
            /* Indent to align with text of parent */
            font-size: 14px;
            color: var(--text-sidebar-mute);
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .nav-submenu-item:hover,
        .nav-submenu-item.active {
            color: var(--text-white);
            background-color: rgba(255, 255, 255, 0.05);
        }

        .nav-item .arrow-icon {
            margin-left: auto;
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .nav-item.expanded .arrow-icon {
            transform: rotate(180deg);
        }

        /* --- WIDGETS --- */
        .metric-widget {
            background-color: #fff;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            height: 100%;
            border: 1px solid #E0E0E0;
            box-shadow: none !important;
        }

        .metric-widget:hover {
            border-color: var(--primary-color);
        }

        /* CLASS BRIDGE STYLE WIDGETS */
        .widget-purple {
            background-color: #8D5CF6 !important;
            color: white !important;
        }

        .widget-yellow {
            background-color: #F8C750 !important;
            color: #303972 !important;
        }

        /* Yellow usually has dark text for contrast */
        .widget-blue {
            background-color: #5BA8F5 !important;
            color: white !important;
        }

        .widget-green {
            background-color: #52D884 !important;
            color: white !important;
        }

        .widget-purple .material-icons,
        .widget-blue .material-icons,
        .widget-green .material-icons {
            color: white !important;
        }

        .widget-yellow .material-icons {
            color: #303972 !important;
        }

        .metric-widget h3.number,
        .metric-widget span {
            color: inherit !important;
        }

        .metric-widget .small {
            opacity: 0.8;
        }

        /* HIDE OLD ICON CIRCLES if not needed or restyle them */
        .metric-widget .icon-circle {
            display: none;
        }

        /* New design doesn't use the circle background */

        .metric-widget .icon-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .metric-widget .icon-circle .material-icons {
            font-size: 30px;
        }

        .metric-widget h3.number {
            font-size: 28px;
            font-weight: 700;
            margin: 0;
            color: #303972;
            line-height: 1.2;
        }

        .metric-widget p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: capitalize !important;
        }

        /* --- CARDS & BUTTONS --- */
        /* Generalized card style for flat look */
        .dashboard-card,
        .card {
            background: #FFFFFF;
            border-radius: 8px !important;
            padding: 24px;
            border: 1px solid #E0E0E0 !important;
            position: relative;
            box-shadow: none !important;
        }

        .shadow-sm {
            box-shadow: none !important;
            border: 1px solid #E0E0E0 !important;
        }

        .h-100-card {
            height: 100%;
        }

        /* Spacing for Roster */
        #roster-table tr td {
            padding-top: 16px;
            padding-bottom: 16px;
        }

        .btn {
            border-radius: 6px;
            font-weight: 500;
            padding: 8px 16px;
            border: none;
        }

        .btn-primary-custom {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary-custom:hover {
            background-color: #3d3499;
            color: white;
        }

        .btn-warning {
            background-color: var(--accent-yellow);
            color: white !important;
        }

        .btn-info {
            background-color: #4CD3C6;
            color: white !important;
        }

        .btn-dark {
            background-color: #303972;
            color: white !important;
        }

        /* --- MODALS --- */
        .modal-content {
            border-radius: 8px;
            border: none;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            /* Soft shadow for depth, but clean */
        }

        .modal-header,
        .modal-footer {
            border-color: #E0E0E0;
        }

        /* --- LOGIN & UTILS --- */
        body.login-mode {
            background: var(--bg-sidebar);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.login-mode #sidebar,
        body.login-mode .header-bar {
            display: none !important;
        }

        body.login-mode #main-content {
            margin: 0;
            padding: 0;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
            animation: fadeInView 0.4s ease;
            /* Renamed and simplified */
        }

        /* Full-page replacements for former modals */
        .full-page-view {
            margin-left: var(--sidebar-width);
            padding: 2rem 3rem;
        }

        .full-page-view .modal-dialog {
            margin: 0 auto;
            max-width: 960px;
            pointer-events: auto;
        }

        .full-page-view .modal-content {
            border-radius: 16px;
            box-shadow: 0 18px 60px rgba(15, 23, 42, 0.18);
        }

        @media (max-width: 991px) {
            .full-page-view {
                margin-left: 0;
                padding: 1.5rem;
                padding-top: 5rem;
            }
        }

        /* Removed transform to prevent 'position: fixed' containing block issues */
        @keyframes fadeInView {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* ... existing overrides ... */

        /* Login Mode */
        body.login-mode {
            background: var(--bg-sidebar);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.login-mode #sidebar {
            display: none;
        }

        body.login-mode #main-content {
            margin: 0;
            padding: 0;
        }

        .view {
            display: none;
        }

        /* Reuse the simple fade */
        .view.active {
            display: block;
            animation: fadeInView 0.4s;
        }

        /* Redundant keyframes removed */

        /* Pulse Connect Button Styles */
        .pulse-connect-btn {
            position: relative;
            background-color: #0f172a;
            /* Slate 900 */
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 54px;
            /* Fixed height for alignment */
            padding: 2px !important;
            /* Wrapper padding */
        }

        .pulse-connect-btn:hover {
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.3);
            /* Blue glow */
            border-color: rgba(56, 189, 248, 0.5);
        }

        .pulse-connect-btn .inner-ring {
            background-color: #020617;
            /* Slate 950 */
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 10;
        }

        .pulse-connect-btn .gradient-text {
            background: linear-gradient(to right, #d4d4d4, #525252, #d4d4d4);
            /* Neutral gradient text */
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 600;
        }

        /* Subtle radial shine on hover */
        .pulse-connect-btn .absolute-shine {
            position: absolute;
            inset: 0;
            background: radial-gradient(75% 100% at 50% 0%, rgba(56, 189, 248, 0.6) 0%, rgba(56, 189, 248, 0) 75%);
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 1;
        }

        .pulse-connect-btn:hover .absolute-shine {
            opacity: 1;
        }

        /* UTILITIES & HELPER CLASSES */
        .hover-up {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .hover-up:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1) !important;
        }

        .text-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .transition-all {
            transition: all 0.3s ease-in-out;
        }

        .avatar-sm {
            width: 32px;
            height: 32px;
            font-size: 12px;
            object-fit: cover;
        }

        .avatar-md {
            width: 48px;
            height: 48px;
            font-size: 16px;
            object-fit: cover;
        }

        .bg-soft-primary {
            background-color: rgba(48, 79, 254, 0.1) !important;
            color: #304FFE !important;
        }

        .bg-soft-success {
            background-color: rgba(40, 167, 69, 0.1) !important;
            color: #28a745 !important;
        }

        .bg-soft-warning {
            background-color: rgba(255, 193, 7, 0.1) !important;
            color: #ffc107 !important;
        }

        .bg-soft-danger {
            background-color: rgba(220, 53, 69, 0.1) !important;
            color: #dc3545 !important;
        }

        .bg-soft-info {
            background-color: rgba(23, 162, 184, 0.1) !important;
            color: #17a2b8 !important;
        }

        /* TIMETABLE SPECIFIC PASTELS */
        .bg-pastel-blue {
            background-color: #E3F2FD;
            border-left: 4px solid #2196F3;
        }

        .bg-pastel-green {
            background-color: #E8F5E9;
            border-left: 4px solid #4CAF50;
        }

        .bg-pastel-orange {
            background-color: #FFF3E0;
            border-left: 4px solid #FF9800;
        }

        .bg-pastel-red {
            background-color: #FFEBEE;
            border-left: 4px solid #F44336;
        }

        .btn-primary-custom {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }

        .btn-primary-custom:hover {
            background-color: #1e1b4b;
            color: white;
        }

        /* ATTENDANCE TOGGLE SWITCH */
        .attendance-toggle {
            background-color: #f8f9fa;
            border-radius: 50rem;
            display: inline-flex;
            padding: 4px;
            border: 1px solid #e9ecef;
        }

        .attendance-toggle input[type="radio"] {
            display: none;
        }

        .attendance-toggle label {
            padding: 6px 16px;
            border-radius: 50rem;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            color: #6c757d;
        }

        /* Selected States */
        .attendance-toggle input[id$="-p"]:checked+label {
            background-color: #198754;
            color: white;
            box-shadow: 0 2px 4px rgba(25, 135, 84, 0.3);
        }

        .attendance-toggle input[id$="-a"]:checked+label {
            background-color: #dc3545;
            color: white;
            box-shadow: 0 2px 4px rgba(220, 53, 69, 0.3);
        }

        .attendance-toggle input[id$="-l"]:checked+label {
            background-color: #ffc107;
            color: white;
            box-shadow: 0 2px 4px rgba(255, 193, 7, 0.3);
        }

        .shadow-soft {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05) !important;
        }

        /* Mobile */
        @media (max-width: 768px) {
            #sidebar {
                transform: translateX(-100%);
                width: 260px;
            }

            #sidebar.mobile-open {
                transform: translateX(0);
            }

            #main-content {
                margin-left: 0;
                padding: 1rem;
                padding-top: 5rem;
            }
        }

        /* Glassmorphism Styles */
        .glass-navbar {
            transition: all 0.3s ease-in-out;
            border-bottom: 1px solid transparent;
        }

        /* State when scrolled down (Solid Glass) */
        .glass-navbar.scrolled-mode {
            background: rgba(15, 23, 42, 0.85) !important;
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        /* Glass Card Style */
        .glass-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05)) !important;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.15) !important;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .glass-card:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1)) !important;
            transform: translateY(-8px) scale(1.02);
            border-color: rgba(255, 255, 255, 0.5) !important;
            box-shadow: 0 15px 40px 0 rgba(31, 38, 135, 0.4);
        }

        /* Ensure Text Visibility in Glass Cards */
        .glass-card h5,
        .glass-card p,
        .glass-card .material-icons {
            color: white !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Specific override for the icon circles inside glass cards to be semi-transparent */
        .glass-card .icon-circle {
            background: rgba(255, 255, 255, 0.15) !important;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        /* --- FADE SLIDE IN ANIMATIONS (Hero) --- */
        @keyframes fade-slide-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-slide-in-1 {
            animation: fade-slide-in 0.8s ease-out forwards;
            animation-delay: 0.1s;
            opacity: 0;
        }

        .animate-fade-slide-in-2 {
            animation: fade-slide-in 0.8s ease-out forwards;
            animation-delay: 0.3s;
            opacity: 0;
        }

        .animate-fade-slide-in-3 {
            animation: fade-slide-in 0.8s ease-out forwards;
            animation-delay: 0.5s;
            opacity: 0;
        }

        .animate-fade-slide-in-4 {
            animation: fade-slide-in 0.8s ease-out forwards;
            animation-delay: 0.6s;
            opacity: 0;
        }

        /* CIRCULAR CHART CSS */
        .circular-chart {
            display: block;
            margin: 0 auto;
            max-width: 100%;
            max-height: 250px;
        }

        .circle-bg {
            fill: none;
            stroke: #eee;
            stroke-width: 3.8;
        }

        .circle {
            fill: none;
            stroke-width: 2.8;
            stroke-linecap: round;
            animation: progress 1s ease-out forwards;
        }

        @keyframes progress {
            0% {
                stroke-dasharray: 0 100;
            }
        }

        .glass-card:hover .icon-circle {
            background: rgba(255, 255, 255, 0.25) !important;
            transform: scale(1.1);
        }

        .glass-card .icon-circle .material-icons {
            color: white !important;
        }

        .role-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        #othersRoleModal .modal-title {
            color: #ffffff !important;
        }
        #othersRoleModal .role-card {
            background: rgba(255, 255, 255, 0.18) !important;
            border: 1px solid rgba(255, 255, 255, 0.45) !important;
        }
        #othersRoleModal .role-card h6 {
            color: #ffffff !important;
            font-size: 1.15rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.35);
        }
        #othersRoleModal .role-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.28) !important;
            border-color: rgba(255, 255, 255, 0.65) !important;
        }

        /* FIX: Prevent button movement/jitter */
        #landing-view .btn {
            transform: none !important;
            transition: background-color 0.2s, color 0.2s, box-shadow 0.2s !important;
            /* Exclude transform/padding/margin from transition */
            min-width: 100px;
            /* Ensure buttons don't shrink/grow */
        }

        #landing-view .navbar-brand img {
            transition: none !important;
            /* Stop logo from moving */
        }

        /* New Classes for Teachers Section */
        html {
            scroll-behavior: smooth;
        }

        .transform-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .transform-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(77, 68, 181, 0.2) !important;
        }


        /* Glowing Effect Cards (Simplified Occlusion Method) */
        .glowing-card {
            position: relative;
            border-radius: 1.25rem;
            display: block;
            height: 100%;
            /* The 'border' is actually the padding of this container revealing the background div */
            padding: 3px;
            background: transparent;
            z-index: 1;
            /* overflow: hidden; Removed to allow glow to maybe bleed? Keep standard */
            overflow: hidden;
        }

        /* The Content (Top Layer) */
        .glowing-card-content {
            position: relative;
            z-index: 20;
            background: #ffffff;
            border-radius: 1.1rem;
            /* Slightly smaller than parent 1.25rem */
            padding: 1.5rem;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* The Glowing Background (Bottom Layer) */
        .glowing-card-border {
            position: absolute;
            inset: 0;
            z-index: 10;
            border-radius: inherit;
            pointer-events: none;

            /* Vars */
            --spread: 20;
            --start: 0;
            --active: 0;
            --gradient: radial-gradient(circle, #dd7bbb 10%, #dd7bbb00 20%),
                radial-gradient(circle at 40% 40%, #d79f1e 5%, #d79f1e00 15%),
                radial-gradient(circle at 60% 60%, #5a922c 10%, #5a922c00 20%),
                radial-gradient(circle at 40% 60%, #4c7894 10%, #4c789400 20%),
                repeating-conic-gradient(from 236.84deg at 50% 50%,
                    #dd7bbb 0%,
                    #d79f1e calc(25% / 5),
                    #5a922c calc(50% / 5),
                    #4c7894 calc(75% / 5),
                    #dd7bbb calc(100% / 5));
        }

        .glowing-card-border::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: var(--gradient);
            background-size: 200% 200%;
            /* Ensure gradient covers enough */

            opacity: var(--active);
            /* Controlled by JS hover */
            transition: opacity 0.3s ease;

            /* SEARCHLIGHT MASK: The magic that reveals only a slice */
            /* Using a slightly wider spread and simpler syntax */
            mask-image: conic-gradient(from calc(var(--start) * 1deg - var(--spread) * 1deg),
                    transparent,
                    black,
                    /* Visible part */
                    transparent calc(var(--spread) * 2deg));
            -webkit-mask-image: conic-gradient(from calc(var(--start) * 1deg - var(--spread) * 1deg),
                    transparent,
                    black,
                    transparent calc(var(--spread) * 2deg));
        }


        .glass-card-solid {
            background: #ffffff !important;
            border: 1px solid #eef2f6 !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03) !important;
            border-radius: 12px !important;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .hover-up:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08) !important;
            border-color: var(--primary-color) !important;
        }

        .text-truncate-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.4;
            height: 2.8em;
            /* Force height to align cards */
        }

        /* --- DASHBOARD ELEMENTS --- */
        .dashboard-card {
            border-radius: 1.25rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .bg-gradient-primary {
            background: linear-gradient(135deg, #4D44B5 0%, #8D5CF6 100%) !important;
        }

        .hover-primary:hover {
            color: #4D44B5 !important;
        }

        .btn-primary-custom {
            background: #4D44B5;
            color: white;
            border: none;
            transition: all 0.2s;
        }

        .btn-primary-custom:hover {
            background: #3A328C;
            color: white;
            box-shadow: 0 4px 12px rgba(77, 68, 181, 0.3);
        }

        .bg-primary-subtle {
            background-color: #F3F4FF !important;
        }

        .clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Entrance Animation */
        /* Progressive Enhancement: Default is visible. JS adds 'js-scroll-hidden' to hide, then removes it. */
        .fade-in-up {
            transform: translateY(0);
            opacity: 1;
            /* Default visible to prevent "white space" bug if JS fails or lags */
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        /* Logic: JS adds this class initially, then removes it when in view */
        .js-scroll-hidden {
            opacity: 0 !important;
            transform: translateY(30px) !important;
        }

        .fade-in-up.visible {
            opacity: 1;
            /* Redundant but explicit */
            transform: translateY(0);
        }

        /* Stagger delays */
        .delay-100 {
            transition-delay: 0.1s;
        }

        .delay-200 {
            transition-delay: 0.2s;
        }

        .delay-300 {
            transition-delay: 0.3s;
        }

        /* Icon Floating Animation */
        @keyframes float-y {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-6px);
            }
        }

        .anim-icon {
            display: inline-block;
            animation: float-y 3s ease-in-out infinite;
        }

        /* Different timings for variety */
        .anim-icon-1 {
            animation-delay: 0s;
        }

        .anim-icon-2 {
            animation-delay: 1s;
        }

        .anim-icon-3 {
            animation-delay: 0.5s;
        }

        .dashed-border {
            background-image: url("data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' rx='10' ry='10' stroke='%23ccc' stroke-width='2' stroke-dasharray='10%2c 10' stroke-dashoffset='0' stroke-linecap='square'/%3e%3c/svg%3e");
            border: none !important;
        }

        /* --- SIDEBAR CHATBOT STYLES --- */
        #ai-sidebar {
            position: fixed;
            top: 0;
            right: -450px;
            /* Hidden state */
            width: 450px;
            height: 100vh;
            background: #ffffff;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.15);
            z-index: 2050;
            /* Highest priority */
            transition: right 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            flex-direction: column;
            border-left: 1px solid rgba(0, 0, 0, 0.05);
        }

        #ai-sidebar.open {
            right: 0;
        }

        .chat-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #f0f0f0;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-body {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            background: #ffffff;
            display: flex;
            flex-direction: column;
            gap: 20px;
            scroll-behavior: smooth;
        }

        .chat-message {
            max-width: 90%;
            padding: 14px 18px;
            border-radius: 12px;
            font-size: 0.95rem;
            line-height: 1.6;
            position: relative;
            word-wrap: break-word;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-message.user {
            align-self: flex-end;
            background: #4D44B5;
            /* Brand color */
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-message.ai {
            align-self: flex-start;
            background: #f8f9fa;
            border: 1px solid #edf2f7;
            color: #334155;
            border-bottom-left-radius: 4px;
        }

        .chat-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #f0f0f0;
        }

        .chat-toggle-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #4D44B5;
            /* Brand color */
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(77, 68, 181, 0.4);
            cursor: pointer;
            z-index: 2040;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 4px solid white;
        }

        .chat-toggle-btn:hover {
            transform: scale(1.1) rotate(-5deg);
        }

        /* Markdown Styles inside AI response */
        .chat-message.ai h1,
        .chat-message.ai h2,
        .chat-message.ai h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 12px;
            margin-bottom: 8px;
            color: #1e293b;
        }

        .chat-message.ai p {
            margin-bottom: 10px;
        }

        .chat-message.ai ul,
        .chat-message.ai ol {
            padding-left: 24px;
            margin-bottom: 12px;
        }

        .chat-message.ai li {
            margin-bottom: 4px;
        }

        .chat-message.ai code {
            background: #e2e8f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #d63384;
        }

        .chat-message.ai pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 12px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 12px 0;
            font-size: 0.85em;
        }

        .chat-message.ai blockquote {
            border-left: 4px solid #cbd5e1;
            padding-left: 12px;
            margin-left: 0;
            color: #64748b;
            font-style: italic;
        }

        .chat-message.ai table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 0.9em;
        }

        .chat-message.ai th,
        .chat-message.ai td {
            border: 1px solid #cbd5e1;
            padding: 8px 12px;
        }

        .chat-message.ai th {
            background-color: #f1f5f9;
            font-weight: 600;
            text-align: left;
        }

        /* --- GLOBAL RESPONSIVE FIXES (Step 11) --- */
        img,
        video,
        canvas,
        iframe,
        svg {
            max-width: 100%;
            height: auto;
        }

        iframe {
            height: 100%;
            /* Iframes usually need height */
        }

        /* Ensure tables don't break layout */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            width: 100%;
            margin-bottom: 1rem;
        }

        /* Ensure Views don't overflow */
        .view {
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            /* Prevent horizontal scroll on view level */
        }

        /* Fix for specific dashboard cards overflow */
        .dashboard-card,
        .card {
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* Mobile improvements */
        @media (max-width: 768px) {

            /* Adjust font sizes for better readability on small screens */
            html {
                font-size: 14px;
            }

            .btn {
                padding: 0.375rem 0.75rem;
                /* Standard bootstrap padding */
                font-size: 0.9rem;
            }

            /* Ensure containers have padding */
            .container,
            .container-fluid {
                padding-left: 15px;
                padding-right: 15px;
            }

            /* Ensure modals fit screen */
            .modal-dialog {
                margin: 0.5rem;
                max-width: 100%;
            }
        }
    </style>
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <!-- Microsoft Authentication Library (MSAL) -->
    <script src="https://alcdn.msauth.net/browser/2.30.0/js/msal-browser.min.js"></script>
    <!-- Three.js for Shader Animation (Optional now) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- GSAP for Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <!-- Ensure GSAP is loaded before script.js -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Observer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="login-mode">
    <!-- Mobile Overlay -->
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <nav id="sidebar">
        <a href="#" class="brand d-flex align-items-center gap-2 text-decoration-none">
            <img src="./static/noble_logo.png" alt="Logo"
                style="width: 45px; height: 45px; border-radius: 12px; object-fit: cover;">
            <div class="d-flex flex-column">
                <span class="fw-bold fs-5 text-white" style="line-height: 1.2;">Class Bridge</span>
                <span class="text-white opacity-50 text-uppercase"
                    style="font-size: 0.55rem; letter-spacing: 0.5px; margin-top: 4px; line-height: 1.2;">a product by
                    Noble Nexus</span>
            </div>
        </a>

        <!-- Auth Status (Hidden/Styled) -->
        <div id="auth-status" class="mb-4 small text-secondary" style="display:none;"></div>



        <div id="user-controls" class="flex-grow-1">
            <!-- Navigation Items Injected Here by Script.js -->
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content">
        <!-- New Top Header for Desktop -->
        <div class="header-bar d-none d-md-flex">
            <div class="title-area">
                <h2 id="page-title" data-i18n="sidebar_dashboard">Dashboard</h2>
            </div>
            <div class="search-box">
                <span class="material-icons">search</span>
                <input type="text" data-i18n-placeholder="ph_search" placeholder="Search here...">
            </div>
            <div class="user-menu">
                <!-- Messages Dropdown -->
                <div class="dropdown">
                    <button class="notify-btn" data-bs-toggle="dropdown" aria-expanded="false">
                        <span class="material-icons">mail</span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-end border-0 shadow-lg p-0" style="width: 320px;">
                        <div class="p-3 border-bottom bg-primary-subtle rounded-top">
                            <h6 class="mb-0 fw-bold text-primary" data-i18n="header_messages">Messages</h6>
                        </div>
                        <div class="list-group list-group-flush" style="max-height: 300px; overflow-y: auto;">
                            <a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3"
                                onclick="switchView('communication-view')">
                                <div class="bg-light rounded-circle d-flex align-items-center justify-content-center"
                                    style="width:40px; height:40px; flex-shrink:0;">
                                    <span class="material-icons text-secondary fs-5">person</span>
                                </div>
                                <div>
                                    <div class="d-flex justify-content-between align-items-center mb-1">
                                        <b class="small">Parent Association</b>
                                        <small class="text-muted" style="font-size: 10px;">10:30 AM</small>
                                    </div>
                                    <p class="mb-0 small text-muted text-truncate" style="max-width: 200px;">Re: Annual
                                        Science Fair Fund...</p>
                                </div>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3"
                                onclick="switchView('communication-view')">
                                <div class="bg-light rounded-circle d-flex align-items-center justify-content-center"
                                    style="width:40px; height:40px; flex-shrink:0;">
                                    <span class="material-icons text-secondary fs-5">person</span>
                                </div>
                                <div>
                                    <div class="d-flex justify-content-between align-items-center mb-1">
                                        <b class="small">David Miller</b>
                                        <small class="text-muted" style="font-size: 10px;">Yesterday</small>
                                    </div>
                                    <p class="mb-0 small text-muted text-truncate" style="max-width: 200px;">Meeting
                                        request regarding...</p>
                                </div>
                            </a>
                        </div>
                        <div class="p-2 text-center border-top">
                            <a href="#" class="small fw-bold text-decoration-none"
                                onclick="switchView('communication-view')" data-i18n="header_view_all_messages">View All
                                Messages</a>
                        </div>
                    </div>
                </div>

                <!-- Student Selector (Top Header) -->
                <div id="top-header-student-selector" class="d-none align-items-center gap-2 me-3"
                    style="min-width: 300px;">
                    <!-- Injected by script.js -->
                </div>

                <!-- Notifications Dropdown -->
                <div class="dropdown">
                    <button class="notify-btn position-relative" data-bs-toggle="dropdown" aria-expanded="false">
                        <span class="material-icons">notifications</span>
                        <span
                            class="position-absolute top-0 start-100 translate-middle p-1 bg-danger border border-light rounded-circle"
                            style="left: 75% !important; top: 10px !important;">
                            <span class="visually-hidden">New alerts</span>
                        </span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-end border-0 shadow-lg p-0" style="width: 320px;">
                        <div class="p-3 border-bottom bg-warning bg-opacity-10 rounded-top">
                            <h6 class="mb-0 fw-bold text-dark" data-i18n="header_notifications">Notifications</h6>
                        </div>
                        <div class="list-group list-group-flush" style="max-height: 300px; overflow-y: auto;">
                            <div class="list-group-item d-flex gap-3 py-3">
                                <div class="bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center text-primary"
                                    style="width:36px; height:36px; flex-shrink:0;">
                                    <span class="material-icons fs-6">campaign</span>
                                </div>
                                <div>
                                    <p class="mb-1 small fw-bold" data-i18n="notif_sys_maint">System Maintenance</p>
                                    <p class="mb-0 small text-muted" data-i18n="notif_sys_maint_desc">Scheduled for
                                        tonight at 12 AM.</p>
                                    <small class="text-muted opacity-75" style="font-size: 10px;">2 hours ago</small>
                                </div>
                            </div>
                            <div class="list-group-item d-flex gap-3 py-3">
                                <div class="bg-success bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center text-success"
                                    style="width:36px; height:36px; flex-shrink:0;">
                                    <span class="material-icons fs-6">task_alt</span>
                                </div>
                                <div>
                                    <p class="mb-1 small fw-bold" data-i18n="notif_assign_sub">Assignment Submitted</p>
                                    <p class="mb-0 small text-muted" data-i18n="notif_assign_sub_desc">Alice Smith
                                        submitted "Math HW".</p>
                                    <small class="text-muted opacity-75" style="font-size: 10px;">5 hours ago</small>
                                </div>
                            </div>
                        </div>
                        <div class="p-2 text-center border-top">
                            <a href="#" class="small fw-bold text-decoration-none text-muted"
                                data-i18n="header_mark_read">Mark all as read</a>
                        </div>
                    </div>
                </div>
                <!-- User Profile Dropdown -->
                <div class="dropdown">
                    <div class="user-profile d-flex align-items-center gap-3 ps-3 border-start" style="cursor: pointer;"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        <div class="info text-end">
                            <div id="header-user-name" class="fw-bold fs-6">Surjeet</div>
                            <div id="header-user-role" class="text-secondary small">Admin</div>
                        </div>
                        <img src="https://ui-avatars.com/api/?name=Surjeet&background=random" alt="User"
                            class="rounded-circle" width="48" height="48" id="header-user-img">
                    </div>
                    <ul class="dropdown-menu dropdown-menu-end border-0 shadow-lg p-2" style="width: 220px;">
                        <li>
                            <a class="dropdown-item d-flex align-items-center gap-2 py-2 rounded mb-1" href="#"
                                onclick="openProfileView()">
                                <div class="bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center text-primary"
                                    style="width:32px; height:32px;">
                                    <span class="material-icons fs-6">person</span>
                                </div>
                                <span class="fw-medium" data-i18n="header_my_profile">My Profile</span>
                            </a>
                        </li>
                        <li>
                            <hr class="dropdown-divider my-1">
                        </li>
                        <li>
                            <a class="dropdown-item d-flex align-items-center gap-2 py-2 rounded text-danger" href="#"
                                onclick="handleLogout()">
                                <div class="bg-danger bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center text-danger"
                                    style="width:32px; height:32px;">
                                    <span class="material-icons fs-6">logout</span>
                                </div>
                                <span class="fw-bold" data-i18n="header_logout">Logout</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Mobile Header (Visible only on mobile & when logged in) -->
        <div class="mobile-header">
            <button class="btn btn-link text-dark p-0 me-3" onclick="toggleSidebar()">
                <span class="material-icons" style="font-size: 28px;">menu</span>
            </button>
            <div class="d-flex align-items-center">
                <img src="./static/noble_logo.png" alt="Logo"
                    style="height: 40px; width: auto; margin-right: 10px; border-radius: 8px;">
                <div class="d-flex flex-column">
                    <h5 class="m-0 fw-bold text-primary-custom" style="line-height: 1.2;">Class Bridge</h5>
                    <span class="text-muted text-uppercase mt-1"
                        style="font-size: 0.55rem; letter-spacing: 0.5px; line-height: 1.2;">a product
                        by Noble Nexus</span>
                </div>
            </div>
        </div>

        <!-- Landing View (Full Website Style) -->
        <div id="landing-view" class="view active"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; overflow-y: auto;">
            <!-- Shader Background Container -->
            <div id="shader-background-container"
                style="position: fixed; top:0; left:0; width:100%; height:100%; z-index: -1;"></div>

            <!-- ClassDojo-Inspired Header -->
            <nav id="landing-navbar" class="navbar navbar-expand-lg position-fixed top-0 w-100 py-4 glass-navbar"
                style="background: transparent; z-index: 100;">
                <div class="container d-flex align-items-center justify-content-between">
                    <!-- Brand -->
                    <a class="navbar-brand d-flex align-items-center gap-3 text-white" href="#">
                        <img src="./static/noble_logo.png" alt="Logo"
                            style="width: 45px; height: 45px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.2);">
                        <div class="d-flex flex-column">
                            <span class="fw-bold fs-4"
                                style="font-family: 'Poppins', sans-serif; line-height: 1.2;">Class Bridge</span>
                            <span class="opacity-75 text-uppercase fw-medium mt-1"
                                style="font-size: 0.6rem; letter-spacing: 1px; line-height: 1.2;">a product by Noble
                                Nexus</span>
                        </div>
                    </a>

                    <!-- Nav Links (Desktop) -->
                    <div class="d-none d-md-flex align-items-center gap-5">
                        <a href="javascript:void(0)" onclick="switchView('teachers-landing-view')"
                            class="text-white text-decoration-none fw-medium" data-i18n="nav_teachers">Teachers</a>
                        <a href="javascript:void(0)" onclick="switchView('students-landing-view')"
                            class="text-white text-decoration-none fw-medium" data-i18n="nav_students">Students</a>
                        <a href="javascript:void(0)" onclick="switchView('schools-landing-view')"
                            class="text-white text-decoration-none fw-medium" data-i18n="nav_schools">Schools</a>
                        <a href="javascript:void(0)" onclick="switchView('resources-landing-view')"
                            class="text-white text-decoration-none fw-medium" data-i18n="nav_resources">Resources</a>
                    </div>

                    <div class="d-flex align-items-center gap-3">
                        <button class="btn btn-outline-light rounded-pill px-4 fw-bold"
                            onclick="switchView('login-view')" data-i18n="btn_log_in">
                            Log in
                        </button>
                        <button class="btn btn-primary rounded-pill px-4 fw-bold" onclick="switchView('register-view')"
                            style="background-color: #4D44B5; border: none;" data-i18n="link_signup">
                            Sign up
                        </button>
                    </div>
                </div>
            </nav>

            <!-- ClassDojo-Inspired Hero Section -->
            <section
                class="d-flex flex-column align-items-center justify-content-center text-center px-3 position-relative"
                style="min-height: 90vh; background-color: transparent; padding-top: 140px; overflow: hidden;">

                <!-- Shader Background Container -->
                <div id="shader-background"
                    style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; z-index: 0;"></div>

                <div class="position-relative" style="z-index: 1;">
                    <h1 class="display-3 fw-bold mb-4"
                        style="color: #fff; font-family: 'Poppins', sans-serif; line-height: 1.3; letter-spacing: 0.5px; text-shadow: 0 4px 20px rgba(0,0,0,0.3);">
                        Where classrooms<br>become communities
                    </h1>

                    <p class="fs-5 mb-5 text-light fw-medium">
                        Empowering educational institutions through innovative solutions
                    </p>

                    <!-- Role Selection Container -->
                    <div class="d-flex flex-column align-items-center w-100">
                        <p class="fw-bold text-uppercase text-light mb-4" style="letter-spacing: 1px;">Get started as
                            a...</p>

                        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4 justify-content-center w-100 px-4"
                            style="max-width: 1400px;">

                            <!-- Teacher Card -->
                            <div class="col">
                                <div class="role-card p-4 rounded-4 cursor-pointer glass-card h-100"
                                    onclick="selectLoginRole('Teacher'); showLogin()" style="cursor: pointer;">
                                    <div class="d-flex flex-column align-items-center gap-3">
                                        <div class="icon-circle d-flex align-items-center justify-content-center rounded-circle mb-2"
                                            style="width: 80px; height: 80px;">
                                            <span class="material-icons" style="font-size: 40px;">school</span>
                                        </div>
                                        <h5 class="fw-bold m-0 text-center">Teacher</h5>
                                        <span class="material-icons opacity-50">arrow_forward</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Parent Card -->
                            <div class="col">
                                <div class="role-card p-4 rounded-4 cursor-pointer glass-card h-100"
                                    onclick="selectLoginRole('Parent'); showLogin()" style="cursor: pointer;">
                                    <div class="d-flex flex-column align-items-center gap-3">
                                        <div class="icon-circle d-flex align-items-center justify-content-center rounded-circle mb-2"
                                            style="width: 80px; height: 80px;">
                                            <span class="material-icons" style="font-size: 40px;">home</span>
                                        </div>
                                        <h5 class="fw-bold m-0 text-center">Parent</h5>
                                        <span class="material-icons opacity-50">arrow_forward</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Student Card -->
                            <div class="col">
                                <div class="role-card p-4 rounded-4 cursor-pointer glass-card h-100"
                                    onclick="selectLoginRole('Student'); showLogin()" style="cursor: pointer;">
                                    <div class="d-flex flex-column align-items-center gap-3">
                                        <div class="icon-circle d-flex align-items-center justify-content-center rounded-circle mb-2"
                                            style="width: 80px; height: 80px;">
                                            <span class="material-icons" style="font-size: 40px;">backpack</span>
                                        </div>
                                        <h5 class="fw-bold m-0 text-center">Student</h5>
                                        <span class="material-icons opacity-50">arrow_forward</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Others Card -->
                            <div class="col">
                                <div class="role-card p-4 rounded-4 cursor-pointer glass-card h-100"
                                    onclick="new bootstrap.Modal(document.getElementById('othersRoleModal')).show();"
                                    style="cursor: pointer;">
                                    <div class="d-flex flex-column align-items-center gap-3">
                                        <div class="icon-circle d-flex align-items-center justify-content-center rounded-circle mb-2"
                                            style="width: 80px; height: 80px;">
                                            <span class="material-icons" style="font-size: 40px;">more_horiz</span>
                                        </div>
                                        <h5 class="fw-bold m-0 text-center">Others</h5>
                                        <span class="material-icons opacity-50">arrow_forward</span>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- Others Role Selection Modal -->
                <div class="modal fade" id="othersRoleModal" tabindex="-1" aria-hidden="true"
                    style="backdrop-filter: blur(5px);">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content border-0 shadow-lg"
                            style="background: rgba(40, 36, 93, 0.95); color: white; border-radius: 20px;">
                            <div class="modal-header border-0">
                                <h5 class="modal-title fw-bold" data-i18n="modal_select_role">Select Role</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body p-4">
                                <div class="d-flex justify-content-center gap-3">
                                    <!-- Principal -->
                                    <div class="role-card p-4 rounded-4 cursor-pointer glass-card text-center"
                                        onclick="selectLoginRole('Principal'); bootstrap.Modal.getInstance(document.getElementById('othersRoleModal')).hide(); showLogin();"
                                        style="flex: 1; min-width: 140px; cursor: pointer;">
                                        <div class="d-flex flex-column align-items-center gap-3">
                                            <div class="icon-circle d-flex align-items-center justify-content-center rounded-circle mb-2"
                                                style="width: 60px; height: 60px; background: rgba(255,255,255,0.2);">
                                                <span class="material-icons"
                                                    style="font-size: 30px;">account_balance</span>
                                            </div>
                                            <h6 class="fw-bold m-0" data-i18n="role_principal">Principal</h6>
                                        </div>
                                    </div>

                                    <!-- Super Admin -->
                                    <div class="role-card p-4 rounded-4 cursor-pointer glass-card text-center"
                                        onclick="selectLoginRole('Admin'); bootstrap.Modal.getInstance(document.getElementById('othersRoleModal')).hide(); showLogin();"
                                        style="flex: 1; min-width: 140px; cursor: pointer;">
                                        <div class="d-flex flex-column align-items-center gap-3">
                                            <div class="icon-circle d-flex align-items-center justify-content-center rounded-circle mb-2"
                                                style="width: 60px; height: 60px; background: rgba(255,255,255,0.2);">
                                                <span class="material-icons" style="font-size: 30px;">badge</span>
                                            </div>
                                            <h6 class="fw-bold m-0" data-i18n="role_super_admin">Super Admin</h6>
                                        </div>
                                    </div>

                                    <div class="role-card p-4 rounded-4 cursor-pointer glass-card text-center"
                                        onclick="selectLoginRole('Root_Super_Admin'); bootstrap.Modal.getInstance(document.getElementById('othersRoleModal')).hide(); showLogin();"
                                        style="flex: 1; min-width: 140px; cursor: pointer;">
                                        <div class="d-flex flex-column align-items-center gap-3">
                                            <div class="icon-circle d-flex align-items-center justify-content-center rounded-circle mb-2"
                                                style="width: 60px; height: 60px; background: rgba(255,255,255,0.2);">
                                                <span class="material-icons" style="font-size: 30px;">admin_panel_settings</span>
                                            </div>
                                            <h6 class="fw-bold m-0">Root Admin</h6>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Features Section -->
            <section id="features-section" class="py-5" style="background-color: #fff;">
                <div class="container py-4">
                    <div class="text-center mb-5">
                        <small class="text-primary fw-bold text-uppercase ls-1" data-i18n="feat_why_title">Why Noble
                            Nexus?</small>
                        <h2 class="fw-bold mt-2" data-i18n="feat_main_title">Everything you need to excel</h2>
                    </div>

                    <div class="row g-4 justify-content-center">
                        <!-- Card 1 -->
                        <div class="col-md-4">
                            <div class="p-4 rounded-4 h-100 text-center transition-hover border"
                                style="background: #fff; box-shadow: 0 10px 30px rgba(0,0,0,0.05);">
                                <div class="d-inline-flex align-items-center justify-content-center bg-primary bg-opacity-10 text-primary rounded-circle mb-4"
                                    style="width: 80px; height: 80px;">
                                    <span class="material-icons fs-1">insights</span>
                                </div>
                                <h4 class="fw-bold text-dark" data-i18n="feat_analytics_title">Smart Analytics</h4>
                                <p class="text-muted" data-i18n="feat_analytics_desc">Track academic performance trends
                                    with clear, AI-driven
                                    visualizations that help students improve faster.</p>
                            </div>
                        </div>
                        <!-- Card 2 -->
                        <div class="col-md-4">
                            <div class="p-4 rounded-4 h-100 text-center transition-hover border"
                                style="background: #fff; box-shadow: 0 10px 30px rgba(0,0,0,0.05);">
                                <div class="d-inline-flex align-items-center justify-content-center bg-danger bg-opacity-10 text-danger rounded-circle mb-4"
                                    style="width: 80px; height: 80px;">
                                    <span class="material-icons fs-1">videocam</span>
                                </div>
                                <h4 class="fw-bold text-dark" data-i18n="feat_live_title">Live Classrooms</h4>
                                <p class="text-muted" data-i18n="feat_live_desc">Integrated video conferencing allows
                                    for seamless remote learning
                                    sessions directly from your dashboard.</p>
                            </div>
                        </div>
                        <!-- Card 3 -->
                        <div class="col-md-4">
                            <div class="p-4 rounded-4 h-100 text-center transition-hover border"
                                style="background: #fff; box-shadow: 0 10px 30px rgba(0,0,0,0.05);">
                                <div class="d-inline-flex align-items-center justify-content-center bg-success bg-opacity-10 text-success rounded-circle mb-4"
                                    style="width: 80px; height: 80px;">
                                    <span class="material-icons fs-1">auto_awesome</span>
                                </div>
                                <h4 class="fw-bold text-dark" data-i18n="feat_ai_title">AI Guidance</h4>
                                <p class="text-muted" data-i18n="feat_ai_desc">Experience personalized learning paths
                                    and automated feedback
                                    designed for every student's unique journey.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            </section>

            <!-- About / Detailed Section -->
            <section class="py-5 bg-white border-top">
                <div class="container py-4">
                    <div class="row align-items-center g-5">
                        <div class="col-lg-6">
                            <small class="text-primary fw-bold text-uppercase ls-1" data-i18n="about_title">About
                                ClassBridge</small>
                            <h2 class="display-6 fw-bold mt-2 mb-4" data-i18n="about_main_title">Empowering the Future
                                of Education</h2>
                            <p class="lead text-muted mb-4 opacity-75" data-i18n="about_desc">ClassBridge is designed to
                                close the gap between
                                traditional schooling and modern technology. We provide a unified ecosystem where
                                learning meets innovation:</p>
                            <ul class="list-unstyled d-flex flex-column gap-3 mb-4">
                                <li class="d-flex align-items-start gap-3">
                                    <span class="material-icons text-success mt-1">check_circle</span>
                                    <div>
                                        <h6 class="fw-bold mb-1 text-dark" data-i18n="about_teachers">For Teachers</h6>
                                        <p class="mb-0 text-muted small" data-i18n="about_teachers_desc">Manage
                                            classrooms effortlessly with AI-powered
                                            attendance, automated grading, and smart lesson planning tools.</p>
                                    </div>
                                </li>
                                <li class="d-flex align-items-start gap-3">
                                    <span class="material-icons text-success mt-1">check_circle</span>
                                    <div>
                                        <h6 class="fw-bold mb-1 text-dark" data-i18n="about_students">For Students</h6>
                                        <p class="mb-0 text-muted small" data-i18n="about_students_desc">Access
                                            personalized learning paths, track
                                            real-time progress, and stay engaged with gamified education goals.</p>
                                    </div>
                                </li>
                                <li class="d-flex align-items-start gap-3">
                                    <span class="material-icons text-success mt-1">check_circle</span>
                                    <div>
                                        <h6 class="fw-bold mb-1 text-dark" data-i18n="about_parents">For Parents</h6>
                                        <p class="mb-0 text-muted small" data-i18n="about_parents_desc">Stay informed
                                            with instant updates on
                                            attendance, academic performance, and school events.</p>
                                    </div>
                                </li>
                            </ul>
                            <button class="btn btn-primary-custom rounded-pill px-4 fw-bold"
                                onclick="switchView('register-view')" data-i18n="btn_discover_more">Discover
                                More</button>
                        </div>
                        <div class="col-lg-6">
                            <img src="./static/admin_dashboard_preview.png" alt="Admin Dashboard Preview"
                                class="img-fluid rounded-4 shadow-lg border"
                                style="width: 100%; height: auto; object-fit: cover;">
                        </div>
                    </div>
                </div>
            </section>

            <!-- Statistics Banner -->
            <section class="py-5 bg-light border-top">
                <div class="container">
                    <div class="row text-center">
                        <div class="col-md-4 mb-3 mb-md-0">
                            <h2 class="fw-bold text-primary display-5">10k+</h2>
                            <p class="text-muted fw-medium" data-i18n="stat_active_students">Active Students</p>
                        </div>
                        <div class="col-md-4 mb-3 mb-md-0">
                            <h2 class="fw-bold text-primary display-5">98%</h2>
                            <p class="text-muted fw-medium" data-i18n="stat_engagement">Engagement Rate</p>
                        </div>
                        <div class="col-md-4">
                            <h2 class="fw-bold text-primary display-5">24/7</h2>
                            <p class="text-muted fw-medium" data-i18n="stat_ai_support">AI Support</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <!-- Detailed Footer (ClassDojo Style) -->
            <footer class="pt-5 pb-4" style="background-color: #2e2a5b; color: #fff;">
                <div class="container position-relative">
                    <div class="row g-4 justify-content-between">
                        <!-- Left Column: Brand & Downloads -->
                        <div class="col-lg-3 col-md-12 mb-4 mb-lg-0">
                            <div class="d-flex align-items-center gap-3 mb-3">
                                <img src="./static/noble_logo.png" alt="Logo"
                                    style="width: 50px; height: 50px; border-radius: 12px; object-fit: cover;">
                                <div class="d-flex flex-column">
                                    <span class="fw-bold fs-4 text-white" style="line-height: 1.2;">Class Bridge</span>
                                    <span class="text-white opacity-50 text-uppercase mt-1"
                                        style="font-size: 0.65rem; letter-spacing: 0.5px; line-height: 1.2;"
                                        data-i18n="text_product_by">a product
                                        by Noble Nexus</span>
                                </div>
                            </div>

                            <div class="mb-4 text-white small opacity-75">
                                <div class="d-flex align-items-center gap-2 mb-2">
                                    <span class="material-icons fs-6">location_on</span>
                                    <span>123 Innovation Drive, Tech City, CA 94043</span>
                                </div>
                                <div class="d-flex align-items-center gap-2 mb-2">
                                    <span class="material-icons fs-6">email</span>
                                    <span>support@classbridge.com</span>
                                </div>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="material-icons fs-6">phone</span>
                                    <span>+1 (800) 555-0199</span>
                                </div>
                            </div>
                        </div>

                        <!-- Links Columns -->
                        <div class="col-6 col-lg-2">
                            <h6 class="fw-bold mb-3 text-white" data-i18n="footer_company">Company</h6>
                            <ul class="list-unstyled d-flex flex-column gap-2 small">
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        onclick="openView('aboutCompModal'); return false;"
                                        data-i18n="footer_about">About
                                        us</a></li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_press">Press</a></li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_careers">Careers</a></li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_engineering">Engineering</a>
                                </li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_accessibility">Accessibility</a>
                                </li>
                            </ul>
                        </div>

                        <div class="col-6 col-lg-2">
                            <h6 class="fw-bold mb-3 text-white" data-i18n="footer_resources">Resources</h6>
                            <ul class="list-unstyled d-flex flex-column gap-2 small">
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_big_ideas">Big Ideas</a></li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_training">Training</a></li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_resources">Resources</a>
                                </li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_remote_learning">Remote
                                        Learning</a></li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity">Noble Nexus
                                        Plus</a></li>
                            </ul>
                        </div>

                        <div class="col-6 col-lg-2">
                            <h6 class="fw-bold mb-3 text-white" data-i18n="footer_support">Support</h6>
                            <ul class="list-unstyled d-flex flex-column gap-2 small">
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_help_center">Help Center</a>
                                </li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_contact">Contact</a></li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_privacy">Privacy Center</a>
                                </li>
                                <li><a href="#" class="text-white text-decoration-none hover-opacity"
                                        data-i18n="footer_cookies">Cookie
                                        Settings</a></li>
                            </ul>
                        </div>

                        <!-- Get the App / Noble Nexus Col -->
                        <div class="col-lg-3 d-none d-lg-block">
                            <div class="ps-lg-4">
                                <h6 class="fw-bold mb-3 text-white" data-i18n="footer_get_app">Get the App</h6>

                                <!-- Store Buttons -->
                                <div class="d-flex flex-column gap-2 mb-4">
                                    <img src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg"
                                        alt="App Store" style="height: 40px; cursor: pointer; width: 135px;">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg"
                                        alt="Google Play" style="height: 40px; cursor: pointer; width: 135px;">
                                </div>

                                <div class="mt-4 pt-3 border-top border-secondary border-opacity-25">
                                    <div class="d-flex align-items-start gap-3">
                                        <div class="bg-white p-1 rounded-3 d-inline-block">
                                            <img src="./static/noble_nexus_qr.png" alt="Scan"
                                                style="width: 60px; height: 60px;"
                                                onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://noblenexus.com'">
                                        </div>
                                        <div>
                                            <small class="text-uppercase text-white opacity-50 fw-bold d-block mb-1"
                                                style="font-size: 10px; letter-spacing: 0.5px;">A Product By</small>
                                            <div class="d-flex align-items-center gap-2">
                                                <img src="./static/noble_nexus_logo.png" width="20" height="20"
                                                    class="rounded-circle" onerror="this.style.display='none'">
                                                <span class="fw-bold text-white small">Noble Nexus</span>
                                            </div>
                                            <small class="text-white opacity-50 d-block mt-1" style="font-size: 10px;"
                                                data-i18n="text_scan_visit">Scan to visit</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div
                        class="border-top border-secondary border-opacity-25 mt-5 pt-4 d-flex flex-wrap justify-content-between align-items-center small text-white opacity-75">
                        <div class="d-flex align-items-center gap-3">
                            <span>&copy; 2026 Noble Nexus, Inc.</span>
                            <a href="#" class="text-white text-decoration-none" data-i18n="footer_terms">Terms</a>
                            <a href="#" class="text-white text-decoration-none" data-i18n="footer_privacy">Privacy</a>
                        </div>
                        <div class="d-flex gap-3">
                            <span class="material-icons fs-5 cursor-pointer">facebook</span>
                            <span class="material-icons fs-5 cursor-pointer">share</span>
                            <span class="material-icons fs-5 cursor-pointer">photo_camera</span>
                        </div>
                    </div>
                </div>
            </footer>
        </div>


        <!-- Teachers Landing View (Separate Page) -->
        <div id="teachers-landing-view" class="view"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; overflow-y: auto; background-color: #f8f9fa;">

            <!-- Navbar for Teachers View -->
            <nav class="navbar navbar-expand-lg position-fixed top-0 w-100 py-3 glass-navbar"
                style="background: white; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.05);">
                <div class="container d-flex align-items-center justify-content-between">
                    <a class="navbar-brand d-flex align-items-center gap-3 text-primary-custom"
                        href="javascript:void(0)" onclick="switchView('landing-view')">
                        <img src="./static/class_bridge_logo.jpg" onerror="this.src='./static/noble_nexus_logo.png'"
                            alt="Logo"
                            style="width: 45px; height: 45px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1);">
                        <div class="d-flex flex-column lh-1">
                            <span class="fw-bold fs-4" style="font-family: 'Poppins', sans-serif;">Class Bridge</span>
                        </div>
                    </a>

                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-primary rounded-pill px-4 fw-bold d-none d-md-block"
                            onclick="switchView('landing-view')">
                            Back to Home
                        </button>
                        <button class="btn btn-primary rounded-pill px-4 fw-bold"
                            onclick="selectLoginRole('Teacher'); showLogin()"
                            style="background-color: #4D44B5; border: none;">
                            Teacher Login
                        </button>
                    </div>
                </div>
            </nav>

            <!-- Teachers Content Container -->
            <div class="container" style="padding-top: 100px;">
                <!-- Content will be injected here via JS or hardcoded -->
                <!-- Teachers Specific Section Expanded -->
                <div class="container-fluid p-0">
                    <!-- Hero Section (Dark Theme) -->
                    <section id="teachers-hero" class="py-5 bg-dark position-relative text-white overflow-hidden"
                        style="background: linear-gradient(135deg, #1a1640 0%, #2e2a5b 100%); min-height: 80vh; display: flex; align-items: center;">

                        <div class="container position-relative z-2">
                            <div class="row align-items-center justify-content-center text-center">
                                <div class="col-lg-10">
                                    <span
                                        class="badge bg-white bg-opacity-10 rounded-pill px-3 py-2 mb-4 border border-white border-opacity-25">
                                        Based on a true school story
                                    </span>
                                    <h1 class="display-2 fw-bold mb-4" style="line-height: 1.1;">
                                        The AI-Powered Assistant <br>
                                        <span class="text-transparent bg-clip-text"
                                            style="background: linear-gradient(to right, #a29bfe, #74b9ff); -webkit-background-clip: text; background-clip: text;">
                                            You Always Wished For
                                        </span>
                                    </h1>
                                    <p class="lead opacity-75 mb-5 mx-auto" style="max-width: 700px;">
                                        Class Bridge isn't just a dashboard. It's a co-pilot that grades
                                        papers, plans lessons, and identifies struggling students before
                                        they fall behind.
                                    </p>

                                    <div class="d-flex flex-column flex-sm-row gap-3 justify-content-center">
                                        <button
                                            class="btn btn-primary-custom btn-lg rounded-pill px-5 py-3 fw-bold d-flex align-items-center gap-2 transform-hover justify-content-center"
                                            onclick="document.getElementById('ai-demo-section').scrollIntoView({behavior: 'smooth'})">
                                            <span class="material-icons">play_circle</span> Watch AI Demo
                                        </button>
                                        <button
                                            class="btn btn-outline-light btn-lg rounded-pill px-5 py-3 fw-bold transform-hover"
                                            onclick="selectLoginRole('Teacher'); showLogin()">
                                            Get Started
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Hero Image/Mockup -->
                            <div class="row mt-5 justify-content-center">
                                <div class="col-lg-10">
                                    <div
                                        class="rounded-5 overflow-hidden shadow-lg border border-white border-opacity-10 position-relative">
                                        <img src="https://ui-avatars.com/api/?name=Dashboard+Preview&background=random&size=800"
                                            class="w-100 d-none" alt="Dashboard Helper">
                                        <!-- Simple CSS Mockup if image fails -->
                                        <div class="bg-white p-2" style="height: 400px; position: relative;">
                                            <!-- Header -->
                                            <div class="d-flex align-items-center border-bottom pb-2 px-3 pt-2">
                                                <div class="d-flex gap-2 me-auto">
                                                    <div class="rounded-circle bg-danger"
                                                        style="width:10px;height:10px"></div>
                                                    <div class="rounded-circle bg-warning"
                                                        style="width:10px;height:10px"></div>
                                                    <div class="rounded-circle bg-success"
                                                        style="width:10px;height:10px"></div>
                                                </div>
                                                <div class="small fw-bold text-muted">Class Bridge AI
                                                    Architect</div>
                                            </div>
                                            <!-- Canvas -->
                                            <div class="row h-100 m-0">
                                                <div class="col-3 border-end bg-light p-3">
                                                    <div
                                                        class="skeleton-line w-75 mb-3 bg-secondary opacity-25 rounded">
                                                    </div>
                                                    <div
                                                        class="skeleton-line w-50 mb-3 bg-secondary opacity-25 rounded">
                                                    </div>
                                                    <div
                                                        class="skeleton-line w-100 mb-3 bg-secondary opacity-25 rounded">
                                                    </div>
                                                    <div
                                                        class="skeleton-line w-25 mb-3 bg-secondary opacity-25 rounded">
                                                    </div>
                                                </div>
                                                <div
                                                    class="col-9 p-4 d-flex flex-column align-items-center justify-content-center text-dark">
                                                    <div class="text-center mb-3">
                                                        <span class="material-icons text-primary my-3"
                                                            style="font-size: 48px">auto_awesome</span>
                                                        <h4 class="fw-bold">Generating Lesson Plan...</h4>
                                                        <p class="text-muted">Analyzing curriculum standards
                                                            for Grade 9 History</p>
                                                    </div>
                                                    <div class="progress w-50" style="height: 8px;">
                                                        <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
                                                            role="progressbar" style="width: 75%"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Features Grid -->
                    <section class="py-5" id="ai-demo-section">
                        <div class="container py-5">
                            <div class="text-center mb-5">
                                <small class="text-uppercase fw-bold text-primary ls-1">Features</small>
                                <h2 class="display-5 fw-bold mt-2" data-i18n="feat_modern_title">Built for the Modern
                                    Classroom</h2>
                            </div>

                            <div class="row g-4">
                                <!-- Card 1 -->
                                <div class="col-md-4">
                                    <div
                                        class="p-4 rounded-4 h-100 bg-white shadow-sm border transform-hover position-relative overflow-hidden">
                                        <div class="d-inline-flex align-items-center justify-content-center bg-primary bg-opacity-10 text-primary rounded-circle mb-4"
                                            style="width: 60px; height: 60px;">
                                            <span class="material-icons">quiz</span>
                                        </div>
                                        <h4 class="fw-bold mb-3" data-i18n="feat_quiz_gen">Quiz Generator</h4>
                                        <p class="text-muted" data-i18n="feat_quiz_desc">Upload a PDF chapter, and our
                                            AI generates 20
                                            distinct questions with answer keys in seconds.</p>
                                        <a href="#" class="text-primary fw-bold text-decoration-none stretched-link"
                                            data-i18n="link_try_generator">Try
                                            Generator &rarr;</a>
                                    </div>
                                </div>

                                <!-- Card 2 -->
                                <div class="col-md-4">
                                    <div
                                        class="p-4 rounded-4 h-100 bg-white shadow-sm border transform-hover position-relative overflow-hidden">
                                        <div class="d-inline-flex align-items-center justify-content-center bg-success bg-opacity-10 text-success rounded-circle mb-4"
                                            style="width: 60px; height: 60px;">
                                            <span class="material-icons">insights</span>
                                        </div>
                                        <h4 class="fw-bold mb-3" data-i18n="feat_student_insights">Student Insights</h4>
                                        <p class="text-muted" data-i18n="feat_student_insights_desc">Beyond grades. See
                                            who is trying hard but
                                            struggling, and who needs more challenging material.</p>
                                        <a href="#" class="text-success fw-bold text-decoration-none stretched-link"
                                            data-i18n="link_view_report">View
                                            Sample Report &rarr;</a>
                                    </div>
                                </div>

                                <!-- Card 3 -->
                                <div class="col-md-4">
                                    <div
                                        class="p-4 rounded-4 h-100 bg-white shadow-sm border transform-hover position-relative overflow-hidden">
                                        <div class="d-inline-flex align-items-center justify-content-center bg-danger bg-opacity-10 text-danger rounded-circle mb-4"
                                            style="width: 60px; height: 60px;">
                                            <span class="material-icons">videocam</span>
                                        </div>
                                        <h4 class="fw-bold mb-3" data-i18n="feat_hybrid">Hybrid Classroom</h4>
                                        <p class="text-muted" data-i18n="feat_hybrid_desc">Seamlessly switch between
                                            in-person and remote
                                            teaching with built-in video logic.</p>
                                        <a href="#" class="text-danger fw-bold text-decoration-none stretched-link"
                                            data-i18n="link_see_how">See
                                            How &rarr;</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Call to Action Footer within view -->
                    <section class="py-5 bg-light border-top">
                        <div class="container text-center py-5">
                            <h2 class="fw-bold mb-4" data-i18n="cta_ready_transform">Ready to transform your teaching?
                            </h2>
                            <button class="btn btn-primary-custom btn-lg rounded-pill px-5 shadow-lg"
                                onclick="selectLoginRole('Teacher'); showLogin()" data-i18n="btn_join_free">
                                Join Class Bridge for Free
                            </button>
                        </div>
                    </section>
                </div>
            </div>
        </div>


        <!-- Role & Permission Management View -->
        <div id="roles-view" class="view">
            <div class="row mb-4 align-items-center">
                <div class="col">
                    <h2 class="fw-bold mb-1">Access Control</h2>
                    <p class="text-muted mb-0">Manage roles and system permissions.</p>
                </div>
            </div>

            <!-- Tabs -->
            <ul class="nav nav-tabs mb-4" id="rbacTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active fw-bold" id="roles-tab" data-bs-toggle="tab"
                        data-bs-target="#roles-pane" type="button" role="tab" aria-selected="true">Roles</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link fw-bold" id="perms-tab" data-bs-toggle="tab" data-bs-target="#perms-pane"
                        type="button" role="tab" aria-selected="false"
                        onclick="loadPermissionsList()">Permissions</button>
                </li>
            </ul>

            <div class="tab-content" id="rbacTabContent">
                <!-- ROLES TAB -->
                <div class="tab-pane fade show active" id="roles-pane" role="tabpanel" aria-labelledby="roles-tab">
                    <div class="d-flex justify-content-end mb-3" id="role-create-action">
                        <!-- Create Button rendered via JS -->
                    </div>

                    <div class="card border-0 shadow-sm">
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="bg-light">
                                        <tr>
                                            <th class="ps-4">Code</th>
                                            <th>Role Title</th>
                                            <th>Status</th>
                                            <th>Description</th>
                                            <th class="text-end pe-4">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="roles-table-body">
                                        <!-- Roles populated via JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PERMISSIONS TAB -->
                <div class="tab-pane fade" id="perms-pane" role="tabpanel" aria-labelledby="perms-tab">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="bg-light">
                                        <tr>
                                            <th class="ps-4">Permission Code</th>
                                            <th>Permission Title</th>
                                            <th>Description</th>
                                            <th class="text-end pe-4">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="perms-table-body">
                                        <!-- Perms populated via JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ROLE FORM VIEW -->
        <div id="role-form-view" class="view">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div class="d-flex align-items-center gap-3">
                    <button class="btn btn-light rounded-circle shadow-sm" onclick="switchView('roles-view')">
                        <span class="material-icons text-dark">arrow_back</span>
                    </button>
                    <h1 class="h3 fw-bold text-dark mb-0" id="role-form-title">Create Role</h1>
                </div>
            </div>

            <div class="card border-0 shadow-sm rounded-4 p-4">
                <form id="role-form">
                    <input type="hidden" id="role-id">

                    <!-- Section 1: General Detail -->
                    <h6 class="fw-bold text-primary mb-3">1. General Details</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted text-uppercase">Role Title</label>
                            <input type="text" class="form-control bg-light border-0" id="role-name"
                                placeholder="e.g. Lab Assistant" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted text-uppercase">Status</label>
                            <div class="d-flex gap-3 mt-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="roleStatus" id="statusActive"
                                        value="Active" checked>
                                    <label class="form-check-label" for="statusActive">Active</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="roleStatus" id="statusInactive"
                                        value="Inactive">
                                    <label class="form-check-label" for="statusInactive">Inactive</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label class="form-label small fw-bold text-muted text-uppercase">Description</label>
                            <textarea class="form-control bg-light border-0" id="role-desc" rows="2"
                                placeholder="Describe the role..."></textarea>
                        </div>
                    </div>

                    <!-- Section 2: Permission Association -->
                    <h6 class="fw-bold text-primary mb-3">2. Permission Association</h6>
                    <div class="bg-light rounded p-3 mb-4" style="max-height: 500px; overflow-y: auto;">
                        <div id="role-perms-container">
                            <!-- Perms populated via JS -->
                            <div class="text-center p-3">
                                <div class="spinner-border spinner-border-sm text-muted"></div>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end gap-2">
                        <button type="button" class="btn btn-light" onclick="switchView('roles-view')">Cancel</button>
                        <button type="button" class="btn btn-primary-custom px-4" onclick="handleSaveRole()">Save
                            Role</button>
                    </div>
                </form>
            </div>
        </div>


        <!-- Resources & Policy Library View -->
        <div id="resources-view" class="view">
            <div class="row mb-4 align-items-center">
                <div class="col">
                    <!-- Title handled by page-title in header -->
                </div>
                <div class="col-auto">
                    <button class="btn btn-primary-custom d-none" id="btn-upload-resource"
                        onclick="openUploadResourceModal()">
                        <span class="material-icons align-middle fs-5 me-1">upload_file</span>
                        Upload Resource
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body py-3">
                    <div class="d-flex gap-3 align-items-center font-weight-bold">
                        <button class="btn btn-sm btn-outline-primary active rounded-pill px-3"
                            data-resource-category="All"
                            onclick="filterResources('All', this)">All</button>
                        <button class="btn btn-sm btn-outline-primary rounded-pill px-3"
                            data-resource-category="Policy"
                            onclick="filterResources('Policy', this)">Policies</button>
                        <button class="btn btn-sm btn-outline-primary rounded-pill px-3"
                            data-resource-category="Schedule"
                            onclick="filterResources('Schedule', this)">Exam Schedules</button>
                        <button class="btn btn-sm btn-outline-primary rounded-pill px-3"
                            data-resource-category="Form"
                            onclick="filterResources('Form', this)">Forms</button>
                        <button class="btn btn-sm btn-outline-primary rounded-pill px-3"
                            data-resource-category="Other"
                            onclick="filterResources('Other', this)">Other</button>
                    </div>
                </div>
            </div>

            <!-- Resources List -->
            <div class="row g-4" id="resources-list-container">
                <!-- Injected via JS -->
                <div class="col-12 text-center py-5 text-muted">
                    <div class="spinner-border text-primary" role="status"></div>
                </div>
            </div>
        </div>

        <!-- UPLOAD RESOURCE VIEW (Converted from Modal) -->
        <div id="upload-resource-view" class="view">
            <div class="row mb-4 align-items-center">
                <div class="col-auto">
                    <button class="btn btn-light rounded-circle border shadow-sm"
                        onclick="switchView('resources-view')">
                        <span class="material-icons text-dark">arrow_back</span>
                    </button>
                </div>
                <div class="col">
                    <h2 class="fw-bold mb-1">Upload New Resource</h2>
                    <p class="text-muted mb-0">Add policies, schedules, or forms to the library.</p>
                </div>
            </div>

            <div class="card border-0 shadow-sm glass-card-solid" style="max-width: 800px; margin: 0 auto;">
                <div class="card-body p-5">
                    <form id="upload-resource-form-view" onsubmit="handleUploadResourceView(event)">
                        <div class="mb-4">
                            <label class="form-label small fw-bold text-muted text-uppercase">Title</label>
                            <input type="text" class="form-control bg-light border-0 p-3" id="res-title-view"
                                placeholder="e.g. Annual Exam Schedule 2026" required>
                        </div>
                        <div class="mb-4">
                            <label class="form-label small fw-bold text-muted text-uppercase">Category</label>
                            <select class="form-select bg-light border-0 p-3" id="res-category-view"
                                onchange="handleResourceCategoryChange()">
                                <option value="Policy">School Policy</option>
                                <option value="Schedule">Exam Schedule</option>
                                <option value="Form">Leave/Admin Form</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="mb-4 d-none" id="resource-template-wrap">
                            <label class="form-label small fw-bold text-muted text-uppercase">Form Template</label>
                            <select class="form-select bg-light border-0 p-3" id="res-template-view"
                                onchange="handleResourceTemplateChange()">
                                <option value="">Custom Form (Upload your own file)</option>
                            </select>
                            <div class="form-text text-muted small">Choose a template to auto-publish a standard school form.</div>
                        </div>
                        <div class="mb-4 d-none" id="resource-school-wrap">
                            <label class="form-label small fw-bold text-muted text-uppercase">School</label>
                            <select class="form-select bg-light border-0 p-3" id="res-school-view"></select>
                            <div class="form-text text-muted small">Admin can choose target school for this resource.</div>
                        </div>
                        <div class="mb-4">
                            <label class="form-label small fw-bold text-muted text-uppercase">Description</label>
                            <textarea class="form-control bg-light border-0 p-3" id="res-desc-view" rows="4"
                                placeholder="Brief description of the document..."></textarea>
                        </div>
                        <div class="mb-4">
                            <label class="form-label small fw-bold text-muted text-uppercase">File (PDF, Doc,
                                Image)</label>
                            <div class="p-5 border-2 border-dashed rounded-3 text-center bg-light position-relative">
                                <span class="material-icons fs-1 text-muted mb-2">cloud_upload</span>
                                <p class="small text-muted mb-3">Drag & drop or click to upload</p>
                                <input type="file"
                                    class="form-control position-absolute top-0 start-0 w-100 h-100 opacity-0"
                                    id="res-file-view" accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png" required
                                    style="cursor: pointer;"
                                    onchange="document.getElementById('file-name-display').textContent = this.files[0]?.name; document.getElementById('file-name-display').classList.remove('d-none');">
                                <div id="file-name-display" class="small fw-bold text-primary mt-2 d-none"></div>
                            </div>
                            <div class="form-text text-muted small mt-2">Max size 10MB. Supported: PDF, DOCX, TXT, JPG,
                                PNG</div>
                        </div>
                        <div class="d-flex justify-content-end gap-3 mt-5">
                            <button type="button" class="btn btn-light border px-4 rounded-pill"
                                onclick="switchView('resources-view')">Cancel</button>
                            <button type="submit"
                                class="btn btn-primary-custom px-5 rounded-pill fw-bold shadow-sm">Upload
                                Resource</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ADD USER VIEW (Converted from Modal) -->
        <div id="add-user-view" class="view">
            <div class="row mb-4 align-items-center">
                <div class="col-auto">
                    <button class="btn btn-light rounded-circle border shadow-sm" onclick="switchView('staff-view')">
                        <!-- Default back to staff/users -->
                        <span class="material-icons text-dark">arrow_back</span>
                    </button>
                </div>
                <div class="col">
                    <h2 class="fw-bold mb-1">Create New User</h2>
                    <p class="text-muted mb-0">Onboard a new student, teacher, or staff member.</p>
                </div>
            </div>

            <div class="card border-0 shadow-sm glass-card-solid" style="max-width: 800px; margin: 0 auto;">
                <div class="card-body p-5">
                    <form id="add-user-form-view" onsubmit="handleCreateUserView(event)">
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" id="new-user-name-view" class="form-control bg-light border-0"
                                        placeholder="Full Name" required>
                                    <label>Full Name</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" id="new-user-id-view" class="form-control bg-light border-0"
                                        placeholder="Email or Unique ID" required>
                                    <label>Email or Unique ID</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <select id="new-user-role-view" class="form-select bg-light border-0" required
                                        onchange="toggleUserFieldsView()">
                                        <option value="Student">Student</option>
                                        <option value="Teacher">Teacher</option>
                                        <option value="Parent_Guardian">Parent / Guardian</option>
                                        <option value="Tenant_Admin">Tenant Admin (Principal)</option>
                                        <option value="Academic_Admin">Academic Admin</option>
                                        <option value="HR_Admin">HR Admin</option>
                                        <option value="Root_Super_Admin">Root Super Admin</option>
                                    </select>
                                    <label>Role</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="password" id="new-user-password-view"
                                        class="form-control bg-light border-0" placeholder="Password" required>
                                    <label>Password</label>
                                </div>
                                <small class="text-muted ms-1" style="font-size: 11px;">Min 8 chars, 1 number, 1 special
                                    char.</small>
                            </div>

                            <!-- Conditional Fields -->
                            <div class="col-12" id="student-fields-view">
                                <div class="form-floating">
                                    <select id="new-user-grade-view" class="form-select bg-light border-0">
                                        <option value="9">Grade 9</option>
                                        <option value="10">Grade 10</option>
                                        <option value="11">Grade 11</option>
                                        <option value="12">Grade 12</option>
                                    </select>
                                    <label>Grade</label>
                                </div>
                            </div>
                            <div class="col-12" id="teacher-fields-view" style="display:none;">
                                <div class="form-floating">
                                    <input type="text" id="new-user-subject-view" class="form-control bg-light border-0"
                                        placeholder="Science">
                                    <label>Preferred/Teaching Subject</label>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-end gap-3 mt-5">
                            <button type="button" class="btn btn-light border px-4 rounded-pill"
                                onclick="switchView('staff-view')">Cancel</button>
                            <button type="submit"
                                class="btn btn-primary-custom px-5 rounded-pill fw-bold shadow-sm">Create User</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>


        <!-- NEW VIEWS FOR SIDEBAR SUB-MENUS -->
        <!-- Create Class View -->
        <div id="create-class-view" class="view">
            <h2 class="fw-bold mb-4">Create New Class</h2>
            <div class="card p-4 border-0 shadow-sm">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Class Name</label>
                        <input type="text" class="form-control" placeholder="e.g. Mathematics 101">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Grade Level</label>
                        <select class="form-select">
                            <option>Grade 9</option>
                            <option>Grade 10</option>
                            <option>Grade 11</option>
                            <option>Grade 12</option>
                        </select>
                    </div>
                    <button type="button" class="btn btn-primary-custom" onclick="alert('Class Created!')">Create
                        Class</button>
                </form>
            </div>
        </div>

        <!-- Attendance Report View -->
        <div id="attendance-report-view" class="view">
            <h2 class="fw-bold mb-4">Attendance Report</h2>
            <div class="card p-4 border-0 shadow-sm">
                <p class="text-muted">Attendance analytics and reports will appear here.</p>
                <div class="d-flex gap-3">
                    <button class="btn btn-outline-primary">Download CSV</button>
                    <button class="btn btn-outline-info">Print Report</button>
                </div>
            </div>
        </div>

        <!-- Performance Report View -->
        <div id="performance-report-view" class="view">
            <h2 class="fw-bold mb-4">Performance Report</h2>
            <div class="card p-4 border-0 shadow-sm">
                <p class="text-muted">Detailed student performance metrics will appear here.</p>
            </div>
        </div>

        <!-- Upcoming Exams View -->
        <div id="upcoming-exams-view" class="view container-fluid p-4">
            <h2 class="fw-bold mb-4">Upcoming Exams & Tests</h2>
            <div id="student-exams-list-container" class="row g-4">
                <div class="col-12 text-center py-5">
                    <div class="spinner-border text-primary"></div>
                    <p class="text-muted mt-2">Loading Exams...</p>
                </div>
            </div>
        </div>

        <!-- Student Take PDF Exam View -->
        <div id="student-take-pdf-exam-view" class="view container-fluid h-100 p-0" style="background: #f8f9fa;">
            <div class="d-flex flex-column h-100">
                <!-- Sticky Header -->
                <div class="bg-white shadow-sm p-3 d-flex flex-wrap justify-content-between align-items-center sticky-top flex-shrink-0"
                    style="z-index: 1020;">
                    <div class="mb-2 mb-md-0">
                        <h5 class="fw-bold mb-0 text-primary" id="take-exam-title">Mathematics Mid-Term</h5>
                        <small class="text-muted">Read questions carefully and upload your answer sheet.</small>
                    </div>
                    <div class="d-flex align-items-center gap-4">
                        <div class="text-center px-3 py-1 bg-light rounded-3 border">
                            <small class="text-uppercase text-muted fw-bold" style="font-size: 0.7rem;">Time
                                Remaining</small>
                            <div id="exam-timer-display" class="fw-bold fs-4 text-danger font-monospace">00:00:00</div>
                        </div>
                        <button class="btn btn-danger fw-bold px-4" onclick="finishExamEarly()">Finish Exam</button>
                    </div>
                </div>

                <!-- Content Split -->
                <div class="row g-0 flex-grow-1 overflow-hidden">
                    <!-- Left: Question Paper -->
                    <div class="col-lg-8 border-end h-100">
                        <iframe id="exam-pdf-viewer" src="" width="100%" height="100%"
                            style="border:none; height: 85vh;"></iframe>
                    </div>

                    <!-- Right: Answer Upload -->
                    <div class="col-lg-4 bg-white h-100 overflow-auto p-4">
                        <h5 class="fw-bold mb-3">Submit Answers</h5>
                        <div class="alert alert-info small">
                            <i class="material-icons align-middle fs-6 me-1">info</i>
                            Write your answers on paper, scan them as a single PDF, and upload below.
                        </div>

                        <form id="exam-submission-form" onsubmit="event.preventDefault(); submitAnswerSheet();">
                            <input type="hidden" id="current-exam-id">

                            <div class="mb-4">
                                <label class="form-label fw-bold">Upload Answer Sheet (PDF)</label>
                                <input type="file" id="answer-sheet-file" class="form-control" accept="application/pdf"
                                    required>
                            </div>

                            <div class="d-grid">
                                <button type="submit"
                                    class="btn btn-success py-3 fw-bold rounded-pill text-uppercase shadow-sm">
                                    <span class="material-icons align-middle me-2">upload</span> Submit Answer Sheet
                                </button>
                            </div>
                        </form>

                        <hr class="my-5">

                        <div class="text-center text-muted">
                            <small>Need Help?</small><br>
                            <small>Contact your proctor or teacher immediately if you face technical issues.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Upload Resource Modal (Legacy) -->
        <div class="view full-page-view" id="uploadResourceModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow">
                    <div class="modal-header border-bottom-0 pb-0">
                        <h5 class="modal-title fw-bold" data-i18n="modal_upload_resource">Upload Resource</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body pt-4">
                        <form id="upload-resource-form">
                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted text-uppercase"
                                    data-i18n="label_res_title">Title</label>
                                <input type="text" class="form-control bg-light border-0" id="res-title" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted text-uppercase"
                                    data-i18n="label_res_category">Category</label>
                                <select class="form-select bg-light border-0" id="res-category">
                                    <option value="Policy" data-i18n="opt_school_policy">School Policy</option>
                                    <option value="Schedule" data-i18n="opt_exam_schedule">Exam Schedule</option>
                                    <option value="Form" data-i18n="opt_form">Leave/Admin Form</option>
                                    <option value="Other" data-i18n="opt_other">Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted text-uppercase"
                                    data-i18n="label_res_desc">Description</label>
                                <textarea class="form-control bg-light border-0" id="res-desc" rows="2"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted text-uppercase"
                                    data-i18n="label_res_file">File (PDF,
                                    Doc)</label>
                                <input type="file" class="form-control bg-light border-0" id="res-file"
                                    accept=".pdf,.doc,.docx,.txt" required>
                                <div class="form-text text-muted small" data-i18n="text_max_size">Max size 5MB</div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer border-top-0 pt-0">
                        <button type="button" class="btn btn-light rounded-pill px-4 fw-bold"
                            data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary rounded-pill px-4 fw-bold shadow-sm"
                            onclick="handleUploadResource()">Upload</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Permission Edit Modal -->
        <div class="view full-page-view" id="permEditModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow">
                    <div class="modal-header border-bottom-0 pb-0">
                        <h5 class="modal-title fw-bold" data-i18n="modal_edit_permission">Edit Permission</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body pt-4">
                        <form id="perm-edit-form">
                            <input type="hidden" id="perm-edit-id">

                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted text-uppercase"
                                    data-i18n="label_perm_code">Permission
                                    Code</label>
                                <input type="text" class="form-control bg-light" id="perm-edit-code" disabled>
                            </div>

                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted text-uppercase"
                                    data-i18n="label_perm_title">Permission
                                    Title</label>
                                <input type="text" class="form-control bg-light" id="perm-edit-title" disabled>
                            </div>

                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted text-uppercase"
                                    data-i18n="label_res_desc">Description</label>
                                <textarea class="form-control" id="perm-edit-desc" rows="3" required></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer border-top-0 pt-0">
                        <button type="button" class="btn btn-light rounded-pill px-4 fw-bold" data-bs-dismiss="modal"
                            data-i18n="btn_cancel">Cancel</button>
                        <button type="button" class="btn btn-primary rounded-pill px-4 fw-bold shadow-sm"
                            onclick="handleUpdatePermission()" data-i18n="btn_update">Update</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Role Modal -->


        <div id="students-landing-view" class="view"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; overflow-y: auto; background-color: #f0f9ff;">

            <!-- Navbar for Students View -->
            <nav class="navbar navbar-expand-lg position-fixed top-0 w-100 py-3 glass-navbar"
                style="background: white; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.05);">
                <div class="container d-flex align-items-center justify-content-between">
                    <a class="navbar-brand d-flex align-items-center gap-3 text-primary-custom"
                        href="javascript:void(0)" onclick="switchView('landing-view')">
                        <img src="./static/class_bridge_logo.jpg" onerror="this.src='./static/noble_nexus_logo.png'"
                            alt="Logo"
                            style="width: 45px; height: 45px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1);">
                        <div class="d-flex flex-column lh-1">
                            <span class="fw-bold fs-4" style="font-family: 'Poppins', sans-serif;">Class
                                Bridge</span>
                            <span class="text-muted text-uppercase fw-medium"
                                style="font-size: 0.55rem; letter-spacing: 0.5px;">a product by Noble Nexus</span>
                        </div>
                    </a>

                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-primary rounded-pill px-4 fw-bold"
                            onclick="switchView('landing-view')">
                            Back
                        </button>
                        <button class="btn btn-primary rounded-pill px-4 fw-bold"
                            onclick="selectLoginRole('Student'); showLogin()"
                            style="background-color: #0ea5e9; border: none;">
                            Student Login
                        </button>
                    </div>
                </div>
            </nav>

            <div class="container" style="padding-top: 100px;">
                <div class="container-fluid p-0">
                    <!-- Hero Section (Blue Theme) -->
                    <section id="students-hero"
                        class="py-5 position-relative text-white overflow-hidden rounded-5 shadow-lg mb-5"
                        style="background: linear-gradient(135deg, #0284c7 0%, #0369a1 100%); min-height: 75vh; display: flex; align-items: center;">

                        <div class="container position-relative z-2">
                            <div class="row align-items-center">
                                <div class="col-lg-6 text-start">
                                    <span
                                        class="badge bg-white bg-opacity-20 rounded-pill px-3 py-2 mb-4 border border-white border-opacity-25">
                                        For Students
                                    </span>
                                    <h1 class="display-3 fw-bold mb-4" style="line-height: 1.1;">
                                        Learning Just Got <br>
                                        <span class="text-warning">Superpowered.</span>
                                    </h1>
                                    <p class="lead opacity-90 mb-5">
                                        Stuck on homework? Need a practice quiz? Your AI tutor is here 24/7.
                                        Earn badges, track your growth, and crush your exams.
                                    </p>

                                    <div class="d-flex gap-3">
                                        <button
                                            class="btn btn-light fw-bold btn-lg rounded-pill px-5 py-3 shadow-lg transform-hover"
                                            onclick="selectLoginRole('Student'); showLogin()"
                                            style="color: #0284c7 !important;">
                                            Start Learning
                                        </button>
                                        <button
                                            class="btn btn-outline-light btn-lg rounded-pill px-5 py-3 fw-bold transform-hover"
                                            onclick="document.getElementById('student-features').scrollIntoView({behavior: 'smooth'})">
                                            Explore
                                        </button>
                                    </div>
                                </div>
                                <div class="col-lg-6 d-none d-lg-block position-relative">
                                    <!-- Mockup of Student UI -->
                                    <div class="bg-white p-3 rounded-4 shadow-lg text-dark transform-hover"
                                        style="transform: rotate(-2deg); max-width: 450px; margin-left: auto;">
                                        <div class="d-flex align-items-center mb-3">
                                            <div class="bg-primary bg-opacity-10 p-2 rounded-circle me-3">
                                                <span class="material-icons text-primary">psychology_alt</span>
                                            </div>
                                            <div>
                                                <h6 class="fw-bold mb-0">AI Tutor</h6>
                                                <small class="text-muted">Just now</small>
                                            </div>
                                        </div>
                                        <div class="bg-light p-3 rounded-3 mb-3 small">
                                            "Great job on that algebra problem! You've mastered quadratic equations.
                                            Ready for a challenge?"
                                        </div>
                                        <div class="d-flex gap-2">
                                            <div
                                                class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-25 p-2 px-3 rounded-pill">
                                                +50 XP
                                            </div>
                                            <div
                                                class="badge bg-warning bg-opacity-10 text-warning border border-warning border-opacity-25 p-2 px-3 rounded-pill">
                                                 Streak: 5 Days
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-white p-3 rounded-4 shadow-lg text-dark transform-hover position-absolute top-100 start-0 translate-middle-y"
                                        style="transform: rotate(3deg); bottom: -40px; left: -50px; width: 300px; z-index: -1;">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span class="fw-bold small">Next Class: Physics</span>
                                            <span class="badge bg-danger rounded-pill">Live</span>
                                        </div>
                                        <div class="progress" style="height: 6px;">
                                            <div class="progress-bar bg-danger w-75"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Features Grid -->
                    <section class="py-5 px-3" id="student-features">
                        <div class="container">
                            <div class="text-center mb-5">
                                <h2 class="display-6 fw-bold">Everything you need to ace it.</h2>
                            </div>

                            <div class="row g-4">
                                <!-- Feature 1 -->
                                <div class="col-md-4 fade-in-up delay-100">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-info">
                                                <span class="material-icons fs-1 anim-icon anim-icon-1">chat</span>
                                            </div>
                                            <h4 class="fw-bold">24/7 AI Help</h4>
                                            <p class="text-muted">Never get stuck again. Ask questions and get
                                                instant,
                                                step-by-step explanations.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Feature 2 -->
                                <div class="col-md-4 fade-in-up delay-200">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-warning">
                                                <span
                                                    class="material-icons fs-1 anim-icon anim-icon-2">emoji_events</span>
                                            </div>
                                            <h4 class="fw-bold">Gamified Growth</h4>
                                            <p class="text-muted">Earn XP, unlock badges, and climb the leaderboard
                                                as
                                                you
                                                complete assignments.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Feature 3 -->
                                <div class="col-md-4 fade-in-up delay-300">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-purple" style="color: #8b5cf6;">
                                                <span
                                                    class="material-icons fs-1 anim-icon anim-icon-3">auto_graph</span>
                                            </div>
                                            <h4 class="fw-bold">Smart Insights</h4>
                                            <p class="text-muted">Understand your strengths and weaknesses with
                                                personalized
                                                performance analytics.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>


        <!-- Schools Landing View (Separate Page) -->
        <div id="schools-landing-view" class="view"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; overflow-y: auto; background-color: #fafbfc;">

            <!-- Navbar for Schools View -->
            <nav class="navbar navbar-expand-lg position-fixed top-0 w-100 py-3 glass-navbar"
                style="background: white; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.05);">
                <div class="container d-flex align-items-center justify-content-between">
                    <a class="navbar-brand d-flex align-items-center gap-3 text-primary-custom"
                        href="javascript:void(0)" onclick="switchView('landing-view')">
                        <img src="./static/class_bridge_logo.jpg" onerror="this.src='./static/noble_nexus_logo.png'"
                            alt="Logo"
                            style="width: 45px; height: 45px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1);">
                        <div class="d-flex flex-column lh-1">
                            <span class="fw-bold fs-4" style="font-family: 'Poppins', sans-serif;">Class
                                Bridge</span>
                            <span class="text-muted text-uppercase fw-medium"
                                style="font-size: 0.55rem; letter-spacing: 0.5px;">a product by Noble Nexus</span>
                        </div>
                    </a>

                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-primary rounded-pill px-4 fw-bold"
                            onclick="switchView('landing-view')">
                            Back
                        </button>
                        <button class="btn btn-primary rounded-pill px-4 fw-bold"
                            onclick="selectLoginRole('Teacher'); showLogin()"
                            style="background-color: #4D44B5; border: none;">
                            Admin Login
                        </button>
                    </div>
                </div>
            </nav>

            <div class="container" style="padding-top: 100px;">
                <div class="container-fluid p-0">
                    <!-- Hero Section (Purple/Admin Theme) -->
                    <section id="schools-hero"
                        class="py-5 position-relative text-white overflow-hidden rounded-5 shadow-lg mb-5"
                        style="background: linear-gradient(135deg, #4D44B5 0%, #3a32a0 100%); min-height: 75vh; display: flex; align-items: center;">

                        <!-- Background Animation Target -->

                        <div class="container position-relative z-2">
                            <div class="row align-items-center">
                                <div class="col-lg-6 text-start">
                                    <span
                                        class="badge bg-white bg-opacity-20 rounded-pill px-3 py-2 mb-4 border border-white border-opacity-25">
                                        For Schools & Districts
                                    </span>
                                    <h1 class="display-3 fw-bold mb-4" style="line-height: 1.1;">
                                        Manage Your Empire <br>
                                        <span class="text-warning">Effortlessly.</span>
                                    </h1>
                                    <p class="lead opacity-90 mb-5">
                                        From attendance to analytics, empower your entire institution with a unified
                                        ecosystem that principals and admins love.
                                    </p>

                                    <div class="d-flex gap-3">
                                        <button
                                            class="btn btn-light text-primary-custom fw-bold btn-lg rounded-pill px-5 py-3 shadow-lg transform-hover"
                                            onclick="selectLoginRole('Admin'); showLogin()">
                                            Get Started
                                        </button>
                                        <button
                                            class="btn btn-outline-light btn-lg rounded-pill px-5 py-3 fw-bold transform-hover"
                                            onclick="document.getElementById('school-features').scrollIntoView({behavior: 'smooth'})">
                                            See Features
                                        </button>
                                    </div>
                                </div>
                                <div class="col-lg-6 d-none d-lg-block position-relative">
                                    <!-- Mockup of Dashboard -->
                                    <div class="bg-white p-2 rounded-4 shadow-lg text-dark transform-hover"
                                        style="transform: rotate(1deg); max-width: 500px; margin-left: auto;">
                                        <div class="bg-light p-3 rounded-3 mb-2 d-flex justify-content-between">
                                            <strong>Total Students</strong>
                                            <span class="text-primary fw-bold">12,450</span>
                                        </div>
                                        <div class="bg-light p-3 rounded-3 mb-2 d-flex justify-content-between">
                                            <strong>Teacher Retention</strong>
                                            <span class="text-success fw-bold">98%</span>
                                        </div>
                                        <div class="bg-light p-3 rounded-3 d-flex justify-content-between">
                                            <strong>Avg Grade</strong>
                                            <span class="text-warning fw-bold">A-</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Features Grid -->
                    <section class="py-5 px-3" id="school-features">
                        <div class="container">
                            <div class="text-center mb-5">
                                <h2 class="display-6 fw-bold">Enterprise-Grade Control.</h2>
                            </div>

                            <div class="row g-4">
                                <!-- Feature 1 -->
                                <div class="col-md-4">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-primary">
                                                <span class="material-icons fs-1">dashboard</span>
                                            </div>
                                            <h4 class="fw-bold">Unified Dashboard</h4>
                                            <p class="text-muted">Monitor attendance, grades, and behavior across
                                                all
                                                classrooms in real-time.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Feature 2 -->
                                <div class="col-md-4">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-success">
                                                <span class="material-icons fs-1">analytics</span>
                                            </div>
                                            <h4 class="fw-bold">Smart Analytics</h4>
                                            <p class="text-muted">Data-driven insights to identify at-risk students
                                                and
                                                improve curriculum effectiveness.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Feature 3 -->
                                <div class="col-md-4">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-info">
                                                <span class="material-icons fs-1">security</span>
                                            </div>
                                            <h4 class="fw-bold">Secure & Scalable</h4>
                                            <p class="text-muted">Bank-level encryption and privacy complaince
                                                derived
                                                from the ground up.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>


        <!-- Resources Landing View (Separate Page) -->
        <div id="resources-landing-view" class="view"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; overflow-y: auto; background-color: #f0fdf4;">

            <!-- Navbar for Resources View -->
            <nav class="navbar navbar-expand-lg position-fixed top-0 w-100 py-3 glass-navbar"
                style="background: white; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.05);">
                <div class="container d-flex align-items-center justify-content-between">
                    <a class="navbar-brand d-flex align-items-center gap-3 text-primary-custom"
                        href="javascript:void(0)" onclick="switchView('landing-view')">
                        <img src="./static/class_bridge_logo.jpg" onerror="this.src='./static/noble_nexus_logo.png'"
                            alt="Logo"
                            style="width: 45px; height: 45px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1);">
                        <div class="d-flex flex-column lh-1">
                            <span class="fw-bold fs-4" style="font-family: 'Poppins', sans-serif;">Class
                                Bridge</span>
                            <span class="text-muted text-uppercase fw-medium"
                                style="font-size: 0.55rem; letter-spacing: 0.5px;">a product by Noble Nexus</span>
                        </div>
                    </a>

                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-primary rounded-pill px-4 fw-bold"
                            onclick="switchView('landing-view')">
                            Back
                        </button>
                        <button class="btn btn-primary rounded-pill px-4 fw-bold"
                            onclick="selectLoginRole('Teacher'); showLogin()"
                            style="background-color: #059669; border: none;">
                            Teacher Access
                        </button>
                    </div>
                </div>
            </nav>

            <div class="container" style="padding-top: 100px;">
                <div class="container-fluid p-0">
                    <!-- Hero Section (Green/Resources Theme) -->
                    <section id="resources-hero"
                        class="py-5 position-relative text-white overflow-hidden rounded-5 shadow-lg mb-5"
                        style="background: linear-gradient(135deg, #059669 0%, #047857 100%); min-height: 75vh; display: flex; align-items: center;">

                        <!-- Background Animation Target -->

                        <div class="container position-relative z-2">
                            <div class="row align-items-center">
                                <div class="col-lg-6 text-start">
                                    <span
                                        class="badge bg-white bg-opacity-20 rounded-pill px-3 py-2 mb-4 border border-white border-opacity-25">
                                        Content Library
                                    </span>
                                    <h1 class="display-3 fw-bold mb-4" style="line-height: 1.1;">
                                        World-Class Content. <br>
                                        <span class="text-warning">Zero Friction.</span>
                                    </h1>
                                    <p class="lead opacity-90 mb-5">
                                        Stop reinventing the wheel. Access thousands of vetted lesson plans,
                                        interactive quizzes, and multimedia assets instantly.
                                    </p>

                                    <div class="d-flex gap-3">
                                        <button
                                            class="btn btn-light text-success fw-bold btn-lg rounded-pill px-5 py-3 shadow-lg transform-hover"
                                            onclick="selectLoginRole('Teacher'); showLogin()">
                                            Browse Library
                                        </button>
                                        <button
                                            class="btn btn-outline-light btn-lg rounded-pill px-5 py-3 fw-bold transform-hover"
                                            onclick="document.getElementById('resource-features').scrollIntoView({behavior: 'smooth'})">
                                            Learn More
                                        </button>
                                    </div>
                                </div>
                                <div class="col-lg-6 d-none d-lg-block position-relative">
                                    <!-- Mockup of Content Card -->
                                    <div class="bg-white p-3 rounded-4 shadow-lg text-dark transform-hover"
                                        style="transform: rotate(2deg); max-width: 450px; margin-left: auto;">
                                        <!-- Fake Video Player -->
                                        <div class="bg-dark rounded-3 mb-3 position-relative d-flex align-items-center justify-content-center"
                                            style="height: 200px; background: #e5e7eb;">
                                            <span
                                                class="material-icons text-white display-1 opacity-75">play_circle_filled</span>
                                            <div
                                                class="position-absolute bottom-0 start-0 p-3 text-white w-100 bg-gradient-to-t from-black to-transparent">
                                                <small>Science  Grade 10</small>
                                                <h6 class="mb-0">Understanding Photosynthesis</h6>
                                            </div>
                                        </div>
                                        <div class="d-flex gap-2 mb-2">
                                            <span class="badge bg-light text-dark border">PDF Worksheet</span>
                                            <span class="badge bg-light text-dark border">Quiz Key</span>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between mt-3">
                                            <div class="d-flex align-items-center gap-2">
                                                <div class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center"
                                                    style="width:32px; height:32px;">SJ</div>
                                                <small class="fw-bold">Sarah J.</small>
                                            </div>
                                            <small class="text-muted">Downloaded 1.2k times</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Features Grid -->
                    <section class="py-5 px-3" id="resource-features">
                        <div class="container">
                            <div class="text-center mb-5">
                                <h2 class="display-6 fw-bold">Fuel for your teaching.</h2>
                            </div>

                            <div class="row g-4">
                                <!-- Feature 1 -->
                                <div class="col-md-4">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-success">
                                                <span class="material-icons fs-1">menu_book</span>
                                            </div>
                                            <h4 class="fw-bold">Lesson Plans</h4>
                                            <p class="text-muted">Standard-aligned curriculums ready to drop into
                                                your
                                                schedule today.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Feature 2 -->
                                <div class="col-md-4">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-danger">
                                                <span class="material-icons fs-1">smart_display</span>
                                            </div>
                                            <h4 class="fw-bold">Multimedia</h4>
                                            <p class="text-muted">High-quality videos and interactive simulations
                                                that
                                                make concepts stick.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Feature 3 -->
                                <div class="col-md-4">
                                    <div class="glowing-card">
                                        <div class="glowing-card-border"></div>
                                        <div class="glowing-card-content transform-hover">
                                            <div class="mb-3 text-primary">
                                                <span class="material-icons fs-1">group_work</span>
                                            </div>
                                            <h4 class="fw-bold">Community</h4>
                                            <p class="text-muted">Share, remix, and collaborate on resources with
                                                educators worldwide.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>

        <!-- Login View (Split Website Style) -->
        <div id="login-view" class="view"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; background: #fff; overflow-y: auto;">
            <div class="row g-0 min-vh-100">
                <!-- Left Side: Branding & Welcome -->
                <div class="col-lg-6 d-none d-lg-flex position-relative text-white flex-column justify-content-center px-5 py-5"
                    style="overflow: hidden; background-image: url('https://hoirqrkdgbmvpwutwuwj.supabase.co/storage/v1/object/public/assets/assets/0e2dbea0-c0a9-413f-a57b-af279633c0df_3840w.jpg'); background-size: cover; background-position: center;">

                    <!-- Overlay to darken background for text readability -->
                    <div class="position-absolute top-0 start-0 w-100 h-100 bg-black opacity-50" style="z-index: 1;">
                    </div>

                    <!-- Navbar (Absolute) -->
                    <div class="position-absolute top-0 start-0 p-5" style="z-index: 2;">
                        <a href="#" class="d-flex align-items-center gap-3 text-white text-decoration-none"
                            onclick="switchView('landing-view')">
                            <img src="./static/class_bridge_logo.jpg" onerror="this.src='./static/noble_nexus_logo.png'"
                                alt="Logo"
                                style="width: 40px; height: 40px; border-radius: 10px; border: 2px solid rgba(255,255,255,0.2);">
                            <div class="d-flex flex-column lh-1 gap-2">
                                <span class="fw-bold fs-5">Class Bridge</span>
                                <span class="opacity-75 text-uppercase"
                                    style="font-size: 0.55rem; letter-spacing: 0.5px;">a product by Noble
                                    Nexus</span>
                            </div>
                        </a>
                    </div>

                    <div class="position-relative z-2" style="max-width: 500px; margin: 0 auto; z-index: 2;">
                        <span
                            class="bg-white text-primary px-3 py-1 rounded-pill small fw-bold text-uppercase mb-3 d-inline-block shadow-sm animate-fade-slide-in-1">
                            Student Portal
                        </span>
                        <h1 class="display-4 fw-bold mb-3 animate-fade-slide-in-2" data-i18n="login_journey_title">
                            Your
                            Learning Journey Continues</h1>
                        <p class="lead opacity-90 animate-fade-slide-in-3" data-i18n="login_journey_desc">Log in to
                            access your courses, live classes,
                            and personalized AI
                            insights.</p>

                        <!-- Stats -->
                        <div
                            class="row mt-5 pt-4 border-top border-white border-opacity-25 text-center animate-fade-slide-in-4">
                            <div class="col-4">
                                <h3 class="fw-bold mb-0">10k+</h3>
                                <small class="opacity-75" data-i18n="stat_students">Students</small>
                            </div>
                            <div class="col-4 border-start border-end border-white border-opacity-25">
                                <h3 class="fw-bold mb-0">98%</h3>
                                <small class="opacity-75" data-i18n="stat_pass_rate">Pass Rate</small>
                            </div>
                            <div class="col-4">
                                <h3 class="fw-bold mb-0">24/7</h3>
                                <small class="opacity-75" data-i18n="stat_access">Access</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Side: Login Form -->
                <div class="col-12 col-lg-6 d-flex flex-column bg-white position-relative">
                    <!-- Mobile Nav -->
                    <div class="d-flex justify-content-between p-4 align-items-center mb-auto">
                        <a href="#"
                            class="d-lg-none d-flex align-items-center gap-2 text-primary-custom text-decoration-none"
                            onclick="switchView('landing-view')">
                            <span class="material-icons">arrow_back</span> <span data-i18n="text_back">Back</span>
                        </a>
                    </div>

                    <div class="px-4 py-3 mx-auto w-100" style="max-width: 480px; margin-bottom: auto;">
                        <div class="text-center mb-4">
                            <div class="d-lg-none d-flex flex-column align-items-center mb-4">
                                <img src="./static/class_bridge_logo.jpg"
                                    onerror="this.src='./static/noble_nexus_logo.png'" alt="Logo"
                                    style="width: 60px; height: 60px; border-radius: 12px; margin-bottom: 0.5rem;">
                                <h5 class="fw-bold mb-2 text-dark">Class Bridge</h5>
                                <small class="text-muted text-uppercase" style="font-size: 0.6rem;">a product by
                                    Noble
                                    Nexus</small>
                            </div>
                            <!-- Role Switcher -->
                            <!-- Role Selection Indicator -->
                            <div class="mb-4 text-center">
                                <div id="login-role-icon-container"
                                    class="d-inline-flex align-items-center justify-content-center rounded-circle mb-3"
                                    style="width: 70px; height: 70px; background-color: #F3F4FF; color: #4D44B5; transition: all 0.3s;">
                                    <span id="login-role-icon" class="material-icons"
                                        style="font-size: 36px;">school</span>
                                </div>
                                <div class="d-flex align-items-center justify-content-center gap-2 mt-2">
                                    <span class="text-muted small" data-i18n="login_not_a">Not a</span>
                                    <span class="text-muted small"><span id="login-role-label">Student</span>?</span>
                                    <a href="#" onclick="switchView('landing-view')"
                                        class="text-primary-custom fw-bold small text-decoration-none bg-light px-3 py-1 rounded-pill border" data-i18n="login_switch_role">Switch
                                        Role</a>
                                </div>
                            </div>

                            <h2 class="fw-bold text-dark mb-2" id="login-title" data-i18n="login_student_login">Student Login</h2>
                            <p class="text-muted" data-i18n="login_subtitle">Sign in to your account</p>
                        </div>

                        <form id="login-form">
                            <input type="hidden" id="selected-role" value="Student">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control bg-light border-0" id="username" autocomplete="off"
                                    placeholder="Email" required aria-label="Email">
                                <label for="username" data-i18n="label_username">Email</label>
                            </div>
                            <div class="form-floating mb-3">
                                <input type="password" class="form-control bg-light border-0" id="password" autocomplete="new-password"
                                    placeholder="Password" required aria-label="Password">
                                <label for="password" data-i18n="label_password">Password</label>
                            </div>
                            <div class="text-end mb-4">
                                <a href="#" class="text-decoration-none small fw-medium text-primary-custom"
                                    data-bs-toggle="modal" data-bs-target="#forgotPasswordModal"
                                    data-i18n="link_forgot_password">Forgot Password?</a>
                            </div>

                            <p id="login-message" class="text-danger fw-medium min-h-20 mb-3 text-center"
                                aria-live="polite"></p>

                            <div class="d-flex gap-2 mb-4">
                                <button type="submit"
                                    class="pulse-connect-btn flex-grow-1 py-1 fw-bold rounded-pill shadow-lg"
                                    data-i18n="btn_signin">
                                    <div
                                        class="inner-ring d-flex align-items-center justify-content-center w-100 h-100 rounded-pill">
                                        <span class="gradient-text fs-5">Sign In</span>
                                    </div>
                                    <span class="absolute-shine"></span>
                                </button>
                                <button type="button"
                                    class="btn btn-outline-dark flex-grow-1 py-3 fw-bold rounded-pill shadow-sm"
                                    onclick="showRegister(event)">Sign Up</button>
                            </div>

                            <div class="d-flex align-items-center mb-4">
                                <hr class="flex-grow-1 bg-secondary opacity-25">
                                <span class="mx-3 text-muted small fw-medium text-uppercase"
                                    data-i18n="text_or">OR</span>
                                <hr class="flex-grow-1 bg-secondary opacity-25">
                            </div>

                            <!-- Social Buttons -->
                            <div class="row g-2">
                                <div class="col-12">
                                    <!-- FR-2: Real Google Button Container -->
                                    <div id="g_id_onload"
                                        data-client_id="275674033514-q7ghs0kt970m9soo44cqfusaqkkvgmb4.apps.googleusercontent.com"
                                        data-context="signin" data-ux_mode="popup"
                                        data-callback="handleCredentialResponse" data-auto_prompt="false">
                                    </div>

                                    <div class="g_id_signin w-100" data-type="standard" data-shape="rectangular"
                                        data-theme="outline" data-text="sign_in_with" data-size="large"
                                        data-logo_alignment="left">
                                    </div>
                                </div>
                                <div class="col-12">
                                    <button type="button"
                                        class="btn btn-outline-dark w-100 d-flex align-items-center justify-content-center gap-2 py-2"
                                        onclick="handleSocialLogin('Microsoft')">
                                        <img src="https://cdn-icons-png.flaticon.com/512/732/732221.png" width="20"
                                            height="20" alt="Microsoft Logo">
                                        <span data-i18n="btn_signin_microsoft">Sign in with Microsoft</span>
                                    </button>
                                </div>
                            </div>
                        </form>

                        <div class="mt-5 text-center small text-muted">
                            <p class="mb-1"><span data-i18n="text_new_user">New User?</span> <a href="#"
                                    onclick="showRegister(event)" class="text-primary-custom fw-bold ms-1"
                                    data-i18n="link_signup">Sign Up</a></p>
                            <a href="#" class="text-secondary text-decoration-none" data-i18n="link_help">Need help?
                                Contact support</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2FA View -->
        <!-- 2FA View (Split Layout) -->
        <div id="two-factor-view" class="view"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; background: #fff; overflow-y: auto;">
            <div class="row g-0 h-100">
                <!-- Left Side: Testimonial Cards Animation -->
                <div class="col-lg-6 d-none d-lg-flex position-relative align-items-center justify-content-center"
                    style="background-color: #0f172a; overflow: hidden;">
                    <div id="testimonial-cards-container" style="width: 100%; height: 100%;"></div>

                    <!-- Optional Branding overlay -->
                    <div class="position-absolute bottom-0 start-0 p-5 text-white" style="pointer-events: none;">
                        <h3 class="fw-bold">Join the Community</h3>
                        <p class="opacity-75">See what others are saying about Noble Nexus.</p>
                    </div>
                </div>

                <!-- Right Side: 2FA Form -->
                <div class="col-lg-6 d-flex align-items-center justify-content-center bg-light">
                    <div class="card shadow-lg border-0 rounded-4"
                        style="background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px); max-width: 420px; width: 100%;">
                        <div class="card-body p-5 text-center">
                            <div class="mb-3">
                                <span class="material-icons text-primary-custom" style="font-size: 48px;">lock</span>
                            </div>
                            <h2 class="fw-bold mb-2">Two-Step Verification</h2>
                            <p class="text-muted mb-4">Enter the code sent to your email to continue.</p>

                            <form id="two-factor-form">
                                <div class="form-floating mb-3 text-start">
                                    <input type="text" class="form-control" id="2fa-code" placeholder="6-digit code"
                                        required autocomplete="off">
                                    <label for="2fa-code">Email Verification Code</label>
                                </div>

                                <p id="2fa-message" class="text-danger fw-medium min-h-20"></p>

                                <button type="submit"
                                    class="btn btn-primary-custom w-100 py-3 fw-bold rounded-3 mb-3">Verify</button>
                            </form>

                            <div id="demo-codes-container" class="alert alert-info small text-start d-none">
                                <strong>Demo Code Hint:</strong><br>
                                <span id="demo-codes-text"></span>
                            </div>

                            <div class="mt-2 text-muted small">
                                <a href="#" onclick="window.location.reload()" class="text-primary-custom fw-bold">Back
                                    to
                                    Login</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Registration View (Split Website Style) -->
        <div id="register-view" class="view"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; background: #fff; overflow-y: auto;">
            <div class="row g-0 h-100">
                <!-- Left Side: Branding -->
                <div class="col-lg-6 d-none d-lg-flex position-relative text-white flex-column justify-content-center px-5 py-5"
                    style="background: linear-gradient(135deg, #4D44B5 0%, #764ba2 100%);">

                    <!-- Navbar (Absolute) -->
                    <div class="position-absolute top-0 start-0 p-5">
                        <a href="#" class="d-flex align-items-center gap-3 text-white text-decoration-none"
                            onclick="switchView('landing-view')">
                            <img src="./static/class_bridge_logo.jpg" onerror="this.src='./static/noble_nexus_logo.png'"
                                alt="Logo"
                                style="width: 40px; height: 40px; border-radius: 10px; border: 2px solid rgba(255,255,255,0.2);">
                            <div class="d-flex flex-column lh-1">
                                <span class="fw-bold fs-5">Class Bridge</span>
                                <span class="opacity-75 text-uppercase"
                                    style="font-size: 0.55rem; letter-spacing: 0.5px;">a product by Noble
                                    Nexus</span>
                            </div>
                        </a>
                    </div>

                    <div class="position-relative z-2" style="max-width: 500px; margin: 0 auto;">
                        <span
                            class="bg-white text-primary px-3 py-1 rounded-pill small fw-bold text-uppercase mb-3 d-inline-block shadow-sm">
                            Join Noble Nexus
                        </span>
                        <h1 class="display-4 fw-bold mb-3">Begin Your Excellence Journey</h1>
                        <p class="lead opacity-90 mb-5">Create an account to unlock advanced AI learning tools,
                            track
                            your progress, and join live classrooms.</p>

                        <div class="d-flex gap-4">
                            <div class="d-flex align-items-center gap-3">
                                <div class="bg-white rounded-circle d-flex align-items-center justify-content-center shadow-sm"
                                    style="width: 50px; height: 50px;">
                                    <span class="material-icons text-primary fs-4">school</span>
                                </div>
                                <div class="text-start">
                                    <h6 class="fw-bold mb-0">For Students</h6>
                                    <small class="opacity-75">Personalized AI Plans</small>
                                </div>
                            </div>
                            <div class="d-flex align-items-center gap-3">
                                <div class="bg-white rounded-circle d-flex align-items-center justify-content-center shadow-sm"
                                    style="width: 50px; height: 50px;">
                                    <span class="material-icons text-danger fs-4">family_restroom</span>
                                </div>
                                <div class="text-start">
                                    <h6 class="fw-bold mb-0">For Parents</h6>
                                    <small class="opacity-75">Track Progress</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Decoration -->
                    <div class="position-absolute bottom-0 start-0 w-100 overflow-hidden" style="line-height: 0;">
                        <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120"
                            preserveAspectRatio="none"
                            style="display: block; width: calc(100% + 1.3px); height: 80px; fill: #FFFFFF; transform: rotate(180deg);">
                            <path
                                d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.26-17.34-168.06-16.33-250.45.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.8C1132.19,118.92,1055.71,111.31,985.66,92.83Z">
                            </path>
                        </svg>
                    </div>
                </div>

                <!-- Right Side: Registration Form -->
                <div class="col-lg-6 d-flex flex-column bg-white h-100 position-relative">
                    <!-- Mobile Nav -->
                    <div class="d-flex justify-content-between p-4 align-items-center mb-auto">
                        <a href="#"
                            class="d-lg-none d-flex align-items-center gap-2 text-primary-custom text-decoration-none"
                            onclick="switchView('landing-view')">
                            <span class="material-icons">arrow_back</span> Back
                        </a>
                    </div>

                    <div class="px-4 py-3 mx-auto w-100" style="max-width: 480px; margin-bottom: auto;">
                        <div class="text-center mb-4">
                            <div class="d-inline-flex bg-primary bg-opacity-10 text-primary rounded-circle p-3 mb-3">
                                <span class="material-icons fs-2">person_add</span>
                            </div>
                            <h2 class="fw-bold text-dark mb-2">Create Account</h2>
                            <p class="text-muted">Join Noble Nexus Today</p>
                        </div>

                        <form id="register-form">
                            <!-- Name Field -->
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control bg-light border-0" id="reg-name"
                                    placeholder="Full Name" required>
                                <label for="reg-name">Full Name</label>
                            </div>

                            <!-- FR-Multi-School: School Selection -->
                            <div class="form-floating mb-3">
                                <select class="form-select bg-light border-0" id="reg-school" required>
                                    <option value="1">Independent / Default School</option>
                                </select>
                                <label for="reg-school">Select School</label>
                            </div>

                            <!-- FR-3: Role Selection -->
                            <div class="form-floating mb-3">
                                <select class="form-select bg-light border-0" id="reg-role" required
                                    onchange="handleRoleChange()">
                                    <option value="Student" selected>Student</option>
                                    <option value="Parent">Parent</option>
                                    <option value="Teacher">Teacher (Invite Only)</option>
                                </select>
                                <label for="reg-role">I am a...</label>
                            </div>

                            <!-- FR-4: Invitation Code -->
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control bg-light border-0" id="reg-invite" required
                                    placeholder="Invitation Code">
                                <label for="reg-invite">Invitation Code</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control bg-light border-0" id="reg-email"
                                    placeholder="Email / ID" required>
                                <label for="reg-email">Email / Student ID</label>
                            </div>
                            <div class="form-floating mb-3">
                                <input type="password" class="form-control bg-light border-0" id="reg-password"
                                    placeholder="Password" required oninput="checkPasswordStrength(this.value)">
                                <label for="reg-password">Password</label>
                            </div>
                            <div id="password-strength-msg" class="small mb-3 ms-1 fw-bold text-muted"></div>

                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <input type="number" class="form-control bg-light border-0" id="reg-grade"
                                            placeholder="Grade" min="1" max="12" value="9" required>
                                        <label for="reg-grade">Grade</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select class="form-select bg-light border-0" id="reg-subject" required>
                                            <option value="General">General</option>
                                            <option value="Science">Science</option>
                                            <option value="Maths">Maths</option>
                                            <option value="Social">Social</option>
                                            <option value="English">English</option>
                                            <option value="Tamil">Tamil</option>
                                        </select>
                                        <label for="reg-subject">Fav Subject</label>
                                    </div>
                                </div>
                            </div>

                            <p id="register-message" class="text-danger fw-medium min-h-20 mb-3 text-center"></p>

                            <button type="submit"
                                class="btn btn-primary-custom w-100 py-3 fw-bold rounded-pill shadow-sm mb-4">Sign
                                Up</button>

                            <div class="d-flex align-items-center mb-4">
                                <hr class="flex-grow-1 bg-secondary opacity-25">
                                <span class="mx-3 text-muted small fw-medium text-uppercase">OR</span>
                                <hr class="flex-grow-1 bg-secondary opacity-25">
                            </div>

                            <!-- Social Buttons -->
                            <div class="row g-2 mb-4">
                                <div class="col-12">
                                    <!-- Google One Tap / Button Target -->
                                    <div class="g_id_signin w-100" data-type="standard" data-shape="rectangular"
                                        data-theme="outline" data-text="signup_with" data-size="large"
                                        data-logo_alignment="left">
                                    </div>
                                </div>
                                <div class="col-12">
                                    <button type="button"
                                        class="btn btn-outline-dark w-100 d-flex align-items-center justify-content-center gap-2 py-2"
                                        onclick="handleSocialLogin('Microsoft')">
                                        <img src="https://cdn-icons-png.flaticon.com/512/732/732221.png" width="20"
                                            height="20" alt="Microsoft Logo">
                                        <span>Sign up with Microsoft</span>
                                    </button>
                                </div>
                            </div>

                            <div class="mt-4 text-center small text-muted">
                                <p>Already have an account? <a href="#" onclick="showLogin(event)"
                                        class="text-primary-custom fw-bold ms-1">Login</a></p>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Teacher Dashboard View -->
        <div id="teacher-view" class="view">

            <!-- Schedule Button -->
            <!-- Metrics Row (Top) -->
            <div id="teacher-metrics" class="row g-4 mb-4">
                <!-- Metrics injected here -->
            </div>

            <!-- Quick Actions Row -->
            <div class="d-flex gap-3 mb-4 overflow-auto pb-2">
                <button id="open-schedule-modal-btn"
                    class="btn btn-primary-custom shadow-sm d-flex align-items-center gap-2" data-bs-toggle="modal"
                    data-bs-target="#scheduleClassModal">
                    <span class="material-icons">videocam</span> <span data-i18n="btn_schedule_class">Schedule
                        Class</span>
                </button>
                <button class="btn btn-warning shadow-sm d-flex align-items-center gap-2 text-dark fw-bold"
                    onclick="switchView('ai-quiz-view')">
                    <span class="material-icons">psychology</span> <span data-i18n="btn_ai_quiz">AI Quiz</span>
                </button>
                <button class="btn btn-info shadow-sm d-flex align-items-center gap-2 text-white fw-bold"
                    onclick="switchView('lesson-planner-view')">
                    <span class="material-icons">sticky_note_2</span> <span data-i18n="btn_plan_lesson">Plan
                        Lesson</span>
                </button>
                <button class="btn btn-dark shadow-sm d-flex align-items-center gap-2 text-white fw-bold"
                    onclick="openWhiteboard()">
                    <span class="material-icons">gesture</span> <span data-i18n="btn_whiteboard">Whiteboard</span>
                </button>
                <button class="btn btn-success shadow-sm d-flex align-items-center gap-2 text-white fw-bold"
                    onclick="exportTeacherData()">
                    <span class="material-icons">download</span> <span data-i18n="btn_export">Export</span>
                </button>
                <button class="btn btn-primary shadow-sm d-flex align-items-center gap-2 text-white fw-bold"
                    onclick="handleTeacherViewToggle('engagement-helper-view')">
                    <span class="material-icons">psychology</span> <span data-i18n="btn_engagement_helper">Engagement
                        Helper</span>
                </button>
            </div>

            <div class="row g-4 mb-4">
                <!-- Left Col: Live Controls + Chart -->
                <div class="col-lg-8">
                    <!-- Live Class Controls -->
                    <div class="dashboard-card mb-4" style="background:#4D44B5; color:white;">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h3 class="h5 fw-bold mb-0 text-white" data-i18n="dashboard_live_controls">Live Class
                                Controls</h3>
                            <span class="badge bg-white text-primary" data-i18n="dashboard_now">Now</span>
                        </div>
                        <div class="input-group">
                            <span class="input-group-text border-0"><span class="material-icons">link</span></span>
                            <input type="url" id="meet-link-input" class="form-control border-0"
                                data-i18n-placeholder="ph_meet_link" placeholder="Google Meet Link">
                            <button id="start-class-btn" class="btn btn-success fw-bold" onclick="startClass()"
                                data-i18n="btn_start">Start</button>
                            <button id="end-class-btn" class="btn btn-danger fw-bold" onclick="endClass()"
                                data-i18n="btn_end">End</button>
                        </div>
                    </div>

                    <!-- Performance Chart -->
                    <div class="dashboard-card">
                        <h3 class="h5 fw-bold mb-3" data-i18n="dashboard_performance_dist">Performance Distribution
                        </h3>
                        <div id="class-performance-chart" style="height: 350px;"></div>
                    </div>
                </div>

                <!-- Right Col: Roster (Condensed?) or Calendar (Placeholder?) -->
                <!-- For now, put Roster here or full width below. Image shows Roster as full table. Let's make Roster full width below. 
                      Let's put a "Messages" or "Notice" placeholder here to match layout? 
                      Or just make Chart full width in Col-8 and leave Col-4 empty?
                      User instructions: "make project like this". Reference has "Agenda"/"Calendar" on right.
                  -->
                <div class="col-lg-4">
                    <div class="dashboard-card h-100-card">
                        <h3 class="h5 fw-bold mb-3" data-i18n="dashboard_calendar">Calendar</h3>
                        <div class="text-center text-muted py-5">
                            <span class="material-icons" style="font-size:48px; opacity:0.3;">calendar_month</span>
                            <p id="dashboard-calendar-month">September 2030</p>
                            <!-- Placeholder for calendar visual -->
                        </div>
                        <h6 class="fw-bold mt-4" data-i18n="dashboard_upcoming_events">Upcoming events</h6>
                        <div class="d-flex align-items-center gap-3 mt-3 p-2 rounded bg-light">
                            <div class="bg-primary text-white rounded p-2 text-center" style="width:50px;">
                                <div class="small">10</div>
                                <div class="fw-bold">AM</div>
                            </div>
                            <div>
                                <div class="fw-bold">Math Review</div>
                                <div class="small text-muted">Grade 9</div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>


            <!-- Roster Full Width -->
            <div class="dashboard-card mb-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3 class="h5 fw-bold mb-0">Class Roster</h3>
                    <button class="btn btn-sm btn-outline-primary rounded-pill">View All</button>
                </div>
                <div class="table-responsive">
                    <table class="table table-custom align-middle">
                        <thead class="table-light bg-light">
                            <tr id="roster-header">
                                <!-- Header injected via JS -->
                            </tr>
                        </thead>
                        <tbody id="roster-table">
                            <!-- Rows injected via JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 2. Class Management View -->
        <div id="teacher-class-management-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">class</span> Class Management
            </h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold">My Classes</div>
                        <div class="list-group list-group-flush">
                            <button class="list-group-item list-group-item-action active">Grade 9 - Math (Sec
                                A)</button>
                            <button class="list-group-item list-group-item-action">Grade 10 - Physics (Sec
                                B)</button>
                            <button class="list-group-item list-group-item-action">Grade 8 - Math (Sec C)</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold d-flex justify-content-between align-items-center">
                            <span>Student List (Grade 9-A)</span>
                            <button class="btn btn-sm btn-outline-primary">Export CSV</button>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Attendance</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>S001</td>
                                        <td>Alice Smith</td>
                                        <td>95%</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                    </tr>
                                    <tr>
                                        <td>S002</td>
                                        <td>Bob Johnson</td>
                                        <td>88%</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                    </tr>
                                    <tr>
                                        <td>S003</td>
                                        <td>Charlie Brown</td>
                                        <td>92%</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. Content & Assignments View -->
        <div id="teacher-content-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-warning fs-2">source</span> Content & Assignments
            </h2>
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-body p-4">
                            <h5 class="fw-bold mb-3">Upload Study Materials</h5>
                            <div class="border rounded p-4 text-center bg-light"
                                style="border-style: dashed !important;">
                                <span class="material-icons text-secondary fs-1">cloud_upload</span>
                                <p class="mb-2">Drag & Drop notes, PDFs, or slides here</p>
                                <button class="btn btn-primary-custom btn-sm">Browse Files</button>
                            </div>
                            <div class="mt-3">
                                <h6 class="text-muted small fw-bold uppercase">Recent Uploads</h6>
                                <ul class="list-group list-group-flush small">
                                    <li class="list-group-item d-flex justify-content-between">
                                        <span>Algebra_Notes_Ch1.pdf</span> <span class="text-success">Uploaded</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-body p-4">
                            <h5 class="fw-bold mb-3">Assignments</h5>
                            <p class="text-muted mb-0">Assignment creation has been removed.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. Assessment View -->
        <div id="teacher-assessment-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-danger fs-2">assignment_turned_in</span> Assessment & Grading
            </h2>
            <ul class="nav nav-pills mb-4">
                <li class="nav-item"><a class="nav-link active" href="#">Mark Attendance</a></li>
                <li class="nav-item"><a class="nav-link" href="#">Gradebook</a></li>
                <li class="nav-item"><a class="nav-link" href="#">Create Exam</a></li>
            </ul>
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <h5 class="fw-bold">Today's Attendance - Grade 9A</h5>
                    <div class="table-responsive mt-3">
                        <table class="table table-bordered align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th>Student</th>
                                    <th class="text-center">Present</th>
                                    <th class="text-center">Absent</th>
                                    <th class="text-center">Late</th>
                                    <th>Remarks</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Alice Smith</td>
                                    <td class="text-center"><input type="radio" name="att_1" checked></td>
                                    <td class="text-center"><input type="radio" name="att_1"></td>
                                    <td class="text-center"><input type="radio" name="att_1"></td>
                                    <td><input type="text" class="form-control form-control-sm"></td>
                                </tr>
                                <tr>
                                    <td>Bob Johnson</td>
                                    <td class="text-center"><input type="radio" name="att_2" checked></td>
                                    <td class="text-center"><input type="radio" name="att_2"></td>
                                    <td class="text-center"><input type="radio" name="att_2"></td>
                                    <td><input type="text" class="form-control form-control-sm"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button class="btn btn-primary-custom mt-2">Save Attendance</button>
                </div>
            </div>
        </div>

        <!-- 5. Communication View -->
        <div id="teacher-communication-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-info fs-2">campaign</span> Communication Center
            </h2>
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold"> Announce to Class</div>
                        <div class="card-body p-4">
                            <div class="mb-3">
                                <label class="form-label">Select Classes</label>
                                <select class="form-select" multiple>
                                    <option selected>Grade 9 - Math</option>
                                    <option>Grade 10 - Physics</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Message</label>
                                <textarea class="form-control" rows="4"
                                    placeholder="Type your announcement..."></textarea>
                            </div>
                            <button class="btn btn-primary-custom w-100">Post Announcement</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold"> Recent Messages</div>
                        <div class="list-group list-group-flush">
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Mrs. Johnson (Parent)</h6>
                                    <small>10 mins ago</small>
                                </div>
                                <p class="mb-1 small text-muted">Regarding Bob's absence yesterday?</p>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Principal</h6>
                                    <small>1 hr ago</small>
                                </div>
                                <p class="mb-1 small text-muted">Staff meeting at 4 PM.</p>
                            </a>
                        </div>
                        <div class="card-footer bg-white border-0 text-center">
                            <button class="btn btn-sm btn-outline-primary">View All Messages</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Super Admin View -->
        <div id="super-admin-view" class="view">
            <h2 class="mb-4 fw-bold">Super Admin Dashboard</h2>
            <div class="row g-4 mb-4">
                <div class="col-12" id="super-admin-content">
                    <!-- Content injected by JS -->
                </div>
            </div>
        </div>

        <!-- REPORTS VIEW -->
        <div id="reports-view" class="view">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="fw-bold m-0">Reports & Analytics</h2>
                <div class="btn-group">
                    <button class="btn btn-outline-primary" onclick="exportReportCSV()">
                        <span class="material-icons align-middle me-1">download</span> CSV
                    </button>
                    <button class="btn btn-outline-primary" onclick="window.print()">
                        <span class="material-icons align-middle me-1">picture_as_pdf</span> PDF
                    </button>
                </div>
            </div>

            <!-- Top Metrics Row (Finance & Staff) -->
            <div class="row g-4 mb-4" id="reports-metrics-row">
                <!-- Injected via JS -->
            </div>

            <div class="row g-4 mb-4">
                <div class="col-lg-6">
                    <div class="dashboard-card h-100-card">
                        <h3 class="h5 fw-bold mb-3">Attendance Trends</h3>
                        <div id="attendance-chart" style="height: 250px;"></div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="dashboard-card h-100-card">
                        <h3 class="h5 fw-bold mb-3">Academic Performance</h3>
                        <div id="academic-chart" style="height: 250px;"></div>
                    </div>
                </div>
            </div>

            <div class="row g-4 mb-4">
                <div class="col-lg-6">
                    <div class="dashboard-card h-100-card">
                        <h3 class="h5 fw-bold mb-3">Financial Summaries</h3>
                        <div id="finance-details-content">
                            <div class="d-flex justify-content-center align-items-center h-100 text-muted">
                                Loading...
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="dashboard-card h-100-card">
                        <h3 class="h5 fw-bold mb-3">Staff Utilization</h3>
                        <div id="staff-details-content">
                            <div class="d-flex justify-content-center align-items-center h-100 text-muted">
                                Loading...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-card">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3 class="h5 fw-bold m-0">Custom Reports (Per Tenant)</h3>
                    <button class="btn btn-sm btn-light border"
                        onclick="alert('Custom Report Builder feature coming soon!')">
                        <span class="material-icons align-middle" style="font-size:18px">tune</span> Configure
                    </button>
                </div>
                <p class="text-muted small">Generate specific reports based on tenant data.</p>
                <div class="table-responsive">
                    <table class="table table-custom">
                        <thead>
                            <tr>
                                <th>Report Name</th>
                                <th>Type</th>
                                <th>Generated</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Monthly Fee Collection</td>
                                <td>Finance</td>
                                <td>Jan 15, 2026</td>
                                <td><span class="badge bg-success">Ready</span></td>
                                <td><button class="btn btn-sm btn-link">Download</button></td>
                            </tr>
                            <tr>
                                <td>Quarterly Staff Hours</td>
                                <td>HR</td>
                                <td>Jan 10, 2026</td>
                                <td><span class="badge bg-success">Ready</span></td>
                                <td><button class="btn btn-sm btn-link">Download</button></td>
                            </tr>
                            <tr>
                                <td>Student At-Risk Analysis</td>
                                <td>Academic</td>
                                <td>Jan 20, 2026</td>
                                <td><span class="badge bg-warning text-dark">Processing</span></td>
                                <td><button class="btn btn-sm btn-link disabled">Wait</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ACADEMICS VIEW -->
        <!-- ACADEMICS VIEW -->
        <div id="academics-view" class="view">
            <h2 class="mb-4 fw-bold text-primary-custom">Academic Management</h2>
            <div class="row h-100">
                <!-- Sub Menu Sidebar -->
                <div class="col-md-3">
                    <div class="list-group shadow-sm rounded-3">
                        <button class="list-group-item list-group-item-action active fw-bold py-3"
                            onclick="switchAcademicTab('planning', this)">
                            <span class="material-icons align-middle me-2">menu_book</span> Subject Planning
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchAcademicTab('classes', this)">
                            <span class="material-icons align-middle me-2">schedule</span> Class Schedules
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchAcademicTab('attendance', this)">
                            <span class="material-icons align-middle me-2">fact_check</span> Attendance Tracking
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchAcademicTab('assignments', this)">
                            <span class="material-icons align-middle me-2">assignment</span> Homework & Assignments
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchAcademicTab('exams', this)">
                            <span class="material-icons align-middle me-2">quiz</span> Exams & Grading
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchAcademicTab('reports', this)">
                            <span class="material-icons align-middle me-2">assessment</span> Report Cards
                        </button>
                    </div>
                </div>

                <!-- Content Area -->
                <div class="col-md-9">
                    <div class="dashboard-card h-100 bg-white" id="academic-content-area">
                        <!-- Content injected by script.js -->
                        <div class="text-center p-5">
                            <div class="spinner-border text-primary"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- FINANCE VIEW -->
        <div id="finance-legacy-view" class="view">
            <h2 class="mb-4 fw-bold">Finance</h2>
            <div class="row g-4 mb-4">
                <!-- Summary Cards -->
                <div class="col-md-4">
                    <div class="dashboard-card widget-green h-100">
                        <div class="d-flex justify-content-between mb-3">
                            <span class="text-white fw-medium">Total Revenue</span>
                            <span class="material-icons text-white">account_balance_wallet</span>
                        </div>
                        <h3 class="fw-bold text-white mb-0">$1,250,000</h3>
                        <span class="text-white small opacity-75"> 8% from last year</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="dashboard-card widget-yellow h-100">
                        <div class="d-flex justify-content-between mb-3">
                            <span class="fw-medium" style="color:#303972">Pending Fees</span>
                            <span class="material-icons" style="color:#303972">pending</span>
                        </div>
                        <h3 class="fw-bold mb-0" style="color:#303972">$45,200</h3>
                        <span class="small opacity-75" style="color:#303972">Due this month</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="dashboard-card widget-purple h-100">
                        <div class="d-flex justify-content-between mb-3">
                            <span class="text-white fw-medium">Expenses</span>
                            <span class="material-icons text-white">trending_down</span>
                        </div>
                        <h3 class="fw-bold text-white mb-0">$850,000</h3>
                        <span class="text-white small opacity-75"> 2% savings</span>
                    </div>
                </div>
            </div>

            <div class="row g-4">
                <div class="col-lg-12">
                    <div class="dashboard-card">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4 class="fw-bold mb-0">Recent Transactions</h4>
                            <button class="btn btn-sm btn-outline-primary rounded-pill">View All</button>
                        </div>
                        <table class="table align-middle">
                            <thead class="text-muted small text-uppercase">
                                <tr>
                                    <th>Transaction ID</th>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Status</th>
                                    <th class="text-end">Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#TXN-8823</td>
                                    <td>Oct 12, 2025</td>
                                    <td>Tuition Payment - Alice Smith</td>
                                    <td><span class="badge bg-success-subtle text-success">Completed</span></td>
                                    <td class="text-end fw-bold">+$2,400.00</td>
                                </tr>
                                <tr>
                                    <td>#TXN-8824</td>
                                    <td>Oct 12, 2025</td>
                                    <td>Lab Equipment Purchase</td>
                                    <td><span class="badge bg-secondary-subtle text-secondary">Pending</span></td>
                                    <td class="text-end fw-bold text-danger">-$1,250.00</td>
                                </tr>
                                <tr>
                                    <td>#TXN-8825</td>
                                    <td>Oct 11, 2025</td>
                                    <td>Cafeteria Vendor Payment</td>
                                    <td><span class="badge bg-success-subtle text-success">Completed</span></td>
                                    <td class="text-end fw-bold text-danger">-$500.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- COMMUNICATION VIEW -->
        <div id="communication-view" class="view">
            <h2 class="mb-4 fw-bold text-primary-custom">Communication & Engagement</h2>
            <div class="row h-100">
                <!-- Sub Menu Sidebar -->
                <div class="col-md-3">
                    <div class="list-group shadow-sm rounded-3">
                        <button class="list-group-item list-group-item-action active fw-bold py-3"
                            onclick="switchCommTab('announcements', this)">
                            <span class="material-icons align-middle me-2">campaign</span> Announcements
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchCommTab('messaging', this)">
                            <span class="material-icons align-middle me-2">forum</span> Teacher-Parent Msg
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchCommTab('notifications', this)">
                            <span class="material-icons align-middle me-2">mark_email_unread</span> Email & SMS
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchCommTab('push', this)">
                            <span class="material-icons align-middle me-2">notifications_active</span> Push
                            Notifications
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3"
                            onclick="switchCommTab('calendar', this)">
                            <span class="material-icons align-middle me-2">event</span> Event Calendars
                        </button>
                        <button class="list-group-item list-group-item-action fw-bold py-3 text-danger"
                            onclick="switchCommTab('emergency', this)">
                            <span class="material-icons align-middle me-2">warning</span> Emergency Alerts
                        </button>
                    </div>
                </div>

                <!-- Content Area -->
                <div class="col-md-9">
                    <div class="dashboard-card h-100 bg-white" id="comm-content-area">
                        <!-- Content injected by script.js -->
                        <div class="text-center p-5">
                            <div class="spinner-border text-primary"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
        </div>
        </div>
        </div>
        </div>

        <!-- GRADE HELPER VIEW -->
        <div id="grade-helper-view" class="view">
            <h2 class="mb-4 fw-bold text-primary-custom">Grade Helper AI</h2>
            <div class="row h-100">
                <div class="col-lg-12">
                    <div class="dashboard-card h-100 d-flex flex-column" style="min-height: 600px;">
                        <div class="d-flex justify-content-between align-items-center border-bottom pb-3 mb-3">
                            <div class="d-flex align-items-center gap-3">
                                <div class="bg-info text-white rounded-circle d-flex align-items-center justify-content-center"
                                    style="width: 48px; height: 48px;">
                                    <span class="material-icons">school</span>
                                </div>
                                <div>
                                    <h5 class="fw-bold mb-0">Grade Specialist</h5>
                                    <small class="text-muted">Your personal grade-level assistant</small>
                                </div>
                            </div>
                            <span
                                class="badge bg-success-subtle text-success border border-success px-3 py-2 rounded-pill">Online</span>
                        </div>

                        <!-- Chat Area -->
                        <div id="grade-helper-chat-messages" class="flex-grow-1 overflow-auto p-3 mb-3 bg-light rounded"
                            style="max-height: 450px;">
                            <div class="d-flex align-items-start gap-3 mb-3">
                                <div class="rounded-circle bg-info text-white d-flex align-items-center justify-content-center flex-shrink-0"
                                    style="width: 36px; height: 36px;">AI</div>
                                <div class="bg-white p-3 rounded shadow-sm" style="max-width: 80%;">
                                    <p class="mb-0 text-dark">Hello! I am your Grade Helper. How can I assist you with
                                        your grade-related tasks today?</p>
                                </div>
                            </div>
                        </div>

                        <!-- Input Area -->
                        <form id="grade-helper-form" onsubmit="handleGradeChat(event)">
                            <div class="input-group">
                                <input type="text" id="grade-helper-input"
                                    class="form-control form-control-lg border-0 bg-light"
                                    placeholder="Ask about your grade syllabus, homework, or teaching plans..."
                                    required>
                                <button type="submit" class="btn btn-primary-custom px-4">
                                    <span class="material-icons">send</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- ENGAGEMENT HELPER VIEW (Teachers Only) -->
        <div id="engagement-helper-view" class="view">
            <h2 class="mb-4 fw-bold text-primary-custom">Engagement Helper</h2>
            <div class="row h-100">
                <div class="col-lg-12">
                    <div class="dashboard-card h-100 d-flex flex-column" style="min-height: 600px;">
                        <div class="d-flex justify-content-between align-items-center border-bottom pb-3 mb-3">
                            <div class="d-flex align-items-center gap-3">
                                <div class="bg-warning text-dark rounded-circle d-flex align-items-center justify-content-center"
                                    style="width: 48px; height: 48px;">
                                    <span class="material-icons">psychology</span>
                                </div>
                                <div>
                                    <h5 class="fw-bold mb-0">Class Engagement Coach</h5>
                                    <small class="text-muted">Ideas to energize lessons and increase
                                        participation</small>
                                </div>
                            </div>
                            <span
                                class="badge bg-success-subtle text-success border border-success px-3 py-2 rounded-pill">Online</span>
                        </div>

                        <!-- Chat Area -->
                        <div id="engagement-helper-chat-messages"
                            class="flex-grow-1 overflow-auto p-3 mb-3 bg-light rounded" style="max-height: 450px;">
                            <div class="d-flex align-items-start gap-3 mb-3">
                                <div class="rounded-circle bg-warning text-dark d-flex align-items-center justify-content-center flex-shrink-0"
                                    style="width: 36px; height: 36px;">AI</div>
                                <div class="bg-white p-3 rounded shadow-sm" style="max-width: 80%;">
                                    <p class="mb-0 text-dark">Hi! Tell me your class level, topic, and time available,
                                        and
                                        Ill suggest quick engagement strategies and activities.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Input Area -->
                        <form id="engagement-helper-form" onsubmit="handleEngagementChat(event)">
                            <div class="input-group">
                                <input type="text" id="engagement-helper-input"
                                    class="form-control form-control-lg border-0 bg-light"
                                    placeholder="Example: Grade 7 science, 10 minutes, low energy...">
                                <input type="file" id="engagement-helper-file"
                                    class="form-control form-control-lg border-0 bg-light" accept=".pdf"
                                    style="max-width: 220px;">
                                <button type="submit" class="btn btn-primary-custom px-4">
                                    <span class="material-icons">send</span>
                                </button>
                            </div>
                            <div class="small text-muted mt-2">Optional: upload a PDF to tailor engagement strategies.
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- SETTINGS VIEW -->
        <div id="settings-view" class="view">
            <h2 class="mb-4 fw-bold">Settings</h2>
            <div class="row g-4">
                <div class="col-lg-4">
                    <div class="dashboard-card">
                        <div class="text-center mb-4">
                            <div
                                style="width: 80px; height: 80px; background: #EBEDF6; border-radius: 50%; margin: 0 auto; display: flex; align-items: center; justify-content: center; font-size: 32px; color: #4D44B5;">
                                <span class="material-icons">person</span>
                            </div>
                            <h5 class="fw-bold mt-3 mb-1">Linda Adora</h5>
                            <p class="text-muted small">School Admin</p>
                            <button class="btn btn-sm btn-outline-primary rounded-pill mt-2">Edit Profile</button>
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="#" class="list-group-item list-group-item-action border-0 fw-medium active"
                                style="background-color: #F3F4FF; color: #4D44B5; border-radius: 10px;">General
                                Settings</a>
                            <a href="#" class="list-group-item list-group-item-action border-0 fw-medium">Notification
                                Preferences</a>
                            <a href="#" class="list-group-item list-group-item-action border-0 fw-medium">Security &
                                Password</a>
                            <a href="#"
                                class="list-group-item list-group-item-action border-0 fw-medium text-danger">Deactivate
                                Account</a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="dashboard-card h-100-card">
                        <h4 class="fw-bold mb-4">General Settings</h4>
                        <form>
                            <div class="row g-3 mb-3">
                                <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">First Name</label>
                                    <input type="text" class="form-control" value="Linda">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">Last Name</label>
                                    <input type="text" class="form-control" value="Adora">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted">Email Address</label>
                                <input type="email" class="form-control" value="linda@schoolhub.com">
                            </div>
                            <div class="mb-3">
                                <label class="form-label small fw-bold text-muted">School Name</label>
                                <input type="text" class="form-control" value="Noble Nexus High">
                            </div>
                            <div class="mb-4">
                                <label class="form-label small fw-bold text-muted">Timezone</label>
                                <select class="form-select">
                                    <option>(GMT -05:00) Eastern Time</option>
                                    <option>(GMT +00:00) UTC</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary-custom">Save Changes</button>
                        </form>
                    </div>

                    <!-- Invite Users Section (Moved from Sidebar) -->
                    <div id="invite-section" class="dashboard-card mt-4 d-none">
                        <h4 class="fw-bold mb-4">Invite Users</h4>
                        <p class="text-muted small mb-3">Generate secure invitation tokens for new users.</p>
                        <div class="row g-3">
                            <div class="col-md-8">
                                <label class="form-label small fw-bold text-muted">Select Role</label>
                                <select class="form-select" id="invite-role">
                                    <option value="Student">Student</option>
                                    <option value="Parent">Parent</option>
                                    <option value="Teacher">Teacher</option>
                                </select>
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <button class="btn btn-primary-custom w-100" onclick="generateInvite()">
                                    <span class="material-icons align-middle me-1"
                                        style="font-size: 18px;">add_link</span> Generate
                                </button>
                            </div>
                        </div>
                        <div id="invite-result"
                            class="mt-3 p-3 rounded bg-light border d-none text-center fw-bold text-primary"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- COMPLIANCE View -->
        <div id="compliance-view" class="view">
            <div class="d-flex align-items-center mb-4 gap-3">
                <button id="compliance-back-btn" class="btn btn-white border shadow-sm rounded-circle d-none"
                    onclick="showComplianceMenu()"
                    style="width: 42px; height: 42px; display: flex; align-items: center; justify-content: center;">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2 id="compliance-top-title" class="fw-bold m-0">Compliance & Security</h2>
            </div>

            <!-- Menu Area -->
            <div id="compliance-menu-area" class="card border-0 shadow-sm rounded-4 overflow-hidden mb-4">
                <div class="table-responsive">
                    <table class="table table-hover mb-0 align-middle">
                        <thead class="bg-light">
                            <tr>
                                <th class="py-3 ps-4" style="width: 25%;">Sub Menu</th>
                                <th class="py-3">Functionality</th>
                                <th class="py-3">Permission</th>
                                <th class="py-3">Role</th>
                                <th class="py-3 text-end pe-4">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="cursor: pointer;" onclick="loadComplianceTab('audit-logs')">
                                <td class="ps-4 fw-bold text-primary">Audit logs</td>
                                <td class="text-muted small">View comprehensive system audit trail</td>
                                <td><span class="badge bg-primary-subtle text-primary">compliance.view</span></td>
                                <td><small class="text-secondary">Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadComplianceTab('retention')">
                                <td class="ps-4 fw-bold text-primary">Data retention policies</td>
                                <td class="text-muted small">Configure data lifecycle and deletion</td>
                                <td><span class="badge bg-warning-subtle text-warning">compliance.manage</span></td>
                                <td><small class="text-secondary">Super Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadComplianceTab('access-logs')">
                                <td class="ps-4 fw-bold text-primary">Access logs</td>
                                <td class="text-muted small">Monitor login and authentication events</td>
                                <td><span class="badge bg-primary-subtle text-primary">compliance.view</span></td>
                                <td><small class="text-secondary">Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Dynamic Content Area (Full Page Mode) -->
            <div id="compliance-detail-area" class="d-none animate-fade-in">
                <!-- Content injected here -->
                <div id="compliance-tab-content"></div>
            </div>
        </div>

        <!-- FINANCE View -->
        <div id="finance-view" class="view">
            <div class="d-flex align-items-center mb-4 gap-3">
                <button id="finance-back-btn" class="btn btn-white border shadow-sm rounded-circle d-none"
                    onclick="showFinanceMenu()"
                    style="width: 42px; height: 42px; display: flex; align-items: center; justify-content: center;">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2 id="finance-top-title" class="fw-bold m-0">3.6 Finance & Billing</h2>
            </div>

            <!-- Menu Area -->
            <div id="finance-menu-area" class="card border-0 shadow-sm rounded-4 overflow-hidden mb-4">
                <div class="table-responsive">
                    <table class="table table-hover mb-0 align-middle">
                        <thead class="bg-light">
                            <tr>
                                <th class="py-3 ps-4" style="width: 25%;">Sub Menu</th>
                                <th class="py-3">Functionality</th>
                                <th class="py-3">Permission</th>
                                <th class="py-3">Role</th>
                                <th class="py-3 text-end pe-4">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('fee-structures')">
                                <td class="ps-4 fw-bold text-primary">Fee structures</td>
                                <td class="text-muted small">Manage tuition and fee categories</td>
                                <td><span class="badge bg-warning-subtle text-warning">finance.manage</span></td>
                                <td><small class="text-secondary">Finance Officer</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('installment-plans')">
                                <td class="ps-4 fw-bold text-primary">Installment plans</td>
                                <td class="text-muted small">Configure payment schedules</td>
                                <td><span class="badge bg-warning-subtle text-warning">finance.manage</span></td>
                                <td><small class="text-secondary">Finance Officer</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('discounts-scholarships')">
                                <td class="ps-4 fw-bold text-primary">Discounts & scholarships</td>
                                <td class="text-muted small">Manage financial aid and offers</td>
                                <td><span class="badge bg-warning-subtle text-warning">finance.manage</span></td>
                                <td><small class="text-secondary">Finance Officer</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('invoicing')">
                                <td class="ps-4 fw-bold text-primary">Invoicing</td>
                                <td class="text-muted small">Generate and send bills</td>
                                <td><span class="badge bg-primary-subtle text-primary">finance.view</span></td>
                                <td><small class="text-secondary">Finance Officer</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('online-payments')">
                                <td class="ps-4 fw-bold text-primary">Online payments</td>
                                <td class="text-muted small">Payment gateway integration settings</td>
                                <td><span class="badge bg-warning-subtle text-warning">finance.manage</span></td>
                                <td><small class="text-secondary">Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('refunds')">
                                <td class="ps-4 fw-bold text-primary">Refunds</td>
                                <td class="text-muted small">Process refund requests</td>
                                <td><span class="badge bg-warning-subtle text-warning">finance.manage</span></td>
                                <td><small class="text-secondary">Finance Officer</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('financial-reports')">
                                <td class="ps-4 fw-bold text-primary">Financial reports</td>
                                <td class="text-muted small">Revenue, expenses, and tax reports</td>
                                <td><span class="badge bg-primary-subtle text-primary">finance.view</span></td>
                                <td><small class="text-secondary">Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadFinanceTab('multi-currency')">
                                <td class="ps-4 fw-bold text-primary">Multi-currency (platform-level)</td>
                                <td class="text-muted small">Manage supported currencies and rates</td>
                                <td><span class="badge bg-danger-subtle text-danger">root.manage</span></td>
                                <td><small class="text-secondary">Super Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Dynamic Content Area -->
            <div id="finance-detail-area" class="d-none animate-fade-in">
                <div id="finance-tab-content"></div>
            </div>
        </div>

        </div>

        <!-- STAFF & FACULTY View -->
        <div id="staff-view" class="view">
            <div class="d-flex align-items-center mb-4 gap-3">
                <button id="staff-back-btn" class="btn btn-white border shadow-sm rounded-circle d-none"
                    onclick="showStaffMenu()"
                    style="width: 42px; height: 42px; display: flex; align-items: center; justify-content: center;">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2 id="staff-top-title" class="fw-bold m-0">3.4 Staff & Faculty Management</h2>
            </div>

            <!-- Menu Area -->
            <div id="staff-menu-area" class="card border-0 shadow-sm rounded-4 overflow-hidden mb-4">
                <div class="table-responsive">
                    <table class="table table-hover mb-0 align-middle">
                        <thead class="bg-light">
                            <tr>
                                <th class="py-3 ps-4" style="width: 25%;">Sub Menu</th>
                                <th class="py-3">Functionality</th>
                                <th class="py-3">Permission</th>
                                <th class="py-3">Role</th>
                                <th class="py-3 text-end pe-4">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="cursor: pointer;" onclick="loadStaffTab('profiles')">
                                <td class="ps-4 fw-bold text-primary">Staff profiles</td>
                                <td class="text-muted small">Manage staff records</td>
                                <td><span class="badge bg-primary-subtle text-primary">staff.view</span></td>
                                <td><small class="text-secondary">HR Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStaffTab('role-assignment')">
                                <td class="ps-4 fw-bold text-primary">Role assignment</td>
                                <td class="text-muted small">Assign system roles</td>
                                <td><span class="badge bg-warning-subtle text-warning">role.manage</span></td>
                                <td><small class="text-secondary">Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStaffTab('department-grouping')">
                                <td class="ps-4 fw-bold text-primary">Department grouping</td>
                                <td class="text-muted small">Organize staff by department</td>
                                <td><span class="badge bg-warning-subtle text-warning">staff.manage</span></td>
                                <td><small class="text-secondary">HR Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStaffTab('workload')">
                                <td class="ps-4 fw-bold text-primary">Workload allocation</td>
                                <td class="text-muted small">Manage class schedules and duties</td>
                                <td><span class="badge bg-warning-subtle text-warning">staff.manage</span></td>
                                <td><small class="text-secondary">Academic Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStaffTab('attendance')">
                                <td class="ps-4 fw-bold text-primary">Attendance</td>
                                <td class="text-muted small">Track staff attendance</td>
                                <td><span class="badge bg-primary-subtle text-primary">staff.view</span></td>
                                <td><small class="text-secondary">HR Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStaffTab('payroll')">
                                <td class="ps-4 fw-bold text-primary">Payroll integration</td>
                                <td class="text-muted small">Sync with payroll systems</td>
                                <td><span class="badge bg-warning-subtle text-warning">finance.view</span></td>
                                <td><small class="text-secondary">Finance Officer</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStaffTab('performance')">
                                <td class="ps-4 fw-bold text-primary">Performance reviews</td>
                                <td class="text-muted small">Manage staff evaluations</td>
                                <td><span class="badge bg-warning-subtle text-warning">staff.manage</span></td>
                                <td><small class="text-secondary">HR Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Dynamic Content Area -->
            <div id="staff-detail-area" class="d-none animate-fade-in">
                <div id="staff-tab-content"></div>
            </div>
        </div>

        <!-- STUDENT INFORMATION View -->
        <div id="student-info-view" class="view">
            <div class="d-flex align-items-center mb-4 gap-3">
                <button id="student-info-back-btn" class="btn btn-white border shadow-sm rounded-circle d-none"
                    onclick="showStudentInfoMenu()"
                    style="width: 42px; height: 42px; display: flex; align-items: center; justify-content: center;">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2 id="student-info-top-title" class="fw-bold m-0">3.3 Student Information Management</h2>
            </div>

            <!-- Menu Area -->
            <div id="student-info-menu-area" class="card border-0 shadow-sm rounded-4 overflow-hidden mb-4">
                <div class="table-responsive">
                    <table class="table table-hover mb-0 align-middle">
                        <thead class="bg-light">
                            <tr>
                                <th class="py-3 ps-4" style="width: 30%;">Sub Menu</th>
                                <th class="py-3">Functionality</th>
                                <th class="py-3">Permission</th>
                                <th class="py-3">Role</th>
                                <th class="py-3 text-end pe-4">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="cursor: pointer;" onclick="loadStudentInfoTab('profiles')">
                                <td class="ps-4 fw-bold text-primary">Student profiles & Enrollment history</td>
                                <td class="text-muted small">View records and academic history</td>
                                <td><span class="badge bg-primary-subtle text-primary">student.info.view</span></td>
                                <td><small class="text-secondary">All Staff</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStudentInfoTab('class-assignment')">
                                <td class="ps-4 fw-bold text-primary">Class & section assignment</td>
                                <td class="text-muted small">Manage enrollment structure</td>
                                <td><span class="badge bg-warning-subtle text-warning">student.info.manage</span></td>
                                <td><small class="text-secondary">Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStudentInfoTab('guardians')">
                                <td class="ps-4 fw-bold text-primary">Guardian relationships</td>
                                <td class="text-muted small">Contact info and relations</td>
                                <td><span class="badge bg-primary-subtle text-primary">student.info.view</span></td>
                                <td><small class="text-secondary">All Staff</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStudentInfoTab('health')">
                                <td class="ps-4 fw-bold text-primary">Health & emergency info</td>
                                <td class="text-muted small">Medical records and contacts</td>
                                <td><span class="badge bg-primary-subtle text-primary">student.info.view</span></td>
                                <td><small class="text-secondary">Nurse / Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                            <tr style="cursor: pointer;" onclick="loadStudentInfoTab('documents')">
                                <td class="ps-4 fw-bold text-primary">Documents (ID, certificates)</td>
                                <td class="text-muted small">Manage official documents</td>
                                <td><span class="badge bg-warning-subtle text-warning">student.info.manage</span></td>
                                <td><small class="text-secondary">Admin</small></td>
                                <td class="text-end pe-4"><span class="material-icons text-muted">chevron_right</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Dynamic Content Area -->
            <div id="student-info-detail-area" class="d-none animate-fade-in">
                <div id="student-info-tab-content"></div>
            </div>
        </div>

        <!-- Groups Management View -->
        <!-- Groups Management View (DISABLED) -->
        <!-- 
        <div id="groups-view" class="view">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="fw-bold"> Learning Management System (LMS)</h2>
                <button class="btn btn-primary-custom" data-bs-toggle="modal" data-bs-target="#createGroupModal">
                    <span class="material-icons align-middle fs-5 me-1">add</span> Create Course
                </button>
            </div>
            <div id="groups-list" class="row g-4">
            </div>
        </div>
        -->
        <!-- Take Quiz Modal -->
        <div class="view full-page-view" id="takeQuizModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-primary-custom text-white">
                        <h5 class="modal-title fw-bold" id="take-quiz-title" data-i18n="modal_take_quiz">Quiz</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <form id="quiz-form">
                            <div id="quiz-questions-container">
                                <!-- Questions Injected Here -->
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer bg-light">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                            data-i18n="btn_cancel">Cancel</button>
                        <button type="button" class="btn btn-primary-custom fw-bold" onclick="submitQuizAnswers()"
                            data-i18n="btn_submit_quiz">Submit Quiz</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Audit View -->
        <div id="admin-view" class="view">
            <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                <h2 class="fw-bold m-0 d-flex align-items-center gap-2">
                    <span class="material-icons text-danger fs-2">admin_panel_settings</span> Admin Dashboard
                </h2>
                <button class="btn btn-outline-secondary d-flex align-items-center gap-2 fw-bold"
                    onclick="switchView('teacher-view')">
                    <span class="material-icons">arrow_back</span> Back to Dashboard
                </button>
            </div>

            <!-- School Management Section -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white py-3">
                    <h5 class="fw-bold m-0 text-primary-custom d-flex align-items-center gap-2">
                        <span class="material-icons">domain</span> School Management
                    </h5>
                </div>
                <div class="card-body p-4">
                    <form id="create-school-form" onsubmit="handleCreateSchool(event)">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-3">
                                <label class="form-label fw-bold small">School Name</label>
                                <input type="text" class="form-control" id="new-school-name"
                                    placeholder="e.g. Springfield High" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">Address</label>
                                <input type="text" class="form-control" id="new-school-address"
                                    placeholder="123 Main St, City" required>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-bold small">Contact Email</label>
                                <input type="email" class="form-control" id="new-school-email"
                                    placeholder="admin@school.edu" required>
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-primary-custom w-100 fw-bold">
                                    <span class="material-icons align-middle fs-6 me-1">add_circle</span> Create
                                </button>
                            </div>
                        </div>
                    </form>
                    <div id="create-school-msg" class="mt-2 small fw-bold"></div>
                </div>
            </div>

            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white py-3">
                    <h5 class="fw-bold m-0 text-danger d-flex align-items-center gap-2">
                        <span class="material-icons">security</span> Security Audit Logs
                    </h5>
                </div>
                <div class="card-body p-0">
                    <div id="audit-logs-container" class="table-responsive">
                        <div class="p-5 text-center text-muted">
                            <div class="spinner-border text-primary mb-3" role="status"></div>
                            <p>Loading security records...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Student View -->
        <!-- Student View -->
        <div id="student-view" class="view">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 id="student-name-header" class="fw-bold mb-0" data-i18n="student_dashboard_title">Student Dashboard
                </h2>
                <button id="student-log-activity-btn" class="btn btn-primary-custom shadow-sm"
                    onclick="openStudentAddActivityModal()">
                    <span class="material-icons align-middle fs-5 me-1">add_task</span> <span
                        data-i18n="btn_log_activity">Log Activity</span>
                </button>
            </div>

            <!-- Live Class Banner -->


            <div id="student-live-banner"
                class="alert alert-danger d-none d-flex justify-content-between align-items-center shadow-sm"
                role="alert">
                <div class="d-flex align-items-center gap-2">
                    <span class="spinner-grow spinner-grow-sm text-danger" role="status"></span>
                    <strong data-i18n="student_live_class"> Live Class in Progress!</strong>
                </div>
                <div class="d-flex gap-2">
                    <a id="student-join-link" href="#" target="_blank" class="btn btn-sm btn-danger fw-bold"
                        data-i18n="btn_join_class">Join
                        Class</a>
                    <button class="btn btn-sm btn-dark fw-bold" onclick="openWhiteboard()"
                        data-i18n="btn_join_whiteboard">Join Whiteboard</button>
                </div>
            </div>

            <!-- Metrics -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <h3 class="h5 text-secondary fw-bold mb-3" data-i18n="student_key_metrics">Student Key Metrics</h3>
                    <div id="student-metrics" class="row g-4">
                        <!-- Metrics injected here -->
                    </div>
                </div>
            </div>

            <!-- Live Classes -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <h3 class="h5 text-danger fw-bold mb-3 d-flex align-items-center">
                        <span class="material-icons me-2">live_tv</span> <span
                            data-i18n="student_upcoming_live">Upcoming Live Classes</span>
                    </h3>
                    <div id="live-classes-list">
                        <p class="text-muted" data-i18n="msg_no_live_classes">No live classes scheduled.</p>
                    </div>
                </div>
            </div>

            <!-- Live Banner -->
            <div id="student-live-banner"
                class="live-class-banner text-white p-3 rounded-3 mb-4 d-none justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-2 fw-bold">
                    <span class="spinner-grow spinner-grow-sm bg-white" role="status"></span>
                    <span data-i18n="live_class_session">LIVE CLASS IN SESSION</span>
                </div>
                <a id="student-join-link" href="#" target="_blank" class="btn btn-light text-danger fw-bold"
                    data-i18n="btn_join_now">JOIN
                    NOW</a>
            </div>

            <!-- Gamification Bar -->
            <div class="card border-0 shadow-sm mb-4 bg-primary-custom text-white overflow-hidden position-relative">
                <div class="card-body p-4 position-relative" style="z-index: 1;">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h4 class="mb-0 fw-bold d-flex align-items-center gap-2">
                            <span class="material-icons text-warning">emoji_events</span> <span
                                data-i18n="student_level">Level</span> <span id="student-level">1</span>
                        </h4>
                        <span class="badge bg-white text-primary fw-bold fs-6 shadow-sm"><span id="student-xp">0</span>
                            XP</span>
                    </div>
                    <div class="progress bg-white bg-opacity-25" style="height: 10px; border-radius: 10px;">
                        <div id="student-xp-bar" class="progress-bar bg-warning" role="progressbar" style="width: 0%">
                        </div>
                    </div>
                    <div id="student-badges" class="d-flex mt-3 gap-2 flex-wrap">
                        <!-- Badges injected here -->
                    </div>
                </div>
                <!-- Decorative Circles -->
                <div class="position-absolute top-0 end-0 bg-white opacity-10 rounded-circle"
                    style="width: 150px; height: 150px; transform: translate(30%, -30%);"></div>
                <div class="position-absolute bottom-0 start-0 bg-white opacity-10 rounded-circle"
                    style="width: 100px; height: 100px; transform: translate(-30%, 30%);"></div>
            </div>

            <!-- Student Groups (Subject Hubs) -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <h3 class="h5 text-primary-custom fw-bold mb-3 d-flex align-items-center">
                        <span class="material-icons me-2">class</span> <span data-i18n="student_my_courses">My
                            Courses</span>
                    </h3>
                    <div id="student-groups-list" class="row g-3">
                        <p class="text-muted small" data-i18n="msg_no_courses">You are not enrolled in any courses yet.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Upcoming Assignments -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <h3 class="h5 text-danger fw-bold mb-3 d-flex align-items-center">
                        <span class="material-icons me-2">assignment_late</span> <span
                            data-i18n="student_upcoming_assignments">Upcoming Assignments & Projects</span>
                    </h3>
                    <div id="student-upcoming-assignments" class="list-group list-group-flush">
                        <p class="text-muted small" data-i18n="msg_loading_assignments">Loading assignments...</p>
                    </div>
                </div>

            </div>

            <!-- Quiz Results -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <h3 class="h5 text-success fw-bold mb-3 d-flex align-items-center">
                        <span class="material-icons me-2">fact_check</span> <span
                            data-i18n="student_quiz_results">Recent Quiz Results</span>
                    </h3>
                    <div id="student-quiz-results-list" class="list-group list-group-flush">
                        <p class="text-muted small">Loading results...</p>
                    </div>
                </div>
            </div>


            <!-- Recommendation Box -->
            <div id="recommendation-box" class="alert alert-info border-start border-4 border-info shadow-sm mb-4"
                style="display:none;"></div>

            <!-- Progress & History Tabs -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white border-bottom-0 pt-4 px-4">
                    <ul class="nav nav-tabs card-header-tabs" id="studentTabs" role="tablist">
                        <li class="nav-item">
                            <button class="nav-link active fw-bold text-dark" id="progress-tab-btn" data-bs-toggle="tab"
                                data-bs-target="#progress-tab-pane" type="button" data-i18n="tab_progress_graph">
                                Progress Graph</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link fw-bold text-muted" id="history-tab-btn" data-bs-toggle="tab"
                                data-bs-target="#history-tab-pane" type="button" data-i18n="tab_activity_history">
                                Activity History</button>
                        </li>
                    </ul>
                </div>
                <div class="card-body p-4">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="progress-tab-pane" role="tabpanel">
                            <div id="student-progress-chart" style="height: 350px;"></div>
                        </div>
                        <div class="tab-pane fade" id="history-tab-pane" role="tabpanel">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <tbody id="history-table"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Removed AI Tutor Chat from here -->
        </div>

        <!-- Parent View (Observer Mode) -->
        <div id="parent-dashboard-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">family_restroom</span> <span
                    data-i18n="parent_portal_title">Parent Portal</span>
            </h2>

            <!-- Child Selector -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <label class="form-label fw-bold" data-i18n="label_select_child">Select Your Child</label>
                    <div class="input-group">
                        <input type="text" id="parent-child-id" class="form-control" data-i18n-placeholder="ph_child_id"
                            placeholder="Enter Child's Student ID (e.g., S001)">
                        <button class="btn btn-primary-custom" onclick="loadParentChildData()"
                            data-i18n="btn_view_progress">View Progress</button>
                    </div>
                    <div class="form-text" data-i18n="msg_enter_child_id">Enter the Student ID provided by the school.
                    </div>
                </div>
            </div>

            <div id="parent-dashboard-content" class="d-none">
                <h4 class="fw-bold text-secondary mb-3"><span data-i18n="parent_overview_for">Overview for</span> <span
                        id="parent-child-name" class="text-dark"></span></h4>

                <!-- Parent Metrics -->
                <div id="parent-metrics" class="row g-4 mb-4">
                    <!-- Metrics injected here -->
                </div>

                <!-- Recent Updates Area -->
                <div class="alert alert-info border-start border-4 border-info shadow-sm">
                    <h5 class="alert-heading fw-bold d-flex align-items-center"><span
                            class="material-icons me-2">notifications_active</span> <span
                            data-i18n="parent_key_updates">Key Updates</span></h5>
                    <ul class="mb-0 small">
                        <li data-i18n="update_school_close">School closes early tomorrow at 2 PM.</li>
                        <li data-i18n="update_report_cards">Report cards have been published.</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 2. Academic Progress View -->
        <div id="parent-academic-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">auto_stories</span> <span
                    data-i18n="parent_academic_progress">Academic Progress</span>
            </h2>

            <div class="row g-4 mb-4">
                <div class="col-12">
                    <div class="alert alert-light border shadow-sm">
                        <h5 class="alert-heading fw-bold" data-i18n="parent_teacher_feedback">Teacher Feedback</h5>
                        <p id="parent-feedback" class="mb-0 text-muted" data-i18n="msg_loading_feedback">Loading
                            feedback...</p>
                    </div>
                </div>
            </div>

            <div class="row g-4 mb-4">
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold" data-i18n="parent_recent_marks">Recent Marks</div>
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th data-i18n="th_subject">Subject</th>
                                        <th data-i18n="th_exam">Exam</th>
                                        <th data-i18n="th_score">Score</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Math</td>
                                        <td>Unit Test</td>
                                        <td class="text-success fw-bold">88%</td>
                                    </tr>
                                    <tr>
                                        <td>Science</td>
                                        <td>Lab</td>
                                        <td class="text-primary fw-bold">92%</td>
                                    </tr>
                                    <tr>
                                        <td>English</td>
                                        <td>Essay</td>
                                        <td class="text-warning fw-bold">75%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold" data-i18n="parent_performance_chart">Performance Chart
                        </div>
                        <div class="card-body">
                            <div id="parent-progress-chart" style="height: 250px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row g-4">
                <div class="col-12">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white fw-bold" data-i18n="parent_report_cards">Report Cards</div>
                        <div class="list-group list-group-flush">
                            <a href="#"
                                class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                <div><span class="material-icons align-middle text-danger me-2">picture_as_pdf</span>
                                    <span data-i18n="term_1_report">Term 1 Report</span>
                                </div>
                                <span class="badge bg-secondary" data-i18n="badge_download">Download</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. Attendance View -->
        <div id="parent-attendance-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">calendar_today</span> Attendance Records
            </h2>
            <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="fw-bold m-0">Monthly Attendance</h5>
                        <div class="badge bg-primary fs-6">Overall: <span id="parent-attendance">--</span></div>
                    </div>
                    <div class="row g-3 text-center mb-4">
                        <div class="col-4">
                            <div class="p-3 bg-success bg-opacity-10 rounded">
                                <h3 class="fw-bold text-success mb-0">22</h3>
                                <small class="text-muted">Present</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-3 bg-danger bg-opacity-10 rounded">
                                <h3 class="fw-bold text-danger mb-0">1</h3>
                                <small class="text-muted">Absent</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-3 bg-warning bg-opacity-10 rounded">
                                <h3 class="fw-bold text-warning mb-0">0</h3>
                                <small class="text-muted">Late</small>
                            </div>
                        </div>
                    </div>
                    <p class="text-center text-muted">Calendar view coming soon.</p>
                </div>
            </div>
        </div>

        <!-- 4. Fees & Payments View -->
        <div id="parent-fees-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">payments</span> Fees & Payments
            </h2>
            <div class="row g-4">
                <div class="col-md-5">
                    <div class="card border-0 shadow-sm bg-primary-custom text-white">
                        <div class="card-body p-4">
                            <h6 class="text-uppercase opacity-75">Outstanding Balance</h6>
                            <h2 class="fw-bold display-5 mb-0">$1,200.00</h2>
                            <p class="small opacity-75 mb-4">Due by Oct 31, 2025</p>
                            <button class="btn btn-warning w-100 fw-bold text-dark">Pay Now</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-7">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold">Payment History</div>
                        <table class="table table-hover mb-0 small">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Sep 10</td>
                                    <td>Term 1 Tuition</td>
                                    <td>$2,000</td>
                                    <td><span class="badge bg-success">Paid</span></td>
                                </tr>
                                <tr>
                                    <td>Aug 15</td>
                                    <td>Lab Fees</td>
                                    <td>$150</td>
                                    <td><span class="badge bg-success">Paid</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. Communication View -->
        <div id="parent-communication-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">forum</span> Communication
            </h2>
            <div class="list-group">
                <a href="#"
                    class="list-group-item list-group-item-action p-4 border-start border-4 border-primary shadow-sm mb-3 rounded-end">
                    <div class="d-flex w-100 justify-content-between">
                        <h5 class="mb-1 fw-bold">Parent-Teacher Meeting</h5>
                        <small>Yesterday</small>
                    </div>
                    <p class="mb-1">Scheduled for next Friday at 10 AM regarding Alice's progress.</p>
                    <small class="text-muted">From: Mrs. Johnson (Class Teacher)</small>
                </a>
                <a href="#"
                    class="list-group-item list-group-item-action p-4 border-start border-4 border-warning shadow-sm mb-3 rounded-end">
                    <div class="d-flex w-100 justify-content-between">
                        <h5 class="mb-1 fw-bold">School Bus Delay</h5>
                        <small>2 days ago</small>
                    </div>
                    <p class="mb-1">Bus Route 4 will be delayed by 15 mins due to road work.</p>
                    <small class="text-muted">From: Transport Admin</small>
                </a>
            </div>
            <button class="btn btn-outline-primary d-flex align-items-center gap-2 mt-3">
                <span class="material-icons">send</span> Send Message to Teacher
            </button>
        </div>


        <!-- Profile View -->
        <div id="profile-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">account_circle</span> My Profile
            </h2>

            <div class="row justify-content-center">
                <div class="col-md-8 col-lg-6">
                    <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
                        <div class="card-header border-0 p-5 text-center text-white position-relative"
                            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <div class="position-absolute top-0 end-0 p-3">
                                <button
                                    class="btn btn-white btn-sm bg-white bg-opacity-25 text-white border-0 rounded-pill"
                                    onclick="handleLogout()">
                                    <span class="material-icons align-middle fs-6 me-1">logout</span> Logout
                                </button>
                            </div>
                            <img src="" id="profile-img-large"
                                class="rounded-circle shadow-sm border border-4 border-white mb-3" width="120"
                                height="120" style="object-fit: cover; background: white;">
                            <h3 class="fw-bold mb-1" id="profile-name">--</h3>
                            <p class="mb-0 opacity-75" id="profile-role">--</p>
                        </div>
                        <div class="card-body p-4 p-md-5">
                            <div class="row g-4">
                                <div class="col-6">
                                    <label class="small text-muted fw-bold text-uppercase">User ID</label>
                                    <p class="fs-5 fw-medium text-dark mb-0" id="profile-id">--</p>
                                </div>
                                <div class="col-6">
                                    <label class="small text-muted fw-bold text-uppercase">Email</label>
                                    <p class="fs-5 fw-medium text-dark mb-0" id="profile-email">--</p>
                                </div>
                                <div class="col-12">
                                    <label class="small text-muted fw-bold text-uppercase">Bio / Status</label>
                                    <p class="text-muted fst-italic mb-0">"Lifelong learner & educator."</p>
                                </div>
                            </div>

                            <hr class="my-4 bg-secondary opacity-10">

                            <div class="d-grid gap-2">
                                <button class="btn btn-outline-primary py-2 fw-bold rounded-pill"
                                    onclick="alert('Edit Profile feature coming soon!')">
                                    Edit Profile
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        </div>
        </div>

        <!-- 2. My Academics View -->
        <div id="student-academics-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">menu_book</span> My Academics
            </h2>
            <div class="row g-4">
                <!-- Subjects Card -->
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body p-4">
                            <h5 class="fw-bold mb-3"> Subjects & Syllabus</h5>
                            <div class="list-group list-group-flush">
                                <a href="#"
                                    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                    <span>Mathematics</span> <span class="badge bg-primary rounded-pill">Ch 1-5</span>
                                </a>
                                <a href="#"
                                    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                    <span>Science</span> <span class="badge bg-success rounded-pill">Physics</span>
                                </a>
                                <a href="#"
                                    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                    <span>English</span> <span class="badge bg-info rounded-pill">Literature</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Timetable Card -->
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body p-4">
                            <h5 class="fw-bold mb-3"> Class Timetable</h5>
                            <div class="alert alert-light border">
                                <div class="d-flex justify-content-between mb-2">
                                    <strong>09:00 AM</strong> <span>Mathematics (Rm 101)</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <strong>10:30 AM</strong> <span>Science Lab</span>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <strong>01:00 PM</strong> <span>English History</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. Assignments & Exams View -->
        <div id="student-exams-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-danger fs-2">assignment</span> Assignments & Exams
            </h2>
            <ul class="nav nav-pills mb-4" id="exams-tabs" role="tablist">
                <li class="nav-item">
                    <button class="nav-link active fw-bold" id="homework-tab-btn" data-bs-toggle="pill"
                        data-bs-target="#homework-tab">Homework</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link fw-bold" id="exams-tab-btn" data-bs-toggle="pill"
                        data-bs-target="#exams-tab">Exam Schedules</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link fw-bold" id="results-tab-btn" data-bs-toggle="pill"
                        data-bs-target="#results-tab">Results</button>
                </li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane fade show active" id="homework-tab">
                    <div class="alert alert-light border text-muted mb-0">Loading assignments...</div>
                </div>
                <div class="tab-pane fade" id="exams-tab">
                    <div id="student-assignment-exam-schedules">
                        <div class="alert alert-light border text-muted mb-0">Loading exam schedules...</div>
                    </div>
                </div>
                <div class="tab-pane fade" id="results-tab">
                    <div class="alert alert-light border text-muted mb-0">Loading results...</div>
                </div>
            </div>
        </div>

        <!-- 4. Performance View -->
        <div id="student-performance-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-success fs-2">insights</span> Performance Analysis
            </h2>
            <div class="row g-4">
                <div class="col-md-8">
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-body p-4">
                            <h5 class="fw-bold mb-3"> Academic Progress</h5>
                            <div class="d-flex align-items-end justify-content-between" style="height: 200px;">
                                <!-- Mock Chart Bars -->
                                <div class="w-100 d-flex justify-content-around h-100 align-items-end">
                                    <div class="bg-primary opacity-50 rounded-top text-center text-white pt-1"
                                        style="width: 15%; height: 60%">Unit 1<br>60%</div>
                                    <div class="bg-primary opacity-75 rounded-top text-center text-white pt-1"
                                        style="width: 15%; height: 75%">Unit 2<br>75%</div>
                                    <div class="bg-primary rounded-top text-center text-white pt-1"
                                        style="width: 15%; height: 85%">Mid<br>85%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-body p-4">
                            <h5 class="fw-bold mb-3"> Strengths</h5>
                            <span class="badge bg-success p-2 me-1 mb-2">Problem Solving</span>
                            <span class="badge bg-success p-2 me-1 mb-2">Physics</span>
                            <h5 class="fw-bold mb-3 mt-4"> Improvement Areas</h5>
                            <span class="badge bg-warning text-dark p-2 me-1 mb-2">Grammar</span>
                            <span class="badge bg-warning text-dark p-2 me-1 mb-2">History Dates</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. Communication View -->
        <div id="student-communication-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-info fs-2">forum</span> Communication Hub
            </h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold"> Notice Board</div>
                        <div class="list-group list-group-flush">
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">School Closed</h6>
                                    <small>Today</small>
                                </div>
                                <small class="text-muted">Due to heavy rain.</small>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Sports Day</h6>
                                    <small>Yesterday</small>
                                </div>
                                <small class="text-muted">Register by Friday.</small>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white fw-bold"> Teacher Messages & Doubts</div>
                        <div
                            class="card-body d-flex flex-column justify-content-center align-items-center text-center text-muted">
                            <span class="material-icons fs-1 mb-2 opacity-50">chat_bubble_outline</span>
                            <h5>No new messages</h5>
                            <p>Ask a doubt or check back later for updates from your teachers.</p>
                            <button class="btn btn-outline-primary btn-sm mt-2">Ask a Doubt</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="student-notifications-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Notifications</h3>
            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white border-bottom p-3">
                    <h5 class="mb-0 fw-bold">Attendance & Updates</h5>
                </div>
                <div class="list-group list-group-flush" id="student-notifications-list">
                    <div class="p-4 text-center text-muted">Loading...</div>
                </div>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- NEW TEACHER MODULE VIEWS (FR-6)            -->
        <!-- ========================================== -->

        <!-- 1. Timetable -->
        <!-- 1. Timetable -->
        <div id="timetable-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h3 class="fw-bold mb-1 text-dark">Timetable</h3>
                    <p class="text-muted small mb-0">Academic Year 2024-2025  Grade 10-A</p>
                </div>
                <button class="btn btn-white shadow-sm rounded-pill border fw-medium px-4 text-primary bg-white">
                    <span class="material-icons align-middle fs-6 me-2">download</span>Download PDF
                </button>
            </div>

            <div class="card border-0 shadow rounded-4 overflow-hidden">
                <div class="table-responsive">
                    <table class="table table-borderless align-middle mb-0 text-center">
                        <thead style="background-color: #f8f9fa; border-bottom: 2px solid #e9ecef;">
                            <tr>
                                <th class="py-3 text-uppercase text-secondary small fw-bold text-start ps-4"
                                    style="width: 150px;">Day</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Monday</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Tuesday</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Wednesday</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Thursday</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Friday</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Changed to Time-based logic to match typical timetable structures or keep Days as columns? 
                             The screenshot showed DAY as headers. So I will keep Days as headers.
                             Wait, looking at screenshot 0 (Timetable):
                             Headers: TIME [09:00..., 10:00...] (Left column? No, Header row has Days, Left Column has Time?)
                             Actually, Screenshot 0 has:
                             Headers: MONDAY, TUESDAY... 
                             Left Column: not visible but likely TIME or implicitly time slots.
                             Ah, standard view:
                             Left Col: 09:00 - 10:00
                             Col 1: Mon
                             Col 2: Tue ... etc.
                        -->
                            <tr>
                                <td class="fw-bold text-muted small py-4 text-start ps-4">09:00 - 10:00</td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-blue">
                                        <div class="fw-bold text-dark">Mathematics</div>
                                        <div class="small text-muted">Room 101</div>
                                    </div>
                                </td>
                                <td class="py-2 text-muted">-</td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-blue">
                                        <div class="fw-bold text-dark">Mathematics</div>
                                        <div class="small text-muted">Room 101</div>
                                    </div>
                                </td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-green">
                                        <div class="fw-bold text-dark">Science</div>
                                        <div class="small text-muted">Lab 2</div>
                                    </div>
                                </td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-blue">
                                        <div class="fw-bold text-dark">Mathematics</div>
                                        <div class="small text-muted">Room 101</div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="fw-bold text-muted small py-4 text-start ps-4">10:00 - 11:00</td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-green">
                                        <div class="fw-bold text-dark">Science</div>
                                        <div class="small text-muted">Lab 2</div>
                                    </div>
                                </td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-blue">
                                        <div class="fw-bold text-dark">Mathematics</div>
                                        <div class="small text-muted">Room 101</div>
                                    </div>
                                </td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-orange">
                                        <div class="fw-bold text-dark">History</div>
                                        <div class="small text-muted">Room 104</div>
                                    </div>
                                </td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-light border border-light">
                                        <div class="fw-bold text-muted">Library</div>
                                    </div>
                                </td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-green">
                                        <div class="fw-bold text-dark">Science</div>
                                        <div class="small text-muted">Lab 2</div>
                                    </div>
                                </td>
                            </tr>
                            <tr style="background-color: #fafafa;">
                                <td class="fw-bold text-muted small py-3 text-start ps-4">11:00 - 11:30</td>
                                <td colspan="5" class="text-muted fw-medium small letter-spacing-1 text-center">LUNCH
                                    BREAK
                                </td>
                            </tr>
                            <tr>
                                <td class="fw-bold text-muted small py-4 text-start ps-4">11:30 - 12:30</td>
                                <td class="py-2 text-muted">-</td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-red">
                                        <div class="fw-bold text-dark">Physics</div>
                                        <div class="small text-muted">Lab 1</div>
                                    </div>
                                </td>
                                <td class="py-2 text-muted">-</td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-blue">
                                        <div class="fw-bold text-dark">Mathematics</div>
                                        <div class="small text-muted">Room 101</div>
                                    </div>
                                </td>
                                <td class="py-2 text-muted">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 2. Attendance -->
        <div id="attendance-take-view" class="view container-fluid p-4">
            <div class="row align-items-center mb-4 g-3">
                <div class="col-md-5">
                    <h3 class="fw-bold mb-1 text-dark">Take student attendance</h3>
                </div>
                <!-- Controls for Real Data -->
                <div class="col-md-7 text-md-end d-flex justify-content-end gap-3 align-items-center">
                    <div class="d-flex gap-2 align-items-center bg-white p-2 rounded shadow-sm border">
                        <label class="small fw-bold text-muted me-2">Class:</label>
                        <select class="form-select form-select-sm w-auto border-0 bg-light" id="att-view-grade"
                            onchange="loadAttendanceViewList()">
                            <option value="1">Grade 1</option>
                            <option value="2">Grade 2</option>
                            <option value="3">Grade 3</option>
                            <option value="4">Grade 4</option>
                            <option value="5">Grade 5</option>
                            <option value="9">Class 9</option>
                        </select>
                        <div class="vr mx-2"></div>
                        <label class="small fw-bold text-muted me-2">Date:</label>
                        <input type="date" class="form-control form-control-sm w-auto border-0 bg-light"
                            id="att-view-date" onchange="loadAttendanceViewList()">
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-end align-items-center gap-2 mb-4">
                <button class="btn btn-outline-danger rounded-pill fw-bold px-4 py-2 hover-up shadow-sm small"
                    onclick="bulkSetAttendanceView('Absent')">Mark All Absent</button>
                <button class="btn btn-success rounded-pill fw-bold px-4 py-2 hover-up shadow-sm small"
                    onclick="bulkSetAttendanceView('Present')">Mark All Present</button>
                <button class="btn btn-primary-custom rounded-pill fw-bold px-4 py-2 hover-up shadow-sm small"
                    style="background-color: #28245D;" onclick="saveAttendanceViewRecord()">Save Record</button>
            </div>

            <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                <!-- Table Header -->
                <div class="card-header bg-white py-3 border-bottom border-light">
                    <div class="row fw-bold text-muted small text-uppercase">
                        <div class="col-md-4 ps-4">Student Name</div>
                        <div class="col-md-4 text-center">Status</div>
                        <div class="col-md-4 text-end pe-4">Remarks</div>
                    </div>
                </div>

                <div class="card-body p-0">
                    <div id="attendance-view-list-body">
                        <!-- Content injected by loadAttendanceViewList -->
                        <div class="text-center p-5 text-muted">
                            <div class="spinner-border text-primary mb-3" role="status"></div>
                            <p>Loading class data...</p>
                        </div>
                    </div>
                </div> <!-- End card-body -->
            </div> <!-- End card -->
        </div> <!-- End view -->

        <!-- Month-wise Attendance View (Placeholder as per Screenshot 2 logic) -->
        <div id="attendance-sheet-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold mb-0 text-dark">Class Attendance Sheet</h3>
            </div>

            <div class="card border-0 shadow-sm rounded-4 bg-white p-4">
                <div class="row g-3 align-items-end mb-4">
                    <div class="col-md-3">
                        <label class="form-label fw-bold">Select Class</label>
                        <select id="sheet-view-grade" class="form-select bg-light border-0"
                            onchange="loadAttendanceSheetData()">
                            <option value="1">Grade 1</option>
                            <option value="2">Grade 2</option>
                            <option value="3">Grade 3</option>
                            <option value="9">Grade 9</option>
                            <option value="10" selected>Grade 10</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label fw-bold">Select Date</label>
                        <input type="date" id="sheet-view-date" class="form-control bg-light border-0"
                            onchange="loadAttendanceSheetData()">
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="bg-light">
                            <tr>
                                <th class="ps-4 rounded-start">Student</th>
                                <th class="text-center">Status</th>
                                <th class="pe-4 rounded-end">Remarks</th>
                            </tr>
                        </thead>
                        <tbody id="sheet-view-body">
                            <tr>
                                <td colspan="3" class="text-center p-5 text-muted">Select a date to view attendance.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="attendance-leave-approval-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Leave Requests</h3>

            <div class="card border-0 shadow rounded-4 overflow-hidden">
                <div class="card-header bg-white py-3 border-bottom border-light">
                    <ul class="nav nav-pills card-header-pills">
                        <li class="nav-item">
                            <a id="leave-approval-pending-tab"
                                class="nav-link active bg-primary text-white shadow-sm rounded-pill px-4" href="#"
                                role="button">Pending
                                (2)</a>
                        </li>
                        <li class="nav-item">
                            <a id="leave-approval-history-tab" class="nav-link text-muted px-4" href="#"
                                role="button">History</a>
                        </li>
                    </ul>
                </div>
                <ul id="leave-approval-list" class="list-group list-group-flush">
                    <!-- Request 1 -->
                    <li class="list-group-item p-4 border-light">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center gap-3">
                                <div class="avatar-md bg-soft-warning text-warning rounded-circle d-flex align-items-center justify-content-center fw-bold"
                                    style="width: 50px; height: 50px; background-color: #fff3cd;">CD</div>
                                <div>
                                    <h6 class="mb-1 fw-bold text-dark">Charlie Davis <span
                                            class="badge bg-light text-muted border fw-normal ms-2">Grade 10-B</span>
                                    </h6>
                                    <div class="text-muted small"><i
                                            class="material-icons align-middle fs-6 me-1 text-secondary">event</i> Oct
                                        22 -
                                        Oct 23 (2 Days)  <span class="fw-medium text-dark">Family Function</span></div>
                                    <p class="mb-0 mt-2 text-muted small fst-italic">"My sister is getting married on
                                        these
                                        dates so I need to attend..."</p>
                                </div>
                            </div>
                            <div class="d-flex align-items-center gap-2">
                                <button class="btn btn-outline-danger btn-sm rounded-pill px-3 fw-medium">Deny</button>
                                <button class="btn btn-success btn-sm rounded-pill px-4 fw-bold shadow-sm">Approve
                                    Request</button>
                            </div>
                        </div>
                    </li>

                    <!-- Request 2 -->
                    <li class="list-group-item p-4 border-light">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center gap-3">
                                <div class="avatar-md bg-soft-danger text-danger rounded-circle d-flex align-items-center justify-content-center fw-bold"
                                    style="width: 50px; height: 50px; background-color: #f8d7da;">DL</div>
                                <div>
                                    <h6 class="mb-1 fw-bold text-dark">Dana Lee <span
                                            class="badge bg-light text-muted border fw-normal ms-2">Grade 10-A</span>
                                    </h6>
                                    <div class="text-muted small"><i
                                            class="material-icons align-middle fs-6 me-1 text-secondary">event</i> Oct
                                        20 (1
                                        Day)  <span class="fw-medium text-dark">Sick Leave</span></div>
                                </div>
                            </div>
                            <div class="d-flex align-items-center gap-2">
                                <button class="btn btn-outline-danger btn-sm rounded-pill px-3 fw-medium">Deny</button>
                                <button class="btn btn-success btn-sm rounded-pill px-4 fw-bold shadow-sm">Approve
                                    Request</button>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>

        <!-- STUDENT LEAVE VIEW -->
        <div id="student-leave-view" class="view container-fluid p-4">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary fs-2">timer_off</span> Requests
            </h2>
            <div class="row g-4">
                <div class="col-md-5">
                    <div class="card border-0 shadow-sm rounded-4">
                        <div class="card-header bg-primary text-white fw-bold py-3 rounded-top-4">Apply for Leave</div>
                        <div class="card-body p-4">
                            <form id="student-leave-form">
                                <div class="mb-3">
                                    <label class="form-label fw-medium">Leave Type</label>
                                    <select class="form-select" id="leave-type" required>
                                        <option value="Sick Leave">Sick Leave</option>
                                        <option value="Casual Leave">Casual Leave</option>
                                        <option value="Family Function">Family Function</option>
                                        <option value="Emergency">Emergency</option>
                                    </select>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label fw-medium">Start Date</label>
                                        <input type="date" class="form-control" id="leave-start" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label fw-medium">End Date</label>
                                        <input type="date" class="form-control" id="leave-end" required>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-medium">Reason</label>
                                    <textarea class="form-control" id="leave-reason" rows="3" required
                                        placeholder="Describe why you need leave..."></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary w-100 rounded-pill fw-bold">Submit
                                    Application</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col-md-7">
                    <div class="card border-0 shadow-sm rounded-4">
                        <div class="card-header bg-white fw-bold py-3 border-bottom">My Leave History</div>
                        <div class="card-body p-0">
                            <div class="list-group list-group-flush" id="student-leave-history-list">
                                <!-- Dynamic Content -->
                                <div class="text-center p-5 text-muted">
                                    <span class="material-icons fs-1 text-light">history</span>
                                    <p class="mt-2">Loading history...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="teacher-leave-apply-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">My Leave Application</h3>
            <div class="row">
                <div class="col-md-7">
                    <div class="card border-0 shadow rounded-4 p-4">
                        <h5 class="fw-bold mb-4 text-secondary">New Application</h5>
                        <form id="teacher-leave-form" onsubmit="handleTeacherLeaveSubmit(event)">
                            <div class="mb-4">
                                <label class="form-label text-muted small fw-bold text-uppercase">Leave Type</label>
                                <div class="d-flex gap-2">
                                    <input type="radio" class="btn-check" name="leaveType" id="lt1" value="Sick Leave"
                                        autocomplete="off" checked>
                                    <label class="btn btn-outline-primary rounded-pill px-4" for="lt1">Sick
                                        Leave</label>

                                    <input type="radio" class="btn-check" name="leaveType" id="lt2" value="Casual Leave"
                                        autocomplete="off">
                                    <label class="btn btn-outline-primary rounded-pill px-4" for="lt2">Casual
                                        Leave</label>

                                    <input type="radio" class="btn-check" name="leaveType" id="lt3" value="Emergency"
                                        autocomplete="off">
                                    <label class="btn btn-outline-primary rounded-pill px-4" for="lt3">Emergency</label>
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-6">
                                    <label class="form-label text-muted small fw-bold text-uppercase">From Date</label>
                                    <input type="date" id="teacher-leave-start"
                                        class="form-control bg-light border-0 rounded-3 p-3" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label text-muted small fw-bold text-uppercase">To Date</label>
                                    <input type="date" id="teacher-leave-end"
                                        class="form-control bg-light border-0 rounded-3 p-3" required>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label class="form-label text-muted small fw-bold text-uppercase">Reason</label>
                                <textarea id="teacher-leave-reason" class="form-control bg-light border-0 rounded-3 p-3"
                                    rows="3" placeholder="Please describe the reason for your leave..."
                                    required></textarea>
                            </div>

                            <div class="d-grid">
                                <button type="submit"
                                    class="btn btn-primary-custom rounded-pill py-3 fw-bold shadow-sm">Submit
                                    Request</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="col-md-5">
                    <div class="card border-0 shadow-sm rounded-4 p-4 bg-primary text-white mb-4"
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h5 class="fw-bold mb-1">Leave Balance</h5>
                        <p class="opacity-75 small">Academic Year 2024-2025</p>
                        <div class="d-flex justify-content-between mt-3 text-center">
                            <div>
                                <h2 class="fw-bold mb-0">12</h2>
                                <small class="opacity-75">Casual</small>
                            </div>
                            <div>
                                <h2 class="fw-bold mb-0">5</h2>
                                <small class="opacity-75">Sick</small>
                            </div>
                            <div>
                                <h2 class="fw-bold mb-0">2</h2>
                                <small class="opacity-75">Used</small>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Charts Section -->
                    <div class="charts-container"
                        style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; margin-bottom: 30px;">
                        <div class="chart-card"
                            style="background: white; padding: 20px; border-radius: 15px; border: 1px solid #E0E0E0;">
                            <h3 style="color: #303972; margin-bottom: 15px; font-size: 1.2rem;">Student Progress</h3>
                            <canvas id="studentProgressChart"></canvas>
                        </div>
                        <div class="chart-card"
                            style="background: white; padding: 20px; border-radius: 15px; border: 1px solid #E0E0E0;">
                            <h3 style="color: #303972; margin-bottom: 15px; font-size: 1.2rem;">Attendance Overview</h3>
                            <canvas id="attendanceChart"></canvas>
                        </div>
                    </div>

                    <!-- Demo Buttons for SweetAlert -->
                    <div style="margin-bottom: 30px; display: flex; gap: 10px;">
                        <button onclick="showSuccessToast()" class="btn btn-success" style="color: white;">Test Success
                            Toast</button>
                        <button onclick="showErrorToast()" class="btn btn-danger" style="color: white;">Test Error
                            Toast</button>
                    </div>

                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <h6 class="fw-bold mb-3 text-secondary">Recent History</h6>
                        <ul class="list-unstyled mb-0">
                            <li
                                class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom border-light">
                                <div>
                                    <div class="fw-bold text-dark">Sick Leave</div>
                                    <small class="text-muted">Sep 10 - Sep 11</small>
                                </div>
                                <span
                                    class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">Approved</span>
                            </li>
                            <li class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="fw-bold text-dark">Casual Leave</div>
                                    <small class="text-muted">Aug 05</small>
                                </div>
                                <span
                                    class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">Approved</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="assignment-view-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h3 class="fw-bold mb-1 text-dark" data-i18n="asg_active_title">Active Assignments</h3>
                    <div class="text-muted small" data-i18n="asg_active_subtitle">Create, review submissions, and track
                        progress by class.</div>
                </div>
                <button id="create-assignment-btn" class="btn btn-primary-custom d-none"
                    onclick="openCreateAssignmentModal()">
                    <span class="material-icons align-middle fs-5 me-1">add_circle</span> <span
                        data-i18n="btn_create_assignment">Create Assignment</span>
                </button>
            </div>
            <div id="academics-assignments-list" class="mt-2"></div>
        </div>

        <!-- Legacy Attendance Overview (kept for backward compatibility) -->
        <div id="attendance-management-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold m-0 text-primary-custom">Attendance Management</h3>
                <button class="btn btn-primary-custom shadow-sm px-4 rounded-pill" onclick="openAttendanceModal()">
                    <span class="material-icons align-middle me-1">add_task</span> Take Attendance
                </button>
            </div>

            <div class="row g-4">
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 border-0 shadow-sm rounded-4 overlay-hidden hover-scale cursor-pointer"
                        onclick="openAttendanceModal()">
                        <div
                            class="card-body p-4 text-center d-flex flex-column align-items-center justify-content-center">
                            <div class="bg-primary-subtle text-primary p-3 rounded-circle mb-3">
                                <span class="material-icons fs-1">playlist_add_check</span>
                            </div>
                            <h5 class="fw-bold">Daily Attendance</h5>
                            <p class="text-muted small mb-0">Mark absent, present, or late for classes.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 border-0 shadow-sm rounded-4 overlay-hidden hover-scale">
                        <div
                            class="card-body p-4 text-center d-flex flex-column align-items-center justify-content-center">
                            <div class="bg-success-subtle text-success p-3 rounded-circle mb-3">
                                <span class="material-icons fs-1">calendar_month</span>
                            </div>
                            <h5 class="fw-bold">Monthly Report</h5>
                            <p class="text-muted small mb-0">View presence summary by month.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 border-0 shadow-sm rounded-4 overlay-hidden hover-scale">
                        <div
                            class="card-body p-4 text-center d-flex flex-column align-items-center justify-content-center">
                            <div class="bg-warning-subtle text-warning p-3 rounded-circle mb-3">
                                <span class="material-icons fs-1">sick</span>
                            </div>
                            <h5 class="fw-bold">Leave Requests</h5>
                            <p class="text-muted small mb-0">Approve or deny student leave applications.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <div id="attendance-report-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Monthly Report</h3>
            <div class="card border-0 shadow-sm p-5 text-center">
                <img src="https://illustrations.popsy.co/amber/chart.svg" class="mb-3" style="height: 150px;">
                <h5 class="fw-bold">Analytics Coming Soon</h5>
            </div>
        </div>

        <div id="attendance-approve-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold m-0">Leave Requests</h3>
                <button class="btn btn-outline-primary rounded-pill small" onclick="loadPendingLeaves()">
                    <span class="material-icons align-middle fs-6">refresh</span> Refresh
                </button>
            </div>
            <div class="list-group shadow-sm rounded-4 overflow-hidden" id="leave-requests-list">
                <div class="list-group-item p-4 text-center text-muted">Loading requests...</div>
            </div>
        </div>

        <div id="assignment-review-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold mb-0" data-i18n="asg_review_title">Review Queue</h3>
                <button class="btn btn-outline-primary rounded-pill small" onclick="loadAssignmentReviewQueue()">
                    <span class="material-icons align-middle fs-6">refresh</span> <span
                        data-i18n="btn_refresh">Refresh</span>
                </button>
            </div>
            <div id="assignment-review-list" class="list-group shadow-sm rounded-4 overflow-hidden">
                <div class="list-group-item p-4 text-center text-muted" data-i18n="msg_loading_submissions">Loading
                    submissions...</div>
            </div>
        </div>
        <div id="assignment-marks-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4" data-i18n="marks_entry_title">Marks Entry</h3>
            <div class="card border-0 shadow-sm rounded-4 p-4 mb-4">
                <div class="row g-3 align-items-end">
                    <div class="col-md-8">
                        <label class="form-label fw-medium" data-i18n="marks_select_assignment">Select
                            Assignment</label>
                        <select id="marks-assignment-select" class="form-select">
                            <option value="" data-i18n="msg_loading_assignments">Loading assignments...</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <button id="marks-load-btn" class="btn btn-primary-custom w-100"
                            onclick="loadMarksForSelectedAssignment()">
                            <span data-i18n="marks_load_submissions">Load Submissions</span>
                        </button>
                    </div>
                </div>
            </div>
            <div id="assignment-marks-list" class="list-group shadow-sm rounded-4 overflow-hidden">
                <div class="list-group-item p-4 text-center text-muted" data-i18n="marks_select_prompt">Select an
                    assignment to view submissions.</div>
            </div>
        </div>

        <!-- 4. Online Test -->
        <div id="test-question-bank-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold">Question Bank</h3>
                <!-- Teacher Only Upload Container -->
                <div id="qb-upload-container" class="d-none">
                    <input type="file" id="qb-file-input" class="d-none" accept=".pdf,.doc,.docx"
                        onchange="handleQuestionBankUpload(this)">
                    <button class="btn btn-primary-custom" onclick="document.getElementById('qb-file-input').click()">
                        <span class="material-icons align-middle me-1">cloud_upload</span> Upload Question Bank
                    </button>
                </div>
            </div>

            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white py-3 border-0">
                    <h6 class="fw-bold mb-0">Available Question Banks</h6>
                </div>
                <div class="card-body p-0">
                    <div id="question-bank-list" class="list-group list-group-flush">
                        <div class="text-center py-5">
                            <div class="spinner-border text-primary"></div>
                            <p class="text-muted mt-2">Loading Question Banks...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="test-create-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Create Online Test</h3>
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="card border-0 shadow-lg rounded-4 p-5 text-center">
                        <span class="material-icons text-info fs-1 mb-3">quiz</span>
                        <h4 class="fw-bold">Test Builder Wizard</h4>
                        <p class="text-muted">Create timed quizzes, exams, and practice tests.</p>
                        <button class="btn btn-info text-white rounded-pill px-5 fw-bold">Start Wizard</button>
                    </div>
                </div>
            </div>
        </div>


        <div id="test-results-view" class="view container-fluid p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold"><span
                        class="material-icons align-middle me-2 fs-3 text-primary-custom">analytics</span> Quiz Results
                    Analysis</h3>
                <button class="btn btn-outline-primary" onclick="loadTeacherQuizzes()"><span
                        class="material-icons">refresh</span></button>
            </div>

            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white border-bottom-0 py-3">
                    <h6 class="fw-bold mb-0">All Assigned Quizzes</h6>
                </div>
                <div class="card-body p-0">
                    <div id="teacher-quiz-list" class="list-group list-group-flush">
                        <!-- Dynamic Content -->
                        <div class="text-center py-5">
                            <div class="spinner-border text-primary"></div>
                            <p class="text-muted mt-2">Loading Quizzes...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. Progress Card -->
        <div id="progress-enter-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Enter Progress Marks</h3>
            <div class="card border-0 shadow-sm rounded-4 p-4">
                <div class="row g-3">
                    <div class="col-md-4"><select class="form-select">
                            <option>Select Class</option>
                        </select></div>
                    <div class="col-md-4"><select class="form-select">
                            <option>Select Exam</option>
                        </select></div>
                    <div class="col-md-4"><button class="btn btn-primary-custom w-100">Load Roster</button></div>
                </div>
            </div>
        </div>

        <div id="progress-publish-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Publish Report Cards</h3>
            <div class="alert alert-warning d-flex align-items-center shadow-sm border-0">
                <span class="material-icons me-2">warning</span> Warning: Once published, report cards are visible to
                parents.
            </div>
            <div class="card border-0 shadow-sm rounded-4 p-4">
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label fw-medium">Class (Grade)</label>
                        <select id="publish-grade-select" class="form-select">
                            <option value="">Select Class</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-medium">Section</label>
                        <select id="publish-section-select" class="form-select">
                            <option value="">Select Section (optional)</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-medium">Exam</label>
                        <select id="publish-exam-select" class="form-select">
                            <option value="">Select Exam</option>
                            <option value="Unit Test">Unit Test</option>
                            <option value="Midterm">Midterm</option>
                            <option value="Final">Final</option>
                            <option value="Weekly Test">Weekly Test</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-medium">Subject</label>
                        <input id="publish-subject-input" class="form-control" placeholder="e.g., Mathematics">
                    </div>
                    <div class="col-md-3 d-flex align-items-end">
                        <button id="publish-marks-btn" class="btn btn-success w-100 fw-bold">Publish Marks</button>
                    </div>
                    <div class="col-md-3 d-flex align-items-end">
                        <button id="publish-preview-btn" class="btn btn-outline-primary w-100">Preview Count</button>
                    </div>
                </div>
                <div id="publish-status" class="mt-3 text-muted small"></div>
            </div>
        </div>

        <div id="progress-report-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">View Progress Cards</h3>
            <div class="card border-0 shadow-sm rounded-4 p-4 mb-4">
                <div class="row g-3 align-items-end">
                    <div class="col-md-6">
                        <label class="form-label fw-medium">Student</label>
                        <select id="progress-student-select" class="form-select">
                            <option value="">Select Student</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <button id="progress-load-btn" class="btn btn-primary-custom w-100">Load Progress</button>
                    </div>
                </div>
            </div>
            <div id="progress-card-container" class="card border-0 shadow-sm rounded-4 p-4">
                <div class="text-center text-muted py-5">
                    <span class="material-icons fs-1">analytics</span>
                    <p class="mt-2">Select a student to view progress.</p>
                </div>
            </div>
        </div>

        <!-- 6. Pay Slips -->
        <div id="payroll-view-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4" data-i18n="payslip_title">My Payslips</h3>
            <div class="row g-4 mb-4">
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm rounded-4 p-4 h-100">
                        <div class="text-muted small" data-i18n="payslip_ytd">Year-To-Date</div>
                        <div class="display-6 fw-bold">$42,680</div>
                        <div class="small text-muted" data-i18n="payslip_net_pay_label">Net Pay</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm rounded-4 p-4 h-100">
                        <div class="text-muted small" data-i18n="payslip_latest">Latest Pay Period</div>
                        <div class="display-6 fw-bold">$4,120</div>
                        <div class="small text-muted" data-i18n="payslip_latest_sub">Net Pay  Sep 2024</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm rounded-4 p-4 h-100">
                        <div class="text-muted small" data-i18n="payslip_payment_method">Payment Method</div>
                        <div class="fw-bold">Bank Transfer</div>
                        <div class="small text-muted" data-i18n="payslip_account_masked">Account  2391</div>
                    </div>
                </div>
            </div>

            <div class="card border-0 shadow-sm rounded-4 p-4 mb-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="fw-bold mb-0" data-i18n="payslip_recent">Recent Payslips</h5>
                    <button class="btn btn-sm btn-outline-primary rounded-pill"
                        data-i18n="payslip_download_all">Download All</button>
                </div>

                <div class="list-group list-group-flush">
                    <div class="list-group-item py-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <div class="fw-bold">September 2024</div>
                                <div class="small text-muted" data-i18n="payslip_processed_paid">Processed: Oct 01, 2024
                                     Status: Paid</div>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">$4,120</div>
                                <div class="small text-muted" data-i18n="payslip_net_pay_label">Net Pay</div>
                            </div>
                            <button class="btn btn-sm btn-outline-dark rounded-pill"
                                data-i18n="payslip_view_details">View Details</button>
                        </div>
                        <div class="row mt-3 g-3 small text-muted">
                            <div class="col-md-4" data-i18n="payslip_gross">Gross: $5,000</div>
                            <div class="col-md-4" data-i18n="payslip_deductions">Deductions: $880</div>
                            <div class="col-md-4" data-i18n="payslip_taxes">Taxes: $620</div>
                        </div>
                    </div>
                    <div class="list-group-item py-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <div class="fw-bold">August 2024</div>
                                <div class="small text-muted" data-i18n="payslip_processed_paid">Processed: Sep 01, 2024
                                     Status: Paid</div>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">$4,050</div>
                                <div class="small text-muted" data-i18n="payslip_net_pay_label">Net Pay</div>
                            </div>
                            <button class="btn btn-sm btn-outline-dark rounded-pill"
                                data-i18n="payslip_view_details">View Details</button>
                        </div>
                        <div class="row mt-3 g-3 small text-muted">
                            <div class="col-md-4" data-i18n="payslip_gross">Gross: $5,000</div>
                            <div class="col-md-4" data-i18n="payslip_deductions">Deductions: $900</div>
                            <div class="col-md-4" data-i18n="payslip_taxes">Taxes: $600</div>
                        </div>
                    </div>
                    <div class="list-group-item py-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <div class="fw-bold">July 2024</div>
                                <div class="small text-muted" data-i18n="payslip_processed_paid">Processed: Aug 01, 2024
                                     Status: Paid</div>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">$4,090</div>
                                <div class="small text-muted" data-i18n="payslip_net_pay_label">Net Pay</div>
                            </div>
                            <button class="btn btn-sm btn-outline-dark rounded-pill"
                                data-i18n="payslip_view_details">View Details</button>
                        </div>
                        <div class="row mt-3 g-3 small text-muted">
                            <div class="col-md-4" data-i18n="payslip_gross">Gross: $5,000</div>
                            <div class="col-md-4" data-i18n="payslip_deductions">Deductions: $860</div>
                            <div class="col-md-4" data-i18n="payslip_taxes">Taxes: $650</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="payroll-print-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4" data-i18n="payslip_print_title">Print Payslips</h3>
            <div class="row g-4">
                <div class="col-lg-5">
                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <h6 class="fw-bold mb-3" data-i18n="payslip_generate_pdf">Generate Payslip PDF</h6>
                        <div class="mb-3">
                            <label class="form-label" data-i18n="payslip_pay_period">Pay Period</label>
                            <select class="form-select">
                                <option>September 2024</option>
                                <option>August 2024</option>
                                <option>July 2024</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label" data-i18n="payslip_delivery">Delivery</label>
                            <select class="form-select">
                                <option data-i18n="payslip_download_pdf">Download PDF</option>
                                <option data-i18n="payslip_email_me">Email to me</option>
                            </select>
                        </div>
                        <button class="btn btn-primary-custom w-100 rounded-pill" data-i18n="payslip_generate_btn">
                            <span class="material-icons align-middle small me-1">picture_as_pdf</span>
                            Generate PDF
                        </button>
                    </div>
                </div>
                <div class="col-lg-7">
                    <div class="card border-0 shadow-sm rounded-4 p-4 h-100">
                        <h6 class="fw-bold mb-3" data-i18n="payslip_preview">Payslip Preview</h6>
                        <div class="d-flex justify-content-between mb-3">
                            <div>
                                <div class="fw-bold">Teacher Admin</div>
                                <div class="small text-muted" data-i18n="payslip_employee_id">Employee ID: T-1024</div>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">September 2024</div>
                                <div class="small text-muted" data-i18n="payslip_processed_date">Processed: Oct 01, 2024
                                </div>
                            </div>
                        </div>
                        <div class="row g-3 small">
                            <div class="col-md-6">
                                <div class="fw-bold mb-2" data-i18n="payslip_earnings">Earnings</div>
                                <div class="d-flex justify-content-between"><span data-i18n="payslip_base_salary">Base
                                        Salary</span><span>$4,500</span></div>
                                <div class="d-flex justify-content-between"><span
                                        data-i18n="payslip_allowance">Allowance</span><span>$500</span></div>
                            </div>
                            <div class="col-md-6">
                                <div class="fw-bold mb-2" data-i18n="payslip_deduction_label">Deductions</div>
                                <div class="d-flex justify-content-between"><span
                                        data-i18n="payslip_tax">Tax</span><span>$620</span></div>
                                <div class="d-flex justify-content-between"><span
                                        data-i18n="payslip_insurance">Insurance</span><span>$260</span></div>
                            </div>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between fw-bold">
                            <span data-i18n="payslip_net_pay_label">Net Pay</span>
                            <span>$4,120</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="payroll-advance-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4" data-i18n="pay_advance_title">Apply for Pay Advance</h3>
            <div class="row g-4">
                <div class="col-lg-6">
                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <form>
                            <div class="mb-3">
                                <label class="form-label" data-i18n="pay_advance_amount">Amount Required</label>
                                <input type="number" class="form-control" placeholder="0.00">
                            </div>
                            <div class="mb-3">
                                <label class="form-label" data-i18n="pay_advance_reason">Reason</label>
                                <textarea class="form-control" rows="3"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" data-i18n="pay_advance_repayment">Preferred Repayment</label>
                                <select class="form-select">
                                    <option data-i18n="pay_advance_next_period">Next Pay Period</option>
                                    <option data-i18n="pay_advance_two_periods">Two Pay Periods</option>
                                </select>
                            </div>
                            <button class="btn btn-primary-custom w-100 rounded-pill"
                                data-i18n="pay_advance_submit">Submit Request</button>
                        </form>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <h6 class="fw-bold mb-3" data-i18n="pay_advance_recent">Recent Requests</h6>
                        <div class="list-group list-group-flush">
                            <div class="list-group-item d-flex justify-content-between align-items-center py-3">
                                <div>
                                    <div class="fw-bold">$800 <span data-i18n="pay_advance_label">Advance</span></div>
                                    <div class="small text-muted" data-i18n="pay_advance_submitted">Submitted: Aug 12,
                                        2024</div>
                                </div>
                                <span class="badge bg-warning text-dark rounded-pill"
                                    data-i18n="pay_advance_pending">Pending</span>
                            </div>
                            <div class="list-group-item d-flex justify-content-between align-items-center py-3">
                                <div>
                                    <div class="fw-bold">$500 <span data-i18n="pay_advance_label">Advance</span></div>
                                    <div class="small text-muted" data-i18n="pay_advance_submitted">Submitted: Jun 10,
                                        2024</div>
                                </div>
                                <span class="badge bg-success rounded-pill"
                                    data-i18n="pay_advance_approved">Approved</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 7. Email -->
        <div id="email-inbox-view" class="view container-fluid p-4">
            <div class="row">
                <div class="col-md-3">
                    <button class="btn btn-primary-custom w-100 rounded-pill mb-3 fw-bold"
                        onclick="switchView('email-compose-view')">Compose</button>
                    <div class="list-group shadow-sm rounded-4 overflow-hidden">
                        <a href="#" class="list-group-item list-group-item-action active fw-bold"
                            onclick="switchView('email-inbox-view'); return false;">Inbox <span
                                class="badge bg-white text-primary float-end rounded-pill"
                                id="email-inbox-count">0</span></a>
                        <a href="#" class="list-group-item list-group-item-action"
                            onclick="switchView('email-sent-view'); return false;">Sent</a>
                        <a href="#" class="list-group-item list-group-item-action"
                            onclick="alert('Drafts feature coming soon.'); return false;">Drafts</a>
                        <a href="#" class="list-group-item list-group-item-action"
                            onclick="alert('Trash feature coming soon.'); return false;">Trash</a>
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="card border-0 shadow-sm rounded-4">
                        <div class="card-header bg-white border-bottom p-3">
                            <h5 class="mb-0 fw-bold">Inbox</h5>
                        </div>
                        <div class="list-group list-group-flush" id="email-inbox-list">
                            <div class="p-4 text-center text-muted">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="email-compose-view" class="view container-fluid p-4">
            <button class="btn btn-light mb-3" onclick="switchView('email-inbox-view')">Back to Inbox</button>
            <div class="card border-0 shadow-sm rounded-4 p-4">
                <h4 class="fw-bold mb-4">New Message</h4>
                <form id="email-compose-form">
                    <div class="mb-3"><input type="text" class="form-control" id="email-to"
                            placeholder="To: (user id, email, grade:10, section:3, role:Teacher, all)"></div>
                    <div class="mb-3"><input type="text" class="form-control" id="email-subject" placeholder="Subject:">
                    </div>
                    <div class="mb-3"><textarea class="form-control" rows="10" id="email-body"
                            placeholder="Type your message..."></textarea></div>
                    <button class="btn btn-primary-custom px-5 rounded-pill fw-bold" id="email-send-btn"
                        type="submit">Send</button>
                </form>
            </div>
        </div>

        <div id="email-sent-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Sent Mail</h3>
            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white border-bottom p-3">
                    <h5 class="mb-0 fw-bold">Sent</h5>
                </div>
                <div class="list-group list-group-flush" id="email-sent-list">
                    <div class="p-4 text-center text-muted">Loading...</div>
                </div>
            </div>
        </div>

        <!-- 8. Messages -->
        <div id="messages-view-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Internal Messages</h3>
            <div class="row">
                <div class="col-md-4 border-end">
                    <!-- Contact List -->
                    <div class="input-group mb-3">
                        <span class="input-group-text bg-white border-end-0"><i
                                class="material-icons fs-6">search</i></span>
                        <input type="text" class="form-control border-start-0" placeholder="Search people">
                    </div>
                    <ul class="list-unstyled">
                        <li class="p-2 bg-light rounded-3 mb-2 d-flex gap-2 align-items-center cursor-pointer">
                            <div class="bg-primary rounded-circle text-white d-flex align-items-center justify-content-center"
                                style="width:40px; height:40px">AD</div>
                            <div>
                                <p class="mb-0 fw-bold small">Admin Desk</p>
                                <p class="mb-0 text-muted small" style="font-size: 10px;">Ok, approved.</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="col-md-8 pt-5 text-center text-muted">
                    <span class="material-icons fs-1 mb-2">chat</span>
                    <p>Select a conversation to start messaging.</p>
                </div>
            </div>
        </div>

        <div id="notifications-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Notifications</h3>
            <div class="list-group shadow-sm rounded-4">
                <div class="list-group-item p-3 border-start border-5 border-primary">
                    <div class="d-flex w-100 justify-content-between">
                        <h6 class="mb-1 fw-bold">New Policy Update</h6>
                        <small>Just now</small>
                    </div>
                    <p class="mb-1 small">Please review the updated leave policy in the HR handbook.</p>
                </div>
                <div class="list-group-item p-3 border-start border-5 border-success">
                    <div class="d-flex w-100 justify-content-between">
                        <h6 class="mb-1 fw-bold">System Maintenance</h6>
                        <small>2 days ago</small>
                    </div>
                    <p class="mb-1 small">System will be down for maintenance on Sunday 2 AM.</p>
                </div>
            </div>
        </div>

        <!-- 9. Profile -->
        <div id="profile-password-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Security Settings</h3>
            <div class="card border-0 shadow-sm rounded-4 p-4" style="max-width: 500px;">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Current Password</label>
                        <input type="password" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">New Password</label>
                        <input type="password" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Confirm New Password</label>
                        <input type="password" class="form-control">
                    </div>
                    <button class="btn btn-dark w-100 rounded-pill fw-bold">Update Password</button>
                </form>
            </div>
        </div>

        <!-- Role Management View (RBAC) -->
        <div id="role-management-view" class="view">
            <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <span class="material-icons text-primary-custom fs-2">admin_panel_settings</span> Role Management (RBAC)
            </h2>
            <div class="row g-4">
                <!-- Roles List -->
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-header bg-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 fw-bold">Roles</h5>
                            <button class="btn btn-sm btn-primary-custom" onclick="openRoleModal()">+ New</button>
                        </div>
                        <div class="list-group list-group-flush" id="rbac-roles-list">
                            <!-- Dynamic Content -->
                            <div class="text-center p-4">
                                <div class="spinner-border text-primary" role="status"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Permissions / Details -->
                <div class="col-md-8">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="mb-0 fw-bold" id="rbac-role-detail-title">Select a Role</h5>
                        </div>
                        <div class="card-body" id="rbac-role-detail-body">
                            <div class="text-center text-muted py-5">
                                <span class="material-icons opacity-25" style="font-size: 64px;">touch_app</span>
                                <p>Click on a role to view permissions and details.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Quiz Generator View -->
        <div id="ai-quiz-view" class="view">
            <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                <h2 class="fw-bold m-0 d-flex align-items-center gap-2">
                    <span class="material-icons text-warning fs-2">psychology</span>
                    <span data-i18n="modal_ai_quiz">AI Quiz Generator</span>
                </h2>
                <button class="btn btn-outline-secondary d-flex align-items-center gap-2 fw-bold"
                    onclick="switchView('teacher-view')">
                    <span class="material-icons">arrow_back</span> Back to Dashboard
                </button>
            </div>
            <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                    <div id="generate-quiz-form-container">
                        <div class="row g-3">
                            <div class="col-md-5">
                                <label class="form-label fw-bold" data-i18n="label_topic">Topic</label>
                                <input type="text" class="form-control" id="quiz-topic" data-i18n-placeholder="ph_topic"
                                    placeholder="e.g. Photosynthesis">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label fw-bold" data-i18n="label_questions_count">Questions</label>
                                <input type="number" class="form-control" id="quiz-count" value="5" min="1" max="10">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label fw-bold">Difficulty</label>
                                <select class="form-select" id="quiz-difficulty">
                                    <option value="Easy">Easy</option>
                                    <option value="Medium" selected>Medium</option>
                                    <option value="Hard">Hard</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-bold">Type</label>
                                <select class="form-select" id="quiz-type">
                                    <option value="Multiple Choice">Multiple Choice</option>
                                    <option value="True/False">True/False</option>
                                    <option value="Short Answer">Short Answer</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold">Additional Context / Description</label>
                                <textarea id="quiz-description" class="form-control" rows="2"
                                    placeholder="e.g. Focus on European countries, emphasize dates..."></textarea>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold">Upload PDF Context (Optional)</label>
                                <input type="file" class="form-control" id="quiz-pdf" accept=".pdf">
                            </div>
                            <div class="col-12 mt-4">
                                <button type="button" class="btn btn-warning w-100 fw-bold shadow-sm"
                                    onclick="handleGenerateQuiz(event)">
                                     Generate Quiz
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="quiz-result-container" class="mt-4 d-none">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="fw-bold text-muted text-uppercase small mb-0">Preview</h6>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="toggle-quiz-answers"
                                    onchange="toggleQuizAnswers()">
                                <label class="form-check-label small" for="toggle-quiz-answers">Show Answers</label>
                            </div>
                        </div>

                        <div id="quiz-preview-content" class="bg-light p-3 rounded border mb-3"
                            style="max-height: 300px; overflow-y: auto;">
                        </div>

                        <div id="quiz-save-area" class="border-top pt-3">
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <label class="form-label fw-bold">Time Limit (Min)</label>
                                    <input type="number" id="quiz-time-limit" class="form-control" value="0" min="0"
                                        placeholder="0 = No Limit">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label fw-bold">Assign To</label>
                                    <select id="quiz-target-type" class="form-select"
                                        onchange="updateQuizTargetOptions()">
                                        <option value="group">Course / Group</option>
                                        <option value="grade">Grade Level (All Sections)</option>
                                        <option value="section">Specific Section</option>
                                        <option value="student">Specific Student</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Select Target</label>
                                    <select id="save-quiz-target-select" class="form-select">
                                    </select>
                                </div>
                                <div class="col-12 mt-2">
                                    <div
                                        class="form-check p-3 bg-white border rounded border-warning border-opacity-25 bg-warning bg-opacity-10">
                                        <input class="form-check-input" type="checkbox" id="quiz-acknowledge-cb">
                                        <label class="form-check-label small fw-bold text-dark"
                                            for="quiz-acknowledge-cb">
                                            I acknowledge that I have reviewed each question and it is aligned with the
                                            curriculum for this Grade.
                                        </label>
                                    </div>
                                </div>
                                <div class="col-12 text-end">
                                    <button class="btn btn-success fw-bold w-100" onclick="saveGeneratedQuiz()">
                                        <span class="material-icons align-middle fs-6 me-1">save</span> Save & Assign
                                        Quiz
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Lesson Planner View -->
        <div id="lesson-planner-view" class="view">
            <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                <h2 class="fw-bold m-0 d-flex align-items-center gap-2">
                    <span class="material-icons text-info fs-2">sticky_note_2</span>
                    <span data-i18n="modal_lesson_planner"> AI Lesson Planner</span>
                </h2>
                <button class="btn btn-outline-secondary d-flex align-items-center gap-2 fw-bold"
                    onclick="switchView('teacher-view')">
                    <span class="material-icons">arrow_back</span> Back to Dashboard
                </button>
            </div>
            <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label" data-i18n="label_topic">Topic</label>
                            <input type="text" id="lp-topic" class="form-control" data-i18n-placeholder="ph_topic"
                                placeholder="e.g. Photosynthesis">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" data-i18n="label_grade">Grade</label>
                            <input type="number" id="lp-grade" class="form-control" value="9">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" data-i18n="label_subject">Subject</label>
                            <select id="lp-subject" class="form-select">
                                <option>Science</option>
                                <option>Maths</option>
                                <option>English</option>
                                <option>Social</option>
                                <option>Other</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <label class="form-label" data-i18n="label_duration">Duration (Minutes)</label>
                            <input type="range" class="form-range" id="lp-duration" min="15" max="120" step="5"
                                value="30"
                                oninput="document.getElementById('duration-val').innerText = this.value + ' mins'">
                            <div class="text-center fw-bold text-primary-custom" id="duration-val">30 mins</div>
                        </div>
                        <div class="col-12">
                            <label class="form-label" data-i18n="label_instructions">Additional Instructions /
                                Context</label>
                            <textarea id="lp-description" class="form-control" rows="3"
                                data-i18n-placeholder="ph_instructions"
                                placeholder="e.g. Focus on vocabulary, include a group activity..."></textarea>
                        </div>
                        <div class="col-12">
                            <label class="form-label" data-i18n="label_upload_pdf">Upload PDF Context
                                (Optional)</label>
                            <input type="file" class="form-control" id="lp-pdf" accept=".pdf">
                        </div>
                    </div>

                    <div id="lp-loading" class="text-center mt-4 d-none">
                        <div class="spinner-border text-primary" role="status"></div>
                        <p class="mt-2 text-muted">Thinking...</p>
                    </div>
                    <div id="lp-result" class="mt-4 p-3 bg-light rounded border d-none"
                        style="white-space: pre-wrap; font-family: sans-serif;"></div>

                    <div class="d-grid mt-4">
                        <button type="button" class="btn btn-primary-custom fw-bold" onclick="generateLessonPlan()">
                            <span class="material-icons align-middle fs-6 me-1">auto_awesome</span> Generate Plan
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->

    <!-- Add Student Modal -->
    <div class="view full-page-view" id="addStudentModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header border-bottom-0">
                    <h5 class="modal-title fw-bold text-primary-custom" data-i18n="modal_add_student"> Add New Student
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body px-5 pb-5">
                    <p id="add-student-message" class="text-primary fw-medium"></p>
                    <form id="add-student-form" class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label fw-bold" data-i18n="label_student_id">Student ID</label>
                            <input type="text" class="form-control" id="new-id" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold" data-i18n="label_full_name">Full Name</label>
                            <input type="text" class="form-control" id="new-name" required>
                        </div>
                        <div class="col-md-12">
                            <label class="form-label fw-bold" data-i18n="label_default_password">Default
                                Password</label>
                            <input type="text" class="form-control" id="new-password" value="123" required>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold" data-i18n="label_grade">Grade</label>
                            <input type="number" class="form-control" id="new-grade" min="1" max="12" value="9"
                                required>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Preferred Subject</label>
                            <select class="form-select" id="new-subject" required>
                                <option value="Science">Science</option>
                                <option value="Maths">Maths</option>
                                <option value="Social">Social</option>
                                <option value="English">English</option>
                                <option value="Tamil">Tamil</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Home Language</label>
                            <input type="text" class="form-control" id="new-lang" value="English" required>
                        </div>
                        <div class="col-md-12">
                            <label class="form-label fw-bold">Attendance Rate (%)</label>
                            <input type="number" class="form-control" id="new-attendance" min="0" max="100" step="0.1"
                                value="90.0" required>
                        </div>

                        <div class="col-12 mt-4">
                            <h6 class="border-bottom pb-2">Initial Assessment Scores (%)</h6>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Math Score</label>
                            <input type="number" class="form-control" id="new-math-score" min="0" max="100" step="0.1"
                                value="75.0" required>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Science Score</label>
                            <input type="number" class="form-control" id="new-science-score" min="0" max="100"
                                step="0.1" value="75.0" required>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">English Score</label>
                            <input type="number" class="form-control" id="new-english-score" min="0" max="100"
                                step="0.1" value="75.0" required>
                        </div>

                        <div class="col-12 mt-4">
                            <button type="submit" class="btn btn-primary-custom w-100 py-2">Add Student to
                                Roster</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>


        <!-- Moodle LMS Integration View -->
        <!-- ============================================== -->
        <!-- LMS: COURSE CATALOG VIEW (Student/Teacher)     -->
        <!-- ============================================== -->
        <div id="lms-catalog-view" class="view p-4">
            <!-- Hero Header -->
            <div class="row mb-5">
                <div class="col-12 px-0 px-md-3">
                    <div class="card border-0 shadow-sm overflow-hidden"
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 1rem;">
                        <div class="card-body p-4 p-md-5 position-relative">
                            <div class="row align-items-center position-relative" style="z-index: 2;">
                                <div class="col-md-9 px-4">
                                    <h2 class="display-6 fw-bold mb-2">ClassBridge Academy</h2>
                                    <p class="lead mb-0 opacity-75">Explore top-tier courses, track your progress, and
                                        master new skills.</p>
                                </div>
                                <div class="col-md-3 text-end d-none d-lg-block">
                                    <span class="material-icons" style="font-size: 6rem; opacity: 0.3;">school</span>
                                </div>
                            </div>
                            <!-- Abstract shapes -->
                            <div class="position-absolute top-0 end-0 p-3" style="opacity: 0.1;">
                                <span class="material-icons" style="font-size: 10rem;">auto_stories</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Toolbar & Filters -->
            <div class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-3">
                <div class="d-flex align-items-center gap-3 flex-grow-1" style="max-width: 600px;">
                    <div class="input-group shadow-sm rounded-pill overflow-hidden bg-white border">
                        <span class="input-group-text bg-white border-0 ps-3"><i
                                class="material-icons text-muted">search</i></span>
                        <input type="text" id="lms-search" class="form-control border-0 shadow-none ps-0"
                            placeholder="Search for courses..." onkeyup="loadLMSCatalog()">
                    </div>
                    <select id="lms-category-filter" class="form-select border-0 shadow-sm rounded-pill"
                        style="max-width: 180px;" onchange="loadLMSCatalog()">
                        <option value="All">All Categories</option>
                        <option value="Science">Science</option>
                        <option value="Math">Math</option>
                        <option value="History">History</option>
                        <option value="Computer Science">Computer Science</option>
                    </select>
                </div>

                <div id="lms-catalog-actions">
                    <!-- Teacher 'Create Course' button injected here if needed, or keeping it as a card -->
                </div>
            </div>

            <!-- Course Grid -->
            <div id="lms-course-grid" class="row g-4">
                <!-- Courses Injected Here -->
                <div class="text-center p-5">
                    <div class="spinner-border text-primary"></div>
                </div>
            </div>
        </div>

        <!-- ============================================== -->
        <!-- LMS: COURSE PLAYER VIEW (Deep Integration)     -->
        <!-- ============================================== -->
        <div id="lms-player-view" class="view container-fluid p-0"
            style="height: calc(100vh - 80px); overflow: hidden;">
            <div class="d-flex h-100">
                <!-- Sidebar Navigation -->
                <div class="bg-white border-end h-100 d-flex flex-column" style="width: 320px; flex-shrink: 0;">
                    <div class="p-3 border-bottom d-flex align-items-center justify-content-between bg-light">
                        <button class="btn btn-sm btn-link text-dark p-0" onclick="switchView('lms-catalog-view')">
                            <i class="material-icons align-middle">arrow_back</i> Return
                        </button>
                        <span class="badge bg-primary rounded-pill small">Player</span>
                    </div>
                    <div class="p-3 border-bottom">
                        <h6 class="fw-bold mb-1" id="lms-player-title">Course Title</h6>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-success" id="lms-course-progress" style="width: 0%"></div>
                        </div>
                        <small class="text-muted" id="lms-course-progress-text">0% Complete</small>
                    </div>

                    <!-- Modules Accordion -->
                    <div class="flex-grow-1 overflow-auto p-2" id="lms-player-nav">
                        <!-- Sections & Modules injected here -->
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="flex-grow-1 h-100 bg-light d-flex flex-column position-relative">
                    <div class="flex-grow-1 overflow-hidden position-relative d-flex align-items-center justify-content-center"
                        id="lms-content-area">
                        <div class="text-center text-muted">
                            <span class="material-icons" style="font-size: 64px; opacity: 0.3;">school</span>
                            <p>Select a module to start learning</p>
                        </div>
                    </div>

                    <!-- Navigation Controls -->
                    <div class="p-3 bg-white border-top d-flex justify-content-between align-items-center">
                        <button class="btn btn-outline-secondary d-flex align-items-center" id="lms-prev-btn" disabled
                            onclick="navLMSModule(-1)">
                            <span class="material-icons me-1">chevron_left</span> Previous
                        </button>
                        <button class="btn btn-success d-flex align-items-center" id="lms-next-btn" disabled
                            onclick="handleLMSCompletion()">
                            Mark Complete & Next <span class="material-icons ms-1">chevron_right</span>
                        </button>
                    </div>

                    <!-- Floating AI Chat Button -->
                    <div class="position-absolute bottom-0 end-0 m-4" style="z-index: 1050;">
                        <button
                            class="btn btn-primary rounded-circle shadow-lg d-flex align-items-center justify-content-center"
                            style="width: 60px; height: 60px;" onclick="toggleLMSChat()">
                            <span class="material-icons fs-2">smart_toy</span>
                        </button>
                    </div>

                    <!-- AI Chat Sidebar (Slide-in) -->
                    <div id="lms-chat-sidebar"
                        class="position-absolute top-0 end-0 h-100 bg-white shadow-lg border-start d-flex flex-column"
                        style="width: 350px; transform: translateX(100%); transition: transform 0.3s ease; z-index: 1040;">
                        <div class="p-3 bg-primary text-white d-flex align-items-center justify-content-between">
                            <h6 class="mb-0 fw-bold"><i class="material-icons align-middle fs-6 me-1">school</i> Course
                                Tutor</h6>
                            <button class="btn btn-sm btn-link text-white p-0" onclick="toggleLMSChat()">
                                <i class="material-icons">close</i>
                            </button>
                        </div>
                        <div class="flex-grow-1 p-3 overflow-auto bg-light" id="lms-chat-history">
                            <div class="text-center text-muted small mt-5">
                                <i class="material-icons fs-1 mb-2">auto_stories</i>
                                <p>Ask me anything about the course content!</p>
                            </div>
                        </div>
                        <div class="p-3 bg-white border-top">
                            <div class="input-group">
                                <input type="text" id="lms-chat-input" class="form-control"
                                    placeholder="Ask a question..." onkeypress="handleLMSChatKey(event)">
                                <button class="btn btn-primary" onclick="sendLMSChat()"><i
                                        class="material-icons">send</i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Access Card Modal (For Printing) -->
    <div class="view full-page-view" id="accessCardModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header bg-dark text-white border-bottom-0">
                    <h5 class="modal-title fw-bold d-flex align-items-center gap-2">
                        <span class="material-icons">badge</span> Student Access Card
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4 text-center bg-light">
                    <div id="access-card-content" class="bg-white p-4 rounded-3 shadow-sm border border-2">
                        <div class="mb-3">
                            <span class="material-icons text-primary-custom" style="font-size: 48px;">school</span>
                        </div>
                        <h4 class="fw-bold m-0" id="card-student-name">Student Name</h4>
                        <p class="text-muted small mb-3">ID: <span id="card-student-id">S000</span></p>

                        <hr>

                        <h6 class="text-uppercase text-secondary fw-bold small mb-3">Pre-generated Lifetime Codes</h6>
                        <div id="card-codes-list" class="d-flex flex-wrap justify-content-center gap-2">
                            <!-- Codes injected here -->
                        </div>

                        <div class="mt-4 alert alert-warning small py-1">
                            <i class="material-icons opacity-50 align-middle" style="font-size:16px">info</i>
                            Keep this card safe. Required for login.
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-top-0 justify-content-center">
                    <button type="button" class="btn btn-outline-danger d-flex align-items-center gap-2 me-auto"
                        onclick="regenerateAccessCode()">
                        <span class="material-icons">refresh</span> Regenerate
                    </button>
                    <button type="button" class="btn btn-outline-dark d-flex align-items-center gap-2"
                        onclick="window.print()">
                        <span class="material-icons">print</span> Print Card
                    </button>
                    <button type="button" class="btn btn-primary-custom" data-bs-dismiss="modal">Done</button>
                </div>
            </div>
        </div>
    </div>



    <!-- LMS Create Course Modal -->
    <div class="view full-page-view" id="lmsCreateCourseModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header border-bottom-0">
                    <h5 class="modal-title fw-bold">Create New Course</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="lms-create-course-form" onsubmit="event.preventDefault(); submitLMSCourse();">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Course Title</label>
                            <input type="text" id="lms-course-title" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Description</label>
                            <textarea id="lms-course-desc" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Category</label>
                            <select id="lms-course-category" class="form-select">
                                <option>General</option>
                                <option>Science</option>
                                <option>Math</option>
                                <option>History</option>
                                <option>Computer Science</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Thumbnail URL</label>
                            <input type="text" id="lms-course-thumb" class="form-control" placeholder="https://...">
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary-custom">Create Course</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- LMS Add Section Modal -->
    <div class="view full-page-view" id="lmsAddSectionModal" tabindex="-1">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header border-bottom-0">
                    <h5 class="modal-title fw-bold">Add Section</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-3">
                    <input type="hidden" id="lms-target-course-id">
                    <label class="form-label">Section Title</label>
                    <input type="text" id="lms-section-title" class="form-control mb-3" required>
                    <button onclick="submitLMSSection()" class="btn btn-primary w-100">Add</button>
                </div>
            </div>
        </div>
    </div>

    <!-- LMS Add Module Modal -->
    <div class="view full-page-view" id="lmsAddModuleModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header border-bottom-0">
                    <h5 class="modal-title fw-bold">Add Module/Resource</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <input type="hidden" id="lms-target-section-id">

                    <div class="mb-3">
                        <label class="form-label">Title</label>
                        <input type="text" id="lms-module-title" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Type</label>
                        <select id="lms-module-type" class="form-select" onchange="toggleLMSModuleFields()">
                            <option value="video">Video (YouTube/URL)</option>
                            <option value="pdf">PDF Document</option>
                            <option value="html">Text / HTML</option>
                            <option value="quiz">Quiz (Simple)</option>
                        </select>
                    </div>

                    <div class="mb-3" id="lms-field-url">
                        <label class="form-label">Content URL</label>
                        <input type="text" id="lms-module-url" class="form-control"
                            placeholder="https://youtube.com/...">
                    </div>

                    <label class="form-label">Content Text</label>
                    <textarea id="lms-module-text" class="form-control" rows="5"></textarea>
                </div>

                <!-- Quiz Builder UI -->
                <div class="mb-3 d-none" id="lms-field-quiz">
                    <label class="form-label d-flex justify-content-between">
                        Quiz Questions
                        <button type="button" class="btn btn-sm btn-outline-primary" onclick="addLMSQuizQuestion()">+
                            Add Question</button>
                    </label>
                    <div id="lms-quiz-builder-container"
                        style="max-height: 300px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 8px;">
                        <!-- Questions added here via JS -->
                    </div>
                </div>

                <button onclick="submitLMSModule()" class="btn btn-primary w-100">Add Module</button>
            </div>
        </div>
    </div>
    </div>
    <!-- Access Card Modal (For Printing) -->
    <div class="view full-page-view" id="accessCardModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header bg-dark text-white border-bottom-0">
                    <h5 class="modal-title fw-bold d-flex align-items-center gap-2">
                        <span class="material-icons">badge</span> Student Access Card
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4 text-center bg-light">
                    <div id="access-card-content" class="bg-white p-4 rounded-3 shadow-sm border border-2">
                        <div class="mb-3">
                            <span class="material-icons text-primary-custom" style="font-size: 48px;">school</span>
                        </div>
                        <h4 class="fw-bold m-0" id="card-student-name">Student Name</h4>
                        <p class="text-muted small mb-3">ID: <span id="card-student-id">S000</span></p>

                        <hr>

                        <h6 class="text-uppercase text-secondary fw-bold small mb-3">Pre-generated One-Time Codes</h6>
                        <div id="card-codes-list" class="d-flex flex-wrap justify-content-center gap-2">
                            <!-- Codes injected here -->
                        </div>

                        <div class="mt-4 alert alert-warning small py-1">
                            <i class="material-icons opacity-50 align-middle" style="font-size:16px">info</i>
                            Keep this card safe. Required for login.
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-top-0 justify-content-center">
                    <button type="button" class="btn btn-outline-danger d-flex align-items-center gap-2 me-auto"
                        onclick="regenerateAccessCode()">
                        <span class="material-icons">refresh</span> Regenerate
                    </button>
                    <button id="btn-email-card" type="button"
                        class="btn btn-outline-primary d-flex align-items-center gap-2" onclick="sendAccessCardEmail()">
                        <span class="material-icons">email</span> Email Me
                    </button>
                    <button type="button" class="btn btn-outline-dark d-flex align-items-center gap-2"
                        onclick="window.print()">
                        <span class="material-icons">print</span> Print Card
                    </button>
                    <button type="button" class="btn btn-primary-custom" data-bs-dismiss="modal">Done</button>
                </div>
            </div>
        </div>
    </div>



    <!-- Edit Student Modal (Revamped) -->
    <div class="view full-page-view" id="editStudentModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">
                <div class="modal-header bg-gradient-primary-to-secondary text-white border-bottom-0 p-4"
                    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <div>
                        <h5 class="modal-title fw-bold d-flex align-items-center gap-2">
                            <span class="material-icons">edit_note</span> Edit Student Profile
                        </h5>
                        <p class="mb-0 small opacity-75">Update student details and performance metrics</p>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        id="close-edit-modal"></button>
                </div>

                <div class="modal-body p-0">
                    <p id="edit-student-message" class="text-center fw-medium p-2 mb-0 bg-light border-bottom d-none">
                    </p>

                    <form id="edit-student-form">
                        <input type="hidden" id="edit-id">

                        <!-- Tabs -->
                        <ul class="nav nav-tabs nav-fill bg-light px-3 pt-3 border-bottom-0" id="editStudentTabs"
                            role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active fw-bold py-3" id="edit-profile-tab" data-bs-toggle="tab"
                                    data-bs-target="#edit-profile" type="button" role="tab" aria-selected="true">
                                    <span class="material-icons align-middle fs-5 me-1">person</span> Profile
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link fw-bold py-3" id="edit-academic-tab" data-bs-toggle="tab"
                                    data-bs-target="#edit-academic" type="button" role="tab" aria-selected="false">
                                    <span class="material-icons align-middle fs-5 me-1">school</span> Academic
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link fw-bold py-3" id="edit-roles-tab" data-bs-toggle="tab"
                                    data-bs-target="#edit-roles" type="button" role="tab" aria-selected="false">
                                    <span class="material-icons align-middle fs-5 me-1">security</span> Roles
                                </button>
                            </li>
                        </ul>

                        <div class="tab-content p-4" id="editStudentTabContent">

                            <div class="tab-pane fade show active" id="edit-profile" role="tabpanel">
                                <div class="alert alert-light border d-flex align-items-center gap-3 mb-4">
                                    <div class="bg-primary-subtle rounded-circle p-3 text-primary">
                                        <span class="material-icons fs-3">badge</span>
                                    </div>
                                    <div>
                                        <small class="text-uppercase text-muted fw-bold">Student ID</small>
                                        <h5 class="mb-0 fw-bold" id="edit-id-display">--</h5>
                                    </div>
                                </div>

                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="edit-name" placeholder="Full Name"
                                        required>
                                    <label for="edit-name">Full Name</label>
                                </div>

                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="edit-password"
                                        placeholder="New Password (Optional)">
                                    <label for="edit-password">New Password (Optional)</label>
                                </div>

                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control" id="edit-lang"
                                                placeholder="Home Language" required>
                                            <label for="edit-lang">Home Language</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="number" class="form-control" id="edit-attendance" min="0"
                                                max="100" step="0.1" required>
                                            <label for="edit-attendance">Attendance (%)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Tab 2: Academic & Scores -->
                            <div class="tab-pane fade" id="edit-academic" role="tabpanel">
                                <div class="row g-3 mb-4">
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold text-muted small text-uppercase">Current
                                            Grade</label>
                                        <div class="input-group">
                                            <span class="input-group-text bg-white"><span
                                                    class="material-icons fs-5 text-muted">grade</span></span>
                                            <input type="number" class="form-control" id="edit-grade" min="1" max="12"
                                                required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold text-muted small text-uppercase">Preferred
                                            Subject</label>
                                        <div class="input-group">
                                            <span class="input-group-text bg-white"><span
                                                    class="material-icons fs-5 text-muted">auto_stories</span></span>
                                            <select class="form-select" id="edit-subject" required>
                                                <option value="Science">Science</option>
                                                <option value="Maths">Maths</option>
                                                <option value="Social">Social</option>
                                                <option value="English">English</option>
                                                <option value="Tamil">Tamil</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <h6 class="fw-bold border-bottom pb-2 mb-3 text-primary-custom">
                                    <span class="material-icons align-middle fs-6 me-1">analytics</span> Initial
                                    Assessment Scores
                                </h6>

                                <div class="mb-3">
                                    <label class="form-label d-flex justify-content-between">
                                        <span>Math Score</span>
                                        <span class="fw-bold text-primary" id="lbl-math">0%</span>
                                    </label>
                                    <input type="range" class="form-range" id="rng-math" min="0" max="100" step="0.5"
                                        oninput="document.getElementById('edit-math-score').value=this.value; document.getElementById('lbl-math').textContent=this.value+'%'">
                                    <input type="number" class="form-control" id="edit-math-score" min="0" max="100"
                                        step="0.1" required
                                        oninput="document.getElementById('rng-math').value=this.value; document.getElementById('lbl-math').textContent=this.value+'%'">
                                </div>

                                <div class="mb-3">
                                    <label class="form-label d-flex justify-content-between">
                                        <span>Science Score</span>
                                        <span class="fw-bold text-primary" id="lbl-science">0%</span>
                                    </label>
                                    <input type="range" class="form-range" id="rng-science" min="0" max="100" step="0.5"
                                        oninput="document.getElementById('edit-science-score').value=this.value; document.getElementById('lbl-science').textContent=this.value+'%'">
                                    <input type="number" class="form-control" id="edit-science-score" min="0" max="100"
                                        step="0.1" required
                                        oninput="document.getElementById('rng-science').value=this.value; document.getElementById('lbl-science').textContent=this.value+'%'">
                                </div>

                                <div class="mb-3">
                                    <label class="form-label d-flex justify-content-between">
                                        <span>English Score</span>
                                        <span class="fw-bold text-primary" id="lbl-english">0%</span>
                                    </label>
                                    <input type="range" class="form-range" id="rng-english" min="0" max="100" step="0.5"
                                        oninput="document.getElementById('edit-english-score').value=this.value; document.getElementById('lbl-english').textContent=this.value+'%'">
                                    <input type="number" class="form-control" id="edit-english-score" min="0" max="100"
                                        step="0.1" required
                                        oninput="document.getElementById('rng-english').value=this.value; document.getElementById('lbl-english').textContent=this.value+'%'">
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer border-top-0 bg-light px-4 py-3">
                            <button type="button" class="btn btn-outline-secondary px-4"
                                data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary-custom px-4 fw-bold"
                                onclick="submitEditStudentForm()">
                                <span class="material-icons align-middle fs-5 me-1">save</span> Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="view full-page-view" id="deleteConfirmationModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title"> Delete Student</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="delete-modal-text" class="fw-bold">Are you sure?</p>
                    <p class="small text-muted mb-0">This action cannot be undone. All student data and activity history
                        will be erased permenantly.</p>
                    <div id="delete-error-msg" class="text-danger mt-2 fw-bold small"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirm-delete-btn">Permanently Delete</button>
                </div>
            </div>
        </div>

        <!-- Take Attendance Modal -->
        <div class="view full-page-view" id="takeAttendanceModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title fw-bold text-primary-custom d-flex align-items-center">
                            <span class="material-icons me-2">event_available</span> Take Student Attendance
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4 bg-light">
                        <!-- Controls -->
                        <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
                            <div class="d-flex gap-2 align-items-center">
                                <select class="form-select w-auto" id="att-target-grade"
                                    onchange="loadAttendanceList()">
                                    <option value="1">Grade 1</option>
                                    <option value="2">Grade 2</option>
                                    <option value="3">Grade 3</option>
                                    <option value="4">Grade 4</option>
                                    <option value="5">Grade 5</option>
                                    <option value="9">Class 9</option>
                                    <option value="10">Class 10</option>
                                    <option value="11">Class 11</option>
                                </select>
                                <input type="date" class="form-control w-auto" id="att-date"
                                    onchange="loadAttendanceList()">
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-danger btn-sm" onclick="bulkSetAttendance('Absent')">Mark
                                    All Absent</button>
                                <button class="btn btn-success btn-sm text-white"
                                    onclick="bulkSetAttendance('Present')">Mark All Present</button>
                                <button class="btn btn-primary-custom px-4" onclick="saveAttendanceRecord()">Save
                                    Record</button>
                            </div>
                        </div>

                        <!-- List -->
                        <div class="card border-0 shadow-sm">
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table align-middle mb-0 table-hover">
                                        <thead class="bg-light">
                                            <tr class="text-uppercase text-muted small fw-bold">
                                                <th class="ps-4">Student Name</th>
                                                <th class="text-center">Status</th>
                                                <th class="pe-4">Remarks</th>
                                            </tr>
                                        </thead>
                                        <tbody id="attendance-list-body">
                                            <!-- Injected JS -->
                                            <tr>
                                                <td colspan="3" class="text-center p-4">Select a class to load students
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="view full-page-view" id="createGroupModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title fw-bold text-primary-custom"> Create New Course</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body px-4 pb-4">
                        <p id="create-group-message" class="text-primary fw-medium"></p>
                        <form id="create-group-form">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Course Name</label>
                                <input type="text" class="form-control" id="group-name" required
                                    placeholder="e.g. Algebra 101">
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Subject</label>
                                <select class="form-select" id="group-subject">
                                    <option value="General">General</option>
                                    <option value="Science">Science</option>
                                    <option value="Maths">Maths</option>
                                    <option value="Social">Social</option>
                                    <option value="English">English</option>
                                    <option value="Tamil">Tamil</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Description</label>
                                <textarea class="form-control" id="group-desc" rows="2"
                                    placeholder="Optional description"></textarea>
                                <div class="form-text text-muted small"><i class="material-icons align-middle"
                                        style="font-size: 14px;">info</i> You can upload videos and PDFs after creating
                                    the
                                    course.</div>
                            </div>
                            <button type="submit" class="btn btn-primary-custom w-100">Create Course</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manage Group Modal (Members & Materials) -->
        <div class="view full-page-view" id="manageMembersModal" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title fw-bold text-primary-custom" id="manage-group-title"> Manage Course
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body px-4 pb-4">
                        <h6 id="manage-group-name" class="fw-bold mb-3 d-none"></h6>
                        <input type="hidden" id="manage-group-id">

                        <!-- Tabs -->
                        <ul class="nav nav-tabs mb-3" id="manageGroupTabs" role="tablist">
                            <li class="nav-item">
                                <button class="nav-link active" id="tab-members-btn" data-bs-toggle="tab"
                                    data-bs-target="#tab-members" type="button">Members</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" id="tab-materials-btn" data-bs-toggle="tab"
                                    data-bs-target="#tab-materials" type="button">Materials & Resources</button>
                            </li>
                        </ul>

                        <div class="tab-content" id="manageGroupTabContent">
                            <!-- Members Tab -->
                            <div class="tab-pane fade show active" id="tab-members" role="tabpanel">
                                <div class="border rounded p-2 mb-3" style="max-height: 250px; overflow-y: auto;">
                                    <div id="group-members-list">Loading...</div>
                                </div>
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-outline-danger" onclick="deleteGroup()">Delete
                                        Course</button>
                                    <button type="button" class="btn btn-primary-custom"
                                        onclick="saveGroupMembers()">Save
                                        Members</button>
                                </div>
                            </div>

                            <!-- Materials Tab -->
                            <div class="tab-pane fade" id="tab-materials" role="tabpanel">
                                <!-- Add Material Form -->
                                <div class="card bg-light border-0 mb-3">
                                    <div class="card-body">
                                        <h6 class="fw-bold mb-2">Post New Material</h6>
                                        <form id="add-material-form" onsubmit="handlePostMaterial(event)">
                                            <div class="row g-2">
                                                <div class="col-md-8">
                                                    <input type="text" class="form-control form-control-sm"
                                                        id="mat-title" placeholder="Title (e.g. Chapter 1 Notes)"
                                                        required>
                                                </div>
                                                <div class="col-md-4">
                                                    <select class="form-select form-select-sm" id="mat-type"
                                                        onchange="toggleMaterialInput()">
                                                        <option value="Note">Note / Text</option>
                                                        <option value="Quiz">Quiz Link</option>
                                                        <option value="Video">Video Link</option>
                                                        <option value="File">File Upload (PDF/Video)</option>
                                                    </select>
                                                </div>
                                                <div class="col-12" id="mat-text-input-group">
                                                    <input type="text" class="form-control form-control-sm"
                                                        id="mat-content" placeholder="Content or URL..." required>
                                                </div>
                                                <div class="col-12 d-none" id="mat-file-input-group">
                                                    <input type="file" class="form-control form-control-sm"
                                                        id="mat-file" accept=".pdf, .mp4, .mov, .jpg, .png">
                                                </div>
                                                <div class="col-12 text-end">
                                                    <button type="submit" class="btn btn-sm btn-primary-custom"
                                                        id="post-material-btn">Post</button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>

                                <!-- Materials List -->
                                <h6 class="fw-bold">Posted Resources</h6>
                                <div id="group-materials-list" class="list-group list-group-flush"
                                    style="max-height: 200px; overflow-y: auto;">
                                    <!-- Items injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Add Activity Modal -->
        <div class="view full-page-view" id="addActivityModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title fw-bold text-primary-custom"> Log New Activity</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                            id="close-activity-modal"></button>
                    </div>
                    <div class="modal-body px-4 pb-4">
                        <p id="add-activity-message" class="text-primary fw-medium"></p>
                        <form id="add-activity-form" class="row g-3">
                            <div class="col-12">
                                <label class="form-label fw-bold">Select Student</label>
                                <select class="form-select" id="activity-student-select" required></select>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold">Date</label>
                                <input type="date" class="form-control" id="activity-date" required>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold">Topic</label>
                                <input type="text" class="form-control" id="activity-topic"
                                    placeholder="e.g., Quadratic Equations" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Difficulty</label>
                                <select class="form-select" id="activity-difficulty" required>
                                    <option value="Easy">Easy</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Hard">Hard</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Score (%)</label>
                                <input type="number" class="form-control" id="activity-score" min="0" max="100"
                                    step="0.1" value="85.0" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Time (min)</label>
                                <input type="number" class="form-control" id="activity-time" min="1" value="30"
                                    required>
                            </div>
                            <div class="col-12 mt-4">
                                <button type="submit" class="btn btn-primary-custom w-100 py-2">Log Activity</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Schedule Class Modal -->
        <div class="view full-page-view" id="scheduleClassModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title fw-bold text-primary-custom" data-i18n="modal_schedule_class"> Schedule
                            Live Class</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                            id="close-schedule-modal"></button>
                    </div>
                    <div class="modal-body px-4 pb-4">
                        <p id="schedule-message" class="text-primary fw-medium"></p>
                        <form id="schedule-class-form" class="row g-3">
                            <div class="col-12">
                                <label class="form-label fw-bold" data-i18n="label_topic">Topic / Subject</label>
                                <input type="text" class="form-control" id="class-topic"
                                    data-i18n-placeholder="ph_topic" placeholder="e.g., Math Doubt Session" required>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold" data-i18n="label_date_time">Date & Time</label>
                                <input type="datetime-local" class="form-control" id="class-date" required>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold" data-i18n="label_target_students">Target
                                    Students</label>

                                <!-- Group Filter -->
                                <div class="input-group mb-2">
                                    <label class="input-group-text bg-white small" data-i18n="label_filter_group">Filter
                                        by Group</label>
                                    <select class="form-select" id="schedule-group-filter"
                                        onchange="applyGroupFilter(this.value)">
                                        <option value="" data-i18n="opt_all_students">-- All Students --</option>
                                        <!-- Options injected via JS -->
                                    </select>
                                </div>

                                <div class="border rounded p-2"
                                    style="max-height: 120px; overflow-y: auto; background: #f8f9fa;">
                                    <div class="form-check mb-2 pb-2 border-bottom">
                                        <input class="form-check-input" type="checkbox" id="select-all-students"
                                            onchange="toggleStudentCheckboxes(this)">
                                        <label class="form-check-label fw-bold" for="select-all-students"
                                            data-i18n="label_select_all">Select
                                            All</label>
                                    </div>
                                    <div id="schedule-student-list">
                                        <!-- Checkboxes -->
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold" data-i18n="label_meet_link">Google Meet Link</label>
                                <input type="url" class="form-control" id="class-link"
                                    data-i18n-placeholder="ph_meet_link_long" placeholder="https://meet.google.com/..."
                                    required>
                                <div class="form-text" data-i18n="help_meet_link">Copy paste a link from <a
                                        href="https://meet.google.com/" target="_blank">Google Meet</a>.</div>
                            </div>
                            <div class="col-12 mt-4">
                                <button type="submit" class="btn text-white w-100 py-2"
                                    style="background-color: #673ab7;" data-i18n="btn_schedule">Schedule Class</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Student Group Content Modal -->
        <div class="view full-page-view" id="studentGroupModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0">
                        <div>
                            <h5 class="modal-title fw-bold text-primary-custom" id="sg-title">Group Name</h5>
                            <p class="mb-0 text-muted small" id="sg-desc">Group Description</p>
                        </div>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body px-4 pb-4">
                        <h6 class="fw-bold border-bottom pb-2 mb-3"> Class Materials & Resources</h6>
                        <div id="student-materials-list" class="list-group list-group-flush">
                            <!-- Materials injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Portal Modal (Revamped) -->
        <div class="view full-page-view" id="aboutPortalModal" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">
                    <!-- Header with Gradient -->
                    <div class="modal-header border-bottom-0 text-white p-5 position-relative"
                        style="background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);">
                        <div class="position-relative z-1">
                            <h2 class="fw-bold mb-2 d-flex align-items-center gap-3">
                                <span class="bg-white text-primary rounded-circle p-2 d-flex"><span
                                        class="material-icons">school</span></span>
                                Class Bridge
                            </h2>
                            <p class="lead mb-0 opacity-75">Empowering the next generation of learners with AI.</p>
                        </div>
                        <!-- Decorative Circle -->
                        <div class="position-absolute top-0 end-0 rounded-circle bg-white opacity-10"
                            style="width: 200px; height: 200px; transform: translate(30%, -30%);"></div>
                        <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-4"
                            data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body p-5">
                        <div class="row g-4">
                            <!-- Feature 1 -->
                            <div class="col-md-4">
                                <div class="p-4 rounded-4 h-100 text-center hover-up transition-all"
                                    style="background: #f3f4f6;">
                                    <div class="mb-3 text-primary">
                                        <span class="material-icons" style="font-size: 48px;">insights</span>
                                    </div>
                                    <h5 class="fw-bold mb-2">Smart Analytics</h5>
                                    <p class="text-muted small mb-0">Deep insights into student performance using
                                        advanced
                                        machine learning models.</p>
                                </div>
                            </div>

                            <!-- Feature 2 -->
                            <div class="col-md-4">
                                <div class="p-4 rounded-4 h-100 text-center hover-up transition-all"
                                    style="background: #f3f4f6;">
                                    <div class="mb-3 text-danger">
                                        <span class="material-icons" style="font-size: 48px;">videocam</span>
                                    </div>
                                    <h5 class="fw-bold mb-2">Live Classrooms</h5>
                                    <p class="text-muted small mb-0">Seamlessly schedule and join Google Meet sessions
                                        directly from the dashboard.</p>
                                </div>
                            </div>

                            <!-- Feature 3 -->
                            <div class="col-md-4">
                                <div class="p-4 rounded-4 h-100 text-center hover-up transition-all"
                                    style="background: #f3f4f6;">
                                    <div class="mb-3 text-success">
                                        <span class="material-icons" style="font-size: 48px;">auto_awesome</span>
                                    </div>
                                    <h5 class="fw-bold mb-2">AI Guidance</h5>
                                    <p class="text-muted small mb-0">Personalized recommendations and study paths
                                        tailored
                                        to each student.</p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-5 text-center border-top pt-4">
                            <p class="text-muted small mb-3">Version 2.0.0  Built for Excellence</p>
                            <button class="btn btn-outline-primary px-4 rounded-pill fw-bold"
                                data-bs-dismiss="modal">Close
                                Overview</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Forgot Password Modal -->
        <div class="view full-page-view" id="forgotPasswordModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title fw-bold text-primary-custom">Reset Password</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body px-5 pb-5">
                        <p class="text-muted small mb-4">Enter your email address and we'll send you a link to reset
                            your
                            password.</p>
                        <form id="forgot-password-form">
                            <div class="form-floating mb-3">
                                <input type="email" class="form-control" id="reset-email" placeholder="Email" required>
                                <label for="reset-email">Email Address</label>
                            </div>
                            <p id="reset-message" class="text-center fw-medium small mb-2"></p>
                            <button type="submit" class="btn btn-primary-custom w-100 py-2">Send Reset Link</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reset Password Modal (New Password Entry) -->
        <div class="view full-page-view" id="resetPasswordModal" tabindex="-1" data-bs-backdrop="static">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header border-bottom-0 bg-primary-custom text-white">
                        <h5 class="modal-title fw-bold"> Set New Password</h5>
                    </div>
                    <div class="modal-body px-5 py-5">
                        <p class="text-center text-muted mb-4">Please enter your new password below.</p>
                        <form id="reset-password-form">
                            <input type="hidden" id="reset-token">
                            <div class="form-floating mb-3">
                                <input type="password" class="form-control" id="new-reset-pass"
                                    placeholder="New Password" required oninput="checkPasswordStrength(this.value)">
                                <label for="new-reset-pass">New Password</label>
                            </div>

                            <p id="new-reset-message" class="text-center fw-medium small mb-2"></p>
                            <button type="submit" class="btn btn-primary-custom w-100 py-2 fw-bold">Update
                                Password</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- Audit Log Modal -->
        <div class="view full-page-view" id="auditLogModal" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content border-0 shadow-lg rounded-4">
                    <div class="modal-header bg-dark text-white">
                        <h5 class="modal-title d-flex align-items-center gap-2">
                            <span class="material-icons text-danger">security</span> Security Audit Logs
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-0">
                        <table class="table table-striped table-hover mb-0 font-monospace small">
                            <thead class="table-light sticky-top">
                                <tr>
                                    <th>Time</th>
                                    <th>User ID</th>
                                    <th>Event</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="audit-log-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Whiteboard Modal -->
        <div class="view full-page-view" id="whiteboardModal" tabindex="-1">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">
                    <div class="modal-header bg-dark text-white p-2">
                        <h5 class="modal-title fs-6"><span class="material-icons align-middle fs-5 me-2">gesture</span>
                            Live
                            Whiteboard</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-0 position-relative"
                        style="background-color: #f0f0f0; overflow: hidden; touch-action: none;">
                        <canvas id="whiteboard-canvas"
                            style="cursor: crosshair; touch-action: none; display: block;"></canvas>

                        <!-- Floating Toolbar -->
                        <div class="position-absolute top-0 start-50 translate-middle-x mt-3 bg-white shadow-sm p-2 rounded-pill d-flex gap-2 align-items-center"
                            style="z-index: 1060;">
                            <input type="color" id="wb-color" class="form-control form-control-color border-0 p-1"
                                value="#000000" title="Color" style="width: 40px; height: 35px;">
                            <input type="range" id="wb-width" class="form-range w-auto" min="1" max="20" value="2"
                                title="Brush Size" style="width: 100px;">
                            <div class="vr mx-1"></div>
                            <button class="btn btn-sm btn-outline-danger d-flex align-items-center gap-1"
                                onclick="clearWhiteboard()">
                                <span class="material-icons fs-6">delete</span> Clear
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

        <script src="./static/grid_plasma.js"></script>
        <script src="./static/shader_background_webgl.js"></script>
        <script src="./static/glowing_cards.js"></script>
        <script src="./static/testimonial_cards.js"></script>
        <script src="./script.js?v=2.5"></script>
        <!-- Create Assignment Modal -->
        <div class="modal fade" id="createAssignmentModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-primary text-white">
                        <h5 class="modal-title fw-bold" data-i18n="asg_modal_title"> New Assignment</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <form id="create-assignment-form">
                            <div class="mb-3">
                                <label class="form-label fw-bold" data-i18n="label_title">Title</label>
                                <input type="text" id="asg-title" class="form-control" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold" data-i18n="label_description">Description</label>
                                <textarea id="asg-desc" class="form-control" rows="3"></textarea>
                            </div>
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <label class="form-label" data-i18n="label_class_grade">Class (Grade)</label>
                                    <select id="asg-grade" class="form-select" required>
                                        <option value="" data-i18n="label_select_grade">Select Grade</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <label class="form-label" data-i18n="label_points">Points</label>
                                    <input type="number" id="asg-points" class="form-control" value="100">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold" data-i18n="label_section">Section</label>
                                <select id="asg-section" class="form-select">
                                    <option value="" data-i18n="label_select_section_optional">Select Section (optional)
                                    </option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold" data-i18n="label_due_date">Due Date</label>
                                <input type="date" id="asg-date" class="form-control" required>
                            </div>
                        </form>
                        <div id="asg-error" class="text-danger small d-none"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="create-assignment-submit-btn"
                            class="btn btn-primary-custom fw-bold w-100" onclick="handleCreateAssignment()"
                            data-i18n="btn_create">Create</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Submit Assignment Modal -->
        <div class="view full-page-view" id="submitAssignmentModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-success text-white">
                        <h5 class="modal-title fw-bold"> Submit Assignment</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <input type="hidden" id="submit-asg-id">
                        <h6 id="submit-asg-title" class="fw-bold mb-3">Assignment Title</h6>
                        <div class="mb-3">
                            <label class="form-label">Your Submission (Text or Link)</label>
                            <textarea id="submit-content" class="form-control" rows="4"
                                placeholder="Type your answer or paste a Google Doc link here..."></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success fw-bold w-100"
                            onclick="handleSubmitAssignment()">Submit</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- View Submissions Modal (Teacher) -->
        <div class="view full-page-view" id="viewSubmissionsModal" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-dark text-white">
                        <h5 class="modal-title fw-bold"> Student Submissions</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-0">
                        <ul id="submissions-list" class="list-group list-group-flush">
                            <!-- Submissions injected here -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- USER MANAGEMENT VIEW -->
        <div id="user-management-view" class="view" style="padding-left: 280px; padding-top: 30px; display: none;">
            <div class="container-fluid px-5">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h1 class="h3 fw-bold text-dark mb-0">User Management</h1>
                    <button class="btn btn-primary-custom" onclick="openAddUserModal()">
                        <span class="material-icons align-middle fs-5 me-1">add</span> Add New User
                    </button>
                </div>

                <!-- Tabs -->
                <ul class="nav nav-pills mb-4" id="pills-tab" role="tablist">
                    <li class="nav-item">
                        <button class="nav-link active fw-bold" id="pills-users-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-users" type="button" onclick="loadUserList()">
                            <span class="material-icons align-middle fs-6 me-1">people</span> All Users
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link fw-bold" id="pills-audit-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-audit" type="button" onclick="showAuditLogs()">
                            <span class="material-icons align-middle fs-6 me-1">history</span> Audit Logs
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="pills-tabContent">
                    <!-- User List Tab -->
                    <div class="tab-pane fade show active" id="pills-users" role="tabpanel">
                        <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover align-middle mb-0" id="users-table">
                                        <thead class="bg-light">
                                            <tr>
                                                <th class="py-3 ps-4">Name</th>
                                                <th class="py-3">Role</th>
                                                <th class="py-3">Email/ID</th>
                                                <th class="py-3">Grade/Subject</th>
                                                <!-- <th class="py-3 text-end pe-4">Actions</th> -->
                                            </tr>
                                        </thead>
                                        <tbody id="users-table-body">
                                            <tr>
                                                <td colspan="5" class="text-center py-5">
                                                    <div class="spinner-border text-primary"></div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Audit Logs Tab -->
                    <div class="tab-pane fade" id="pills-audit" role="tabpanel">
                        <div id="audit-logs-container" class="bg-white p-3 rounded-4 shadow-sm">
                            <p class="text-center text-muted">Loading logs...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ADD USER VIEW -->
        <div id="add-user-view" class="view" style="padding-left: 280px; padding-top: 30px; display: none;">
            <div class="container-fluid px-5">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div class="d-flex align-items-center gap-3">
                        <button class="btn btn-light rounded-circle shadow-sm"
                            onclick="switchView('user-management-view')">
                            <span class="material-icons text-dark">arrow_back</span>
                        </button>
                        <h1 class="h3 fw-bold text-dark mb-0">Create New User</h1>
                    </div>
                </div>

                <div class="card border-0 shadow-sm rounded-4 p-4" style="max-width: 800px; margin: 0 auto;">
                    <form id="add-user-form" onsubmit="handleCreateUser(event)">
                        <div class="form-floating mb-3">
                            <input type="text" id="new-user-name" class="form-control bg-light border-0"
                                placeholder="Full Name" required>
                            <label>Full Name</label>
                        </div>
                        <div class="form-floating mb-3">
                            <input type="text" id="new-user-id" class="form-control bg-light border-0"
                                placeholder="Email or Unique ID" required>
                            <label>Email or Unique ID</label>
                        </div>
                        <div class="form-floating mb-3">
                            <select id="new-user-role" class="form-select bg-light border-0" required
                                onchange="toggleUserFields()">
                                <option value="Student">Student</option>
                                <option value="Teacher">Teacher</option>
                                <option value="Parent_Guardian">Parent / Guardian</option>
                                <option value="Tenant_Admin">Tenant Admin (Principal)</option>
                                <option value="Academic_Admin">Academic Admin</option>
                                <option value="HR_Admin">HR Admin</option>
                                <option value="Root_Super_Admin">Root Super Admin</option>
                            </select>
                            <label>Role</label>
                        </div>
                        <div class="form-floating mb-3">
                            <input type="password" id="new-user-password" class="form-control bg-light border-0"
                                placeholder="Password" required>
                            <label>Password</label>
                            <small class="text-muted">Must be at least 8 chars, incl. number & special char.</small>
                        </div>

                        <!-- Conditional Fields -->
                        <div id="student-fields">
                            <div class="form-floating mb-3">
                                <select id="new-user-grade" class="form-select bg-light border-0">
                                    <option value="9">Grade 9</option>
                                    <option value="10">Grade 10</option>
                                    <option value="11">Grade 11</option>
                                    <option value="12">Grade 12</option>
                                </select>
                                <label>Grade</label>
                            </div>
                        </div>
                        <div id="teacher-fields" style="display:none;">
                            <div class="form-floating mb-3">
                                <input type="text" id="new-user-subject" class="form-control bg-light border-0"
                                    placeholder="Science">
                                <label>Preferred/Teaching Subject</label>
                            </div>
                        </div>

                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <button type="button" class="btn btn-light"
                                onclick="switchView('user-management-view')">Cancel</button>
                            <button type="submit" class="btn btn-primary-custom px-5 rounded-pill fw-bold">Create
                                User</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ADD USER MODAL -->


        <!-- Add Video Modal -->
        <div class="view full-page-view" id="addVideoModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title fw-bold"> Add Course Video</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <form id="add-video-form">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Video Title</label>
                                <input type="text" id="video-title" class="form-control"
                                    placeholder="e.g. Introduction to Algebra" required>
                            </div>
                            <div class="mb-3">
                            </div>
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-danger text-white fw-bold w-100">Add Video</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Announcement Modal -->
        <div class="view full-page-view" id="createAnnouncementModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-primary text-white">
                        <h5 class="modal-title fw-bold"> New Announcement</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <form id="create-announcement-form" onsubmit="handleCreateAnnouncement(event)">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Title</label>
                                <input type="text" id="ann-title" class="form-control" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Content</label>
                                <textarea id="ann-content" class="form-control" rows="4" required></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Target Audience</label>
                                <select id="ann-target" class="form-select">
                                    <option value="All">All Users</option>
                                    <option value="Parent">Parents Only</option>
                                    <option value="Student">Students Only</option>
                                    <option value="Teacher">Staff Only</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary w-100 fw-bold">Post Announcement</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compose Message Modal -->
        <div class="view full-page-view" id="composeMessageModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-success text-white">
                        <h5 class="modal-title fw-bold"> Compose Message</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <form id="compose-message-form" onsubmit="handleSendMessage(event)">
                            <div class="mb-3">
                                <label class="form-label fw-bold">To (User ID)</label>
                                <!-- Simple text input for now, ideally a search/dropdown -->
                                <input type="text" id="msg-receiver" class="form-control" placeholder="Enter User ID"
                                    required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Subject</label>
                                <input type="text" id="msg-subject" class="form-control" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Message</label>
                                <textarea id="msg-content" class="form-control" rows="4" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-success w-100 fw-bold">Send Message</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Event Modal -->
        <div class="view full-page-view" id="addEventModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-info text-white">
                        <h5 class="modal-title fw-bold"> Add Calendar Event</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <form id="add-event-form" onsubmit="handleCreateEvent(event)">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Event Title</label>
                                <input type="text" id="evt-title" class="form-control" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Date</label>
                                <input type="date" id="evt-date" class="form-control" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Type</label>
                                <select id="evt-type" class="form-select">
                                    <option value="Meeting">Meeting</option>
                                    <option value="Exam">Exam</option>
                                    <option value="Holiday">Holiday</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-info text-white w-100 fw-bold">Add Event</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Glassmorphism Scroll Effect
            document.addEventListener('DOMContentLoaded', () => {
                const landingView = document.getElementById('landing-view');
                const navbar = document.getElementById('landing-navbar'); // We added this ID

                if (landingView && navbar) {
                    landingView.addEventListener('scroll', () => {
                        if (landingView.scrollTop > 50) {
                            navbar.classList.add('scrolled-mode');
                        } else {
                            navbar.classList.remove('scrolled-mode');
                        }
                    });
                }
            });
        </script>

        <!-- SIDEBAR CHATBOT COMPONENT (NEW) -->
        <div id="ai-chat-toggle" class="chat-toggle-btn" onclick="toggleSidebarChat()" style="display: none;">
            <span class="material-icons fs-2">smart_toy</span>
        </div>

        <div id="ai-sidebar">
            <!-- Header -->
            <div class="chat-header">
                <div class="d-flex align-items-center gap-3">
                    <div class="bg-primary bg-opacity-10 text-primary rounded-circle d-flex align-items-center justify-content-center"
                        style="width: 40px; height: 40px;">
                        <span class="material-icons">school</span>
                    </div>
                    <div>
                        <h5 class="mb-0 fw-bold text-dark">Education Assistant</h5>
                        <small class="text-muted d-flex align-items-center gap-1">
                            <span class="d-inline-block rounded-circle bg-success"
                                style="width: 8px; height: 8px;"></span>
                            Online
                        </small>
                    </div>
                </div>
                <button class="btn btn-link text-secondary p-0" onclick="toggleSidebarChat()">
                    <span class="material-icons">close</span>
                </button>
            </div>

            <!-- Chat Body -->
            <div id="sidebar-chat-body" class="chat-body">
                <!-- Welcome Message -->
                <div class="chat-message ai">
                    <p>Hello!  I'm your Education & Data Assistant.</p>
                    <p>I can help you with:</p>
                    <ul>
                        <li>Explaining concepts (Photosynthesis, Algebra, etc.)</li>
                        <li>Querying data (Show student scores, attendance, etc.)</li>
                    </ul>
                    <p>How can I help you today?</p>
                </div>
            </div>

            <!-- Input Area -->
            <div class="chat-input-area">
                <div class="d-flex flex-column gap-2">
                    <textarea id="sidebar-chat-input" class="form-control border-0 bg-light" rows="2"
                        placeholder="Ask a question..." style="resize: none; border-radius: 12px; padding: 12px;"
                        onkeydown="handleSidebarEnter(event)"></textarea>

                    <!-- File Preview/Indicator -->
                    <div id="chat-file-preview" class="small text-primary px-2" style="display: none;">
                        <span class="material-icons fs-6 align-middle">description</span>
                        <span id="chat-file-name" class="fw-bold">filename.pdf</span>
                        <span class="material-icons fs-6 align-middle text-danger cursor-pointer"
                            onclick="clearChatFile()">close</span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex gap-2">
                            <!-- Hidden File Input -->
                            <input type="file" id="chat-file-input" style="display: none;"
                                onchange="handleChatFileSelect(this)">

                            <!-- Attachment Icon -->
                            <button class="btn btn-sm btn-link text-muted p-0"
                                onclick="document.getElementById('chat-file-input').click()" title="Attach File">
                                <span class="material-icons">attach_file</span>
                            </button>

                            <button class="btn btn-sm btn-link text-muted p-0"
                                onclick="alert('Voice input coming soon!')">
                                <span class="material-icons">mic</span>
                            </button>
                        </div>
                        <button class="btn btn-primary-custom rounded-pill px-4 fw-bold shadow-sm"
                            onclick="sendSidebarMessage()">
                            Send <span class="material-icons fs-6 align-middle ms-1">send</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Engagement Helper Modal removed -->
        <!-- Teacher AI Co-Pilot Modal -->
        <div class="view full-page-view" id="teacherAICoPilotModal" tabindex="-1" aria-hidden="true"
            style="backdrop-filter: blur(8px);">
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content border-0 shadow-lg overflow-hidden"
                    style="border-radius: 20px; background: #f8f9fa; height: 80vh;">
                    <!-- Header -->
                    <div class="modal-header border-0 p-4"
                        style="background: linear-gradient(135deg, #4D44B5 0%, #302b70 100%); color: white;">
                        <div class="d-flex align-items-center gap-3">
                            <div class="bg-white bg-opacity-20 rounded-circle d-flex align-items-center justify-content-center"
                                style="width: 48px; height: 48px;">
                                <span class="material-icons" style="font-size: 28px;">auto_awesome</span>
                            </div>
                            <div>
                                <h5 class="modal-title fw-bold mb-0">ClassBridge AI Co-Pilot</h5>
                                <div class="small opacity-75">Your Educational Assistant & Data Analyst</div>
                            </div>
                        </div>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>

                    <!-- Chat Body -->
                    <div class="modal-body p-0 d-flex flex-column" style="background: #ffffff; overflow: hidden;">
                        <div id="teacher-ai-chat-history" class="flex-grow-1 p-4 overflow-auto d-flex flex-column gap-3"
                            style="background: #fdfdfd;">
                            <!-- Welcome Message -->
                            <div class="d-flex justify-content-start">
                                <div class="bg-light p-3 rounded-4 shadow-sm"
                                    style="max-width: 85%; border-bottom-left-radius: 4px;">
                                    <div class="fw-bold mb-1 text-primary d-flex align-items-center gap-2">
                                        <span class="material-icons fs-6">smart_toy</span> AI Assistant
                                    </div>
                                    <p class="mb-0 text-dark">Hello! I'm your AI Teacher Co-Pilot. I can help you draft
                                        parent emails, plan lessons, or query school data for you. How can I assist you
                                        today?</p>
                                </div>
                            </div>
                        </div>

                        <!-- Thinking Indicator (Hidden) -->
                        <div id="teacher-ai-typing" class="px-4 py-2 d-none">
                            <div class="d-flex align-items-center gap-2 text-muted small">
                                <div class="spinner-grow spinner-grow-sm text-primary" role="status"></div>
                                <span>AI is thinking...</span>
                            </div>
                        </div>

                        <!-- Input Area -->
                        <div class="p-3 border-top bg-light">
                            <div class="input-group">
                                <input type="text" id="teacher-ai-input" class="form-control border-0 rounded-pill px-4"
                                    placeholder="Ask about students, draft an email, or get lesson ideas..."
                                    style="padding-top: 12px; padding-bottom: 12px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);"
                                    onkeydown="if(event.key === 'Enter') sendTeacherAIMessage()">
                                <button
                                    class="btn btn-primary rounded-circle ms-2 d-flex align-items-center justify-content-center"
                                    onclick="sendTeacherAIMessage()"
                                    style="width: 48px; height: 48px; background: #4D44B5; border: none;">
                                    <span class="material-icons">send</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- ========================================== -->
        <!-- PARENT MODULE VIEWS (FR-7)                 -->
        <!-- ========================================== -->

        <!-- 1. Dashboard -->
        <div id="parent-dashboard-view" class="view container-fluid p-4">
            <div class="row mb-4 align-items-center">
                <div class="col-md-8">
                    <h3 class="fw-bold text-dark mb-1">Parent Dashboard</h3>
                    <p class="text-muted small">Welcome back, Mr. Sharma</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="d-inline-flex bg-white rounded-pill shadow-sm p-1 align-items-center border">
                        <img src="https://ui-avatars.com/api/?name=Kid&background=random" class="rounded-circle me-2"
                            width="32" height="32">
                        <select class="form-select border-0 bg-transparent py-0 shadow-none fw-bold text-dark"
                            style="width: auto;">
                            <option>Surjeet (Grade 10)</option>
                            <option>Sibling (Grade 6)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Row 1: Stats & Fees -->
            <div class="row g-4 mb-4">
                <!-- Fees Card -->
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 rounded-4 overflow-hidden">
                        <div class="card-body p-4 position-relative">
                            <div class="position-absolute top-0 end-0 p-3 opacity-10">
                                <span class="material-icons fs-1 text-primary">payments</span>
                            </div>
                            <h6 class="text-muted text-uppercase small fw-bold mb-3">Fee Status</h6>
                            <h3 class="fw-bold text-dark mb-1">$500.00 <span class="text-danger small fs-6">Due</span>
                            </h3>
                            <div class="progress rounded-pill bg-light my-3" style="height: 6px;">
                                <div class="progress-bar bg-success rounded-pill" style="width: 75%"></div>
                            </div>
                            <div class="d-flex justify-content-between text-muted small">
                                <span>Paid: $1,500</span>
                                <span>Total: $2,000</span>
                            </div>
                            <button class="btn btn-primary-custom w-100 mt-3 rounded-pill btn-sm fw-bold">Pay
                                Now</button>
                        </div>
                    </div>
                </div>

                <!-- Attendance Widget -->
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 rounded-4">
                        <div class="card-body p-4 d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-muted text-uppercase small fw-bold mb-1">Attendance</h6>
                                <h2 class="fw-bold text-dark mb-0">92%</h2>
                                <span class="badge bg-success bg-opacity-10 text-success rounded-pill mt-2">Good
                                    Standing</span>
                            </div>
                            <div class="position-relative" style="width: 80px; height: 80px;">
                                <svg viewBox="0 0 36 36" class="circular-chart text-success">
                                    <path class="circle-bg"
                                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    <path class="circle" stroke-dasharray="92, 100"
                                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                </svg>
                            </div>
                        </div>
                        <div class="card-footer bg-white border-0 py-3">
                            <div class="row text-center small">
                                <div class="col font-weight-bold text-dark">180 <span
                                        class="text-muted fw-normal d-block">Working</span></div>
                                <div class="col font-weight-bold text-success">165 <span
                                        class="text-muted fw-normal d-block">Present</span></div>
                                <div class="col font-weight-bold text-danger">15 <span
                                        class="text-muted fw-normal d-block">Absent</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Overall Progress -->
                <div class="col-md-4">
                    <div
                        class="card border-0 shadow-sm h-100 rounded-4 p-4 text-center d-flex flex-column justify-content-center">
                        <h6 class="text-muted text-uppercase small fw-bold mb-3">Overall Progress</h6>
                        <div class="fw-bold display-4 text-primary">A-</div>
                        <p class="text-muted small">Top 15% of class</p>
                        <button class="btn btn-outline-primary rounded-pill btn-sm fw-bold">View Report</button>
                    </div>
                </div>
            </div>

            <!-- Row 2: Notice Board & Events -->
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100 rounded-4">
                        <div class="card-header bg-white py-3">
                            <h6 class="mb-0 fw-bold">Notice Board</h6>
                        </div>
                        <div class="list-group list-group-flush">
                            <div class="list-group-item p-3 border-light">
                                <span class="badge bg-danger rounded-pill mb-1">Urgent</span>
                                <p class="mb-0 fw-bold small">School closed tomorrow due to heavy rain.</p>
                                <small class="text-muted">Principal Office  2 hours ago</small>
                            </div>
                            <div class="list-group-item p-3 border-light">
                                <span class="badge bg-info rounded-pill mb-1">Event</span>
                                <p class="mb-0 fw-bold small">Annual Science Fair Registration Open.</p>
                                <small class="text-muted">Science Dept  Yesterday</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100 rounded-4">
                        <div class="card-header bg-white py-3">
                            <h6 class="mb-0 fw-bold">Upcoming Events</h6>
                        </div>
                        <div class="card-body">
                            <div class="d-flex gap-3 mb-3">
                                <div class="bg-primary bg-opacity-10 rounded text-center py-2 px-3 text-primary">
                                    <div class="fw-bold small">OCT</div>
                                    <div class="h5 fw-bold mb-0">25</div>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-0 text-dark">Parent-Teacher Meeting</h6>
                                    <small class="text-muted">10:00 AM - 12:00 PM  Main Hall</small>
                                </div>
                            </div>
                            <div class="d-flex gap-3">
                                <div class="bg-warning bg-opacity-10 rounded text-center py-2 px-3 text-warning">
                                    <div class="fw-bold small">NOV</div>
                                    <div class="h5 fw-bold mb-0">05</div>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-0 text-dark">Sports Day</h6>
                                    <small class="text-muted">08:00 AM - 04:00 PM  Sports Ground</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 3: Teachers -->
            <h5 class="fw-bold text-dark mt-4 mb-3">My Teachers</h5>
            <div class="row g-3">
                <div class="col-md-3">
                    <div class="card border-0 shadow-sm rounded-4 p-3 d-flex flex-row align-items-center gap-3">
                        <img src="https://ui-avatars.com/api/?name=Teacher+Admin&background=random"
                            class="rounded-circle" width="48" height="48">
                        <div class="lh-1">
                            <h6 class="fw-bold mb-1 text-dark">Mrs. Smith</h6>
                            <small class="text-muted">Class Teacher</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card border-0 shadow-sm rounded-4 p-3 d-flex flex-row align-items-center gap-3">
                        <img src="https://ui-avatars.com/api/?name=Math+T&background=random" class="rounded-circle"
                            width="48" height="48">
                        <div class="lh-1">
                            <h6 class="fw-bold mb-1 text-dark">Mr. Doe</h6>
                            <small class="text-muted">Mathematics</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. Assignment -->
        <div id="parent-assignment-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Assignments</h3>

            <ul class="nav nav-tabs mb-4">
                <li class="nav-item">
                    <a class="nav-link active fw-bold" href="#">Pending (3)</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link fw-bold text-muted" href="#">Completed</a>
                </li>
            </ul>

            <div class="row g-3">
                <div class="col-md-12">
                    <div class="card border-0 shadow-sm rounded-4 p-3 hover-up transition-all bg-white mb-3">
                        <div class="row align-items-center">
                            <div class="col-md-1 text-center">
                                <div class="bg-primary bg-opacity-10 text-primary rounded-circle d-inline-flex p-3">
                                    <span class="material-icons">calculate</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6 class="fw-bold text-dark mb-1">Algebra Worksheet #5</h6>
                                <small class="text-muted">Mathematics  Posted Today</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <small class="text-muted d-block text-uppercase fw-bold" style="font-size: 10px;">Due
                                    Date</small>
                                <span class="text-danger fw-bold">Oct 29, 2024</span>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="badge bg-warning text-dark rounded-pill px-3">Pending</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="card border-0 shadow-sm rounded-4 p-3 hover-up transition-all bg-white">
                        <div class="row align-items-center">
                            <div class="col-md-1 text-center">
                                <div class="bg-success bg-opacity-10 text-success rounded-circle d-inline-flex p-3">
                                    <span class="material-icons">science</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6 class="fw-bold text-dark mb-1">Physics Lab Report</h6>
                                <small class="text-muted">Science  Posted Yesterday</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <small class="text-muted d-block text-uppercase fw-bold" style="font-size: 10px;">Due
                                    Date</small>
                                <span class="text-dark fw-bold">Oct 28, 2024</span>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="badge bg-danger bg-opacity-10 text-danger rounded-pill px-3">Overdue</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="parent-assignment-scores-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Assignment Scores</h3>
            <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="ps-4 py-3">Assignment</th>
                                <th>Subject</th>
                                <th>Submitted On</th>
                                <th>Score</th>
                                <th>Feedback</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="ps-4 fw-bold">History Essay</td>
                                <td>History</td>
                                <td>Oct 10, 2024</td>
                                <td><span class="badge bg-success rounded-pill">18/20</span></td>
                                <td class="small text-muted">Good analysis of the topic.</td>
                            </tr>
                            <tr>
                                <td class="ps-4 fw-bold">Math Quiz #1</td>
                                <td>Mathematics</td>
                                <td>Oct 05, 2024</td>
                                <td><span class="badge bg-warning text-dark rounded-pill">12/20</span></td>
                                <td class="small text-muted">Needs improvement in algebra.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 3. Attendance -->
        <div id="parent-attendance-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Attendance Register</h3>
            <div class="card border-0 shadow-sm rounded-4 p-4 text-center">
                <h5 class="text-muted mb-3">October 2024</h5>
                <!-- Simple placeholder grid -->
                <div class="row g-2" style="max-width: 400px; margin: 0 auto;">
                    <div class="col-2">
                        <div class="p-2 bg-success text-white rounded">1</div>
                    </div>
                    <div class="col-2">
                        <div class="p-2 bg-success text-white rounded">2</div>
                    </div>
                    <div class="col-2">
                        <div class="p-2 bg-success text-white rounded">3</div>
                    </div>
                    <div class="col-2">
                        <div class="p-2 bg-danger text-white rounded">4</div>
                    </div>
                    <div class="col-2">
                        <div class="p-2 bg-secondary bg-opacity-25 text-muted rounded">5</div>
                    </div>
                    <div class="col-2">
                        <div class="p-2 bg-secondary bg-opacity-25 text-muted rounded">6</div>
                    </div>
                    <div class="col-2">
                        <div class="p-2 bg-success text-white rounded">7</div>
                    </div>
                    <div class="col-2">
                        <div class="p-2 bg-success text-white rounded">8</div>
                    </div>
                    <!-- ... -->
                </div>
                <div class="mt-4 d-flex justify-content-center gap-3 small">
                    <span class="d-flex align-items-center"><span class="bg-success rounded-circle me-1"
                            style="width:10px; height:10px;"></span> Present</span>
                    <span class="d-flex align-items-center"><span class="bg-danger rounded-circle me-1"
                            style="width:10px; height:10px;"></span> Absent</span>
                    <span class="d-flex align-items-center"><span class="bg-secondary bg-opacity-25 rounded-circle me-1"
                            style="width:10px; height:10px;"></span> Holiday</span>
                </div>
            </div>
        </div>

        <div id="parent-attendance-report-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Attendance Report Details</h3>
            <div class="row text-center">
                <div class="col-md-3">
                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <h3 class="fw-bold text-dark">180</h3>
                        <small class="text-muted uppercase">Working Days</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <h3 class="fw-bold text-success">165</h3>
                        <small class="text-muted uppercase">Present</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <h3 class="fw-bold text-danger">15</h3>
                        <small class="text-muted uppercase">Absent</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card border-0 shadow-sm rounded-4 p-4">
                        <h3 class="fw-bold text-primary">92%</h3>
                        <small class="text-muted uppercase">Percentage</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. Timetable (Reusing Teacher CSS) -->
        <div id="parent-timetable-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Class Timetable (Grade 10-A)</h3>
            <div class="card border-0 shadow rounded-4 overflow-hidden">
                <div class="table-responsive">
                    <table class="table table-borderless align-middle mb-0 text-center">
                        <thead style="background-color: #f8f9fa; border-bottom: 2px solid #e9ecef;">
                            <tr>
                                <th class="py-3 text-uppercase text-secondary small fw-bold text-start ps-4"
                                    style="width: 150px;">Day</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Monday</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Tuesday</th>
                                <th class="py-3 text-uppercase text-secondary small fw-bold">Wednesday</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="fw-bold text-muted small py-4 text-start ps-4">09:00 - 10:00</td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-blue">
                                        <div class="fw-bold text-dark">Mathematics</div>
                                        <div class="small text-muted">Mr. Doe</div>
                                    </div>
                                </td>
                                <td class="py-2 text-muted">-</td>
                                <td class="py-2">
                                    <div class="p-3 rounded-3 shadow-sm bg-pastel-green">
                                        <div class="fw-bold text-dark">Science</div>
                                        <div class="small text-muted">Mrs. Green</div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 5. Exam Schedule -->
        <div id="parent-exam-schedule-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Exam Schedule</h3>
            <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="ps-4 py-3">Student</th>
                                <th class="ps-4 py-3">Subject</th>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Venue</th>
                                <th>Items Required</th>
                            </tr>
                        </thead>
                        <tbody id="parent-exam-schedule-body">
                            <tr>
                                <td class="ps-4 text-muted" colspan="6">Loading exam schedules...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 6. Online Test -->
        <div id="parent-online-test-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Online Test Results</h3>
            <div class="alert alert-info border-0 shadow-sm text-center py-4">
                <i class="material-icons fs-1 mb-2">quiz</i>
                <h5>No online tests taken recently.</h5>
            </div>
        </div>

        <!-- 7. Progress Card -->
        <div id="parent-progress-card-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Report Card</h3>
            <div id="parent-progress-card-container" class="card border-0 shadow rounded-4 p-4">
                <div class="text-center text-muted py-5">
                    <span class="material-icons fs-1">analytics</span>
                    <p class="mt-2">Progress card will appear here.</p>
                </div>
            </div>
        </div>

        <!-- 8. Leave Request -->
        <div id="parent-leave-apply-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Apply for Leave</h3>
            <div class="card border-0 shadow rounded-4 p-4" style="max-width: 600px;">
                <div class="alert alert-light border shadow-sm mb-4">
                    <small class="text-muted">Applying for: <b>Surjeet (Grade 10-A)</b></small>
                </div>
                <form>
                    <div class="row mb-3">
                        <div class="col-6">
                            <label class="form-label text-muted small fw-bold">From</label>
                            <input type="date" class="form-control bg-light border-0">
                        </div>
                        <div class="col-6">
                            <label class="form-label text-muted small fw-bold">To</label>
                            <input type="date" class="form-control bg-light border-0">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label text-muted small fw-bold">Reason</label>
                        <textarea class="form-control bg-light border-0" rows="3"
                            placeholder="Reason for leave..."></textarea>
                    </div>
                    <button class="btn btn-primary-custom w-100 rounded-pill fw-bold">Submit Request</button>
                </form>
            </div>
        </div>

        <div id="parent-leave-status-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Leave Status</h3>
            <div class="list-group shadow-sm rounded-4">
                <div class="list-group-item p-3 d-flex justify-content-between align-items-center">
                    <div>
                        <span class="fw-bold text-dark">Family Function</span>
                        <div class="small text-muted">Oct 20 - Oct 22</div>
                    </div>
                    <span class="badge bg-warning text-dark rounded-pill">Pending</span>
                </div>
                <div class="list-group-item p-3 d-flex justify-content-between align-items-center">
                    <div>
                        <span class="fw-bold text-dark">Sick Leave</span>
                        <div class="small text-muted">Sep 15</div>
                    </div>
                    <span class="badge bg-success rounded-pill">Approved</span>
                </div>
            </div>
        </div>

        <!-- 9. Feedback -->
        <div id="parent-feedback-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Feedback</h3>
            <div class="card border-0 shadow rounded-4 p-4" style="max-width: 600px;">
                <p class="text-muted small mb-4">Submit feedback about a teacher or staff member. You can choose
                    to keep
                    this confidential.</p>
                <form>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Feedback For</label>
                        <select class="form-select bg-light border-0">
                            <option>Select Teacher/Staff...</option>
                            <option>Mrs. Smith (Class Teacher)</option>
                            <option>Mr. Doe (Math)</option>
                            <option>Transport In-charge</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Message</label>
                        <textarea class="form-control bg-light border-0" rows="4"
                            placeholder="Your feedback..."></textarea>
                    </div>
                    <div class="form-check mb-4">
                        <input class="form-check-input" type="checkbox" id="confidentialCheck">
                        <label class="form-check-label text-muted small" for="confidentialCheck">
                            Keep my identity confidential
                        </label>
                    </div>
                    <button class="btn btn-dark w-100 rounded-pill fw-bold">Submit Feedback</button>
                </form>
            </div>
        </div>

        <!-- 10. Email (Reuse structure) -->
        <div id="parent-email-inbox-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Inbox</h3>
            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white border-bottom p-3 d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 fw-bold">Inbox</h5>
                    <button class="btn btn-primary-custom rounded-pill"
                        onclick="switchView('parent-email-compose-view')">Compose New</button>
                </div>
                <div class="list-group list-group-flush" id="parent-email-inbox-list">
                    <div class="p-4 text-center text-muted">Loading...</div>
                </div>
            </div>
        </div>
        <div id="parent-email-compose-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Compose Email</h3>
            <button class="btn btn-light mb-3" onclick="switchView('parent-email-inbox-view')">Back</button>
            <div class="card border-0 shadow-sm rounded-4 p-4">
                <form id="parent-email-compose-form">
                    <div class="mb-3"><input type="text" class="form-control" id="parent-email-to"
                            placeholder="To: (e.g., Teacher)"></div>
                    <div class="mb-3"><input type="text" class="form-control" id="parent-email-subject"
                            placeholder="Subject:"></div>
                    <div class="mb-3"><textarea class="form-control" rows="5" id="parent-email-body"></textarea>
                    </div>
                    <button class="btn btn-primary-custom rounded-pill fw-bold" id="parent-email-send-btn"
                        type="submit">Send</button>
                </form>
            </div>
        </div>
        <div id="parent-email-sent-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">Sent Items</h3>
            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white border-bottom p-3">
                    <h5 class="mb-0 fw-bold">Sent</h5>
                </div>
                <div class="list-group list-group-flush" id="parent-email-sent-list">
                    <div class="p-4 text-center text-muted">Loading...</div>
                </div>
            </div>
        </div>

        <div id="parent-notifications-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4 text-dark">Notifications</h3>
            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white border-bottom p-3">
                    <h5 class="mb-0 fw-bold">Child Attendance & Updates</h5>
                </div>
                <div class="list-group list-group-flush" id="parent-notifications-list">
                    <div class="p-4 text-center text-muted">Loading...</div>
                </div>
            </div>
        </div>

        <div id="parent-profile-view" class="view container-fluid p-4">
            <h3 class="fw-bold mb-4">My Profile</h3>
            <!-- Reuse Profile content or placeholder -->
        </div>

        <!-- App Footer -->
        <footer class="mt-auto py-5 text-white position-relative"
            style="background-color: var(--primary-color); border-top: 1px solid rgba(255,255,255,0.1); z-index: 10;">
            <div class="container-fluid px-4 px-md-5">
                <div class="row g-5">
                    <!-- Column 1: Brand & Language -->
                    <div class="col-lg-3 col-md-12">
                        <div class="d-flex align-items-center gap-3 mb-4">
                            <img src="./static/noble_nexus_logo.png" alt="Noble Nexus"
                                style="width: 48px; border-radius: 12px; background: white; padding: 2px;">
                            <div>
                                <h5 class="fw-bold mb-0">ClassBridge</h5>
                                <small class="opacity-50 text-uppercase"
                                    style="font-size: 0.65rem; letter-spacing: 1px;">by Noble Nexus</small>
                            </div>
                        </div>

                        <div class="dropdown mb-4">
                            <button
                                class="btn btn-outline-light dropdown-toggle rounded-pill px-4 text-start d-flex justify-content-between align-items-center"
                                type="button" style="min-width: 140px; border-color: rgba(255,255,255,0.3);">
                                English
                            </button>
                        </div>

                        <div class="d-flex flex-wrap gap-2">
                            <a href="#"
                                class="btn btn-dark border border-secondary rounded-3 px-3 py-2 d-flex align-items-center gap-2 text-decoration-none"
                                style="background: #000;">
                                <span class="material-icons">apple</span>
                                <div class="lh-1 text-start">
                                    <span class="d-block text-muted" style="font-size: 9px;">Download on
                                        the</span>
                                    <span class="fw-bold" style="font-size: 13px;">App Store</span>
                                </div>
                            </a>
                            <a href="#"
                                class="btn btn-dark border border-secondary rounded-3 px-3 py-2 d-flex align-items-center gap-2 text-decoration-none"
                                style="background: #000;">
                                <span class="material-icons">android</span>
                                <div class="lh-1 text-start">
                                    <span class="d-block text-muted" style="font-size: 9px;">GET IT ON</span>
                                    <span class="fw-bold" style="font-size: 13px;">Google Play</span>
                                </div>
                            </a>
                            <button
                                class="btn btn-outline-light rounded-circle d-flex align-items-center justify-content-center"
                                style="width: 42px; height: 42px; border-color: rgba(255,255,255,0.3);">
                                <span class="material-icons fs-5">accessibility_new</span>
                            </button>
                        </div>
                    </div>

                    <!-- Column 2: Company -->
                    <div class="col-lg-2 col-6">
                        <h6 class="fw-bold mb-4 opacity-100">Company</h6>
                        <ul class="list-unstyled d-flex flex-column gap-2 opacity-75 small">
                            <li><a href="#" class="text-white text-decoration-none">About us</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Careers</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Team</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Engineering</a></li>
                        </ul>
                    </div>

                    <!-- Column 3: Resources -->
                    <div class="col-lg-2 col-6">
                        <h6 class="fw-bold mb-4 opacity-100">Resources</h6>
                        <ul class="list-unstyled d-flex flex-column gap-2 opacity-75 small">
                            <li><a href="#" class="text-white text-decoration-none">Big Ideas</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Resources</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Training</a></li>
                            <li><a href="#" class="text-white text-decoration-none">ClassBridge Plus</a></li>
                        </ul>
                    </div>

                    <!-- Column 4: Support -->
                    <div class="col-lg-2 col-6">
                        <h6 class="fw-bold mb-4 opacity-100">Support</h6>
                        <ul class="list-unstyled d-flex flex-column gap-2 opacity-75 small">
                            <li><a href="#" class="text-white text-decoration-none">Help Center</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Contact</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Privacy & Security</a></li>
                            <li><a href="#" class="text-white text-decoration-none">Transparency</a></li>
                        </ul>
                    </div>

                    <!-- Column 5: QR Code -->
                    <div class="col-lg-3 col-12 text-center text-lg-end">
                        <div class="bg-white p-3 rounded-4 shadow-lg d-inline-block position-relative text-center">
                            <h6 class="fw-bold text-dark mb-3 text-center" style="font-size: 0.9rem;">Get the
                                ClassBridge app</h6>
                            <img src="./static/noble_nexus_qr.png" alt="QR Code" class="img-fluid"
                                style="width: 140px; height: 140px;">
                        </div>
                    </div>
                </div>

                <hr class="my-5 border-secondary opacity-25">

                <div class="d-flex flex-column flex-md-row justify-content-between align-items-center opacity-50 small">
                    <div class="mb-3 mb-md-0">
                        &copy; 2026 Noble Nexus, Inc.
                    </div>
                    <div class="d-flex gap-4">
                        <a href="#" class="text-white text-decoration-none">Terms of Service</a>
                        <a href="#" class="text-white text-decoration-none">Privacy Policy</a>
                        <a href="#" class="text-white text-decoration-none">Cookie Settings</a>
                    </div>
                </div>
            </div>
        </footer>

        <!-- About Company Modal -->
        <div class="view full-page-view" id="aboutCompModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content rounded-4 border-0 shadow-lg">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title fw-bold text-primary-custom">About ClassBridge</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <div class="text-center mb-4">
                            <img src="./static/noble_logo.png" width="80" class="mb-3 rounded-3 shadow-sm">
                            <h4 class="fw-bold mb-2">Class Bridge</h4>
                            <p class="text-uppercase small text-muted letter-spacing-1">A Product by Noble Nexus
                            </p>
                        </div>
                        <p class="text-muted">
                            ClassBridge is the leading AI-powered school management platform. We connect
                            schools,
                            teachers,
                            students, and parents in one seamless digital environment to foster better learning
                            outcomes.
                        </p>
                        <p class="text-muted">
                            Our mission is to democratize education by providing state-of-the-art tools for
                            every
                            institution, big or small.
                        </p>
                    </div>
                    <div class="modal-footer border-top-0 justify-content-center">
                        <button type="button" class="btn btn-primary-custom px-4 rounded-pill"
                            data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- NOTIFICATION SYSTEM SCRIPT -->
        <script>
            // --- Notification System ---
            async function fetchNotifications() {
                // Try to get user ID from localStorage or other sources
                // Assuming the main script sets 'user_id' or 'currentUser' in localStorage
                let userId = localStorage.getItem('user_id');
                const userRole = localStorage.getItem('user_role');

                if (!userId) {
                    // Fallback attempt: if script.js uses a global 'currentUser' variable
                    if (typeof currentUser !== 'undefined' && currentUser.id) {
                        userId = currentUser.id;
                    } else {
                        return; // Wait for login
                    }
                }

                try {
                    const res = await fetch('/api/notifications/inbox', {
                        headers: { 'X-User-Id': userId }
                    });
                    if (!res.ok) return;
                    const data = await res.json();

                    // Sort by ID desc if not already
                    data.sort((a, b) => b.id - a.id);

                    const unreadCount = data.filter(n => !n.is_read).length;

                    const btn = document.querySelector('.user-menu .notify-btn');
                    if (btn) {
                        // Update badge
                        let badge = btn.querySelector('.badge-notification');
                        if (!badge) {
                            badge = document.createElement('span');
                            badge.className = 'badge-notification position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger';
                            badge.style.fontSize = '0.6rem';
                            btn.style.position = 'relative'; // Ensure button is relative
                            btn.appendChild(badge);
                        }

                        if (unreadCount > 0) {
                            badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                            badge.style.display = 'inline-block';
                        } else {
                            badge.style.display = 'none';
                        }

                        // Attach click handler (idempotent)
                        btn.onclick = (e) => {
                            e.stopPropagation();
                            e.preventDefault();
                            showNotificationDropdown(data, btn);
                        };
                    }
                } catch (e) {
                    console.error('Notification fetch error:', e);
                }
            }

            function showNotificationDropdown(notifications, btn) {
                // Remove existing
                const existing = document.getElementById('notification-dropdown');
                if (existing) {
                    existing.remove();
                    return; // Toggle off
                }

                const dropdown = document.createElement('div');
                dropdown.id = 'notification-dropdown';
                dropdown.className = 'card border-0 shadow-lg position-absolute animate-fade-in';
                // Formatting
                dropdown.style.width = '350px';
                dropdown.style.right = '20px';
                dropdown.style.top = '80px';
                dropdown.style.zIndex = '9999';
                dropdown.style.maxHeight = '500px';
                dropdown.style.overflowY = 'auto';
                dropdown.style.borderRadius = '12px';

                let html = `
                <div class="card-header bg-white fw-bold border-bottom d-flex justify-content-between align-items-center sticky-top">
                    <span>Notifications</span>
                    <small class="text-primary" style="cursor:pointer" onclick="fetchNotifications()">Refresh</small>
                </div>
                <div class="list-group list-group-flush">
            `;

                if (notifications.length === 0) {
                    html += '<div class="p-4 text-center text-muted small">No notifications</div>';
                } else {
                    notifications.forEach(n => {
                        const bgClass = n.is_read ? 'bg-white' : 'bg-light border-start border-4 border-primary';
                        const icon = n.subject.includes('Leave') ? 'event_busy' : 'notifications';
                        const time = new Date(n.timestamp).toLocaleString();

                        html += `
                        <div class="list-group-item ${bgClass} p-3 list-group-item-action" onclick="markRead(${n.id})" style="cursor:pointer">
                            <div class="d-flex w-100 justify-content-between align-items-start mb-1">
                                <h6 class="mb-0 fw-bold text-dark small d-flex align-items-center gap-2">
                                     <span class="material-icons fs-6 text-secondary">${icon}</span> ${n.subject}
                                </h6>
                            </div>
                            <p class="mb-1 small text-secondary">${n.content}</p>
                            <small class="text-muted" style="font-size:10px">${time}</small>
                        </div>
                    `;
                    });
                }
                html += '</div>';
                dropdown.innerHTML = html;
                document.body.appendChild(dropdown);

                // Close on outside click
                setTimeout(() => {
                    document.addEventListener('click', function close(e) {
                        if (!dropdown.contains(e.target) && !btn.contains(e.target)) {
                            dropdown.remove();
                            document.removeEventListener('click', close);
                        }
                    });
                }, 100);
            }

            async function markRead(id) {
                try {
                    const userId = localStorage.getItem('user_id');
                    await fetch(`/api/notifications/${id}/read`, {
                        method: 'PUT',
                        headers: userId ? { 'X-User-Id': userId } : {}
                    });
                    // Re-fetch to update badge and list style
                    fetchNotifications();
                    // Don't close dropdown immediately, just update UI styling via re-render or let it be.
                    // Re-fetching will re-render dropdown if we call showNotificationDropdown again, 
                    // but better to just let user close it or manually refresh.
                    // Actually, let's just update the list item visually if possible? 
                    // Simpler: reload notifications but keep dropdown open? 
                    // For MVP, just update internal state.
                    const item = document.querySelector(`[onclick="markRead(${id})"]`);
                    if (item) {
                        item.classList.remove('bg-light', 'border-start', 'border-4', 'border-primary');
                        item.classList.add('bg-white');
                    }
                } catch (e) { console.error(e); }
            }

            // Start Polling
            setInterval(fetchNotifications, 15000); // Every 15s

            // Initial Fetch with delay to ensure auth
            setTimeout(fetchNotifications, 2000);
        </script>
</body>


</html>
